function cov_4nfejdoj5(){var path="/home/azer/Desktop/jenkins/app/monitoringApp/services/task/getUserTasksWithState.js";var hash="cb6cd0481a2d41baeb4019f157d0b86b5c293aed";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/azer/Desktop/jenkins/app/monitoringApp/services/task/getUserTasksWithState.js",statementMap:{"0":{start:{line:1,column:17},end:{line:1,column:36}},"1":{start:{line:2,column:13},end:{line:2,column:41}},"2":{start:{line:3,column:15},end:{line:3,column:32}},"3":{start:{line:4,column:0},end:{line:159,column:2}},"4":{start:{line:12,column:2},end:{line:158,column:3}},"5":{start:{line:14,column:20},end:{line:14,column:22}},"6":{start:{line:15,column:23},end:{line:15,column:25}},"7":{start:{line:16,column:22},end:{line:16,column:24}},"8":{start:{line:17,column:17},end:{line:17,column:19}},"9":{start:{line:18,column:21},end:{line:18,column:23}},"10":{start:{line:21,column:20},end:{line:113,column:6}},"11":{start:{line:115,column:4},end:{line:117,column:7}},"12":{start:{line:116,column:6},end:{line:116,column:78}},"13":{start:{line:120,column:4},end:{line:133,column:2}},"14":{start:{line:120,column:29},end:{line:132,column:30}},"15":{start:{line:121,column:8},end:{line:121,column:26}},"16":{start:{line:123,column:9},end:{line:132,column:30}},"17":{start:{line:124,column:6},end:{line:124,column:27}},"18":{start:{line:126,column:9},end:{line:132,column:30}},"19":{start:{line:127,column:6},end:{line:127,column:26}},"20":{start:{line:129,column:9},end:{line:132,column:30}},"21":{start:{line:130,column:6},end:{line:130,column:21}},"22":{start:{line:132,column:10},end:{line:132,column:29}},"23":{start:{line:135,column:28},end:{line:147,column:9}},"24":{start:{line:148,column:4},end:{line:154,column:5}},"25":{start:{line:149,column:6},end:{line:153,column:8}},"26":{start:{line:155,column:4},end:{line:155,column:57}},"27":{start:{line:157,column:4},end:{line:157,column:36}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:4,column:17},end:{line:4,column:18}},loc:{start:{line:11,column:5},end:{line:159,column:1}},line:11},"1":{name:"(anonymous_1)",decl:{start:{line:115,column:16},end:{line:115,column:17}},loc:{start:{line:115,column:26},end:{line:117,column:5}},line:115},"2":{name:"(anonymous_2)",decl:{start:{line:120,column:20},end:{line:120,column:21}},loc:{start:{line:120,column:27},end:{line:133,column:1}},line:120}},branchMap:{"0":{loc:{start:{line:120,column:29},end:{line:132,column:30}},type:"if",locations:[{start:{line:120,column:29},end:{line:132,column:30}},{start:{line:120,column:29},end:{line:132,column:30}}],line:120},"1":{loc:{start:{line:123,column:9},end:{line:132,column:30}},type:"if",locations:[{start:{line:123,column:9},end:{line:132,column:30}},{start:{line:123,column:9},end:{line:132,column:30}}],line:123},"2":{loc:{start:{line:126,column:9},end:{line:132,column:30}},type:"if",locations:[{start:{line:126,column:9},end:{line:132,column:30}},{start:{line:126,column:9},end:{line:132,column:30}}],line:126},"3":{loc:{start:{line:129,column:9},end:{line:132,column:30}},type:"if",locations:[{start:{line:129,column:9},end:{line:132,column:30}},{start:{line:129,column:9},end:{line:132,column:30}}],line:129},"4":{loc:{start:{line:148,column:4},end:{line:154,column:5}},type:"if",locations:[{start:{line:148,column:4},end:{line:154,column:5}},{start:{line:148,column:4},end:{line:154,column:5}}],line:148}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"cb6cd0481a2d41baeb4019f157d0b86b5c293aed"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_4nfejdoj5=function(){return actualCoverage;};}return actualCoverage;}cov_4nfejdoj5();const mongoose=(cov_4nfejdoj5().s[0]++,require("mongoose"));const Task=(cov_4nfejdoj5().s[1]++,require("../../models/Task"));const moment=(cov_4nfejdoj5().s[2]++,require('moment'));cov_4nfejdoj5().s[3]++;module.exports=async(userId,type,state,startDate,endDate,timeZone)=>{cov_4nfejdoj5().f[0]++;cov_4nfejdoj5().s[4]++;try{let Pending=(cov_4nfejdoj5().s[5]++,[]);let InProgress=(cov_4nfejdoj5().s[6]++,[]);let Completed=(cov_4nfejdoj5().s[7]++,[]);let Done=(cov_4nfejdoj5().s[8]++,[]);let Canceled=(cov_4nfejdoj5().s[9]++,[]);const taskDoc=(cov_4nfejdoj5().s[10]++,await Task.aggregate([{$match:{assignee:mongoose.Types.ObjectId(userId)}},{$lookup:{from:"users",localField:"assignee",foreignField:"_id",as:"populatedUser"}},{$set:{assigneeName:{$concat:[{$arrayElemAt:["$populatedUser.firstName",0]}," ",{$arrayElemAt:["$populatedUser.lastName",0]}]}}},{$match:{state:{$in:JSON.parse(state)},type:{$in:JSON.parse(type)}}},{$lookup:{from:"systems",localField:"system",foreignField:"_id",as:"populatedSystem"}},{$set:{systemName:{$arrayElemAt:["$populatedSystem.name",0]}}},{$lookup:{from:"customers",localField:"populatedSystem.customer",foreignField:"_id",as:"populatedCustomer"}},{$set:{customerName:{$arrayElemAt:["$populatedCustomer.label",0]}}},{$match:{$and:[{estimatedStart:{$lte:new Date(moment(endDate).utc())}},{estimatedStart:{$gte:new Date(moment(startDate).utc())}}]}},{$project:{populatedUser:0,populatedSystem:0,populatedCustomer:0}}]));cov_4nfejdoj5().s[11]++;taskDoc.map(task=>{cov_4nfejdoj5().f[1]++;cov_4nfejdoj5().s[12]++;task.estimatedStart=moment(task.estimatedStart).tz(timeZone).format();});cov_4nfejdoj5().s[13]++;taskDoc.forEach(item=>{cov_4nfejdoj5().f[2]++;cov_4nfejdoj5().s[14]++;if(item.state.toString()==="Pending"){cov_4nfejdoj5().b[0][0]++;cov_4nfejdoj5().s[15]++;Pending.push(item);}else{cov_4nfejdoj5().b[0][1]++;cov_4nfejdoj5().s[16]++;if(item.state.toString()==="In progress"){cov_4nfejdoj5().b[1][0]++;cov_4nfejdoj5().s[17]++;InProgress.push(item);}else{cov_4nfejdoj5().b[1][1]++;cov_4nfejdoj5().s[18]++;if(item.state.toString()==="Completed"){cov_4nfejdoj5().b[2][0]++;cov_4nfejdoj5().s[19]++;Completed.push(item);}else{cov_4nfejdoj5().b[2][1]++;cov_4nfejdoj5().s[20]++;if(item.state.toString()==="Done"){cov_4nfejdoj5().b[3][0]++;cov_4nfejdoj5().s[21]++;Done.push(item);}else{cov_4nfejdoj5().b[3][1]++;cov_4nfejdoj5().s[22]++;Canceled.push(item);}}}}});const workFlowColumns=(cov_4nfejdoj5().s[23]++,[{name:"Pending",items:Pending},{name:"In progress",items:InProgress},{name:"Completed",items:Completed},{name:"Done",items:Done},{name:"Canceled",items:Canceled}]);cov_4nfejdoj5().s[24]++;if(taskDoc.length===0){cov_4nfejdoj5().b[4][0]++;cov_4nfejdoj5().s[25]++;return{error:{message:"No Tasks found"},status:"no data",statusCode:204};}else{cov_4nfejdoj5().b[4][1]++;}cov_4nfejdoj5().s[26]++;return{data:workFlowColumns,status:"success"};}catch(err){cov_4nfejdoj5().s[27]++;return{err,status:"error"};}};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdldFVzZXJUYXNrc1dpdGhTdGF0ZS5qcyJdLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJUYXNrIiwibW9tZW50IiwibW9kdWxlIiwiZXhwb3J0cyIsInVzZXJJZCIsInR5cGUiLCJzdGF0ZSIsInN0YXJ0RGF0ZSIsImVuZERhdGUiLCJ0aW1lWm9uZSIsIlBlbmRpbmciLCJJblByb2dyZXNzIiwiQ29tcGxldGVkIiwiRG9uZSIsIkNhbmNlbGVkIiwidGFza0RvYyIsImFnZ3JlZ2F0ZSIsIiRtYXRjaCIsImFzc2lnbmVlIiwiVHlwZXMiLCJPYmplY3RJZCIsIiRsb29rdXAiLCJmcm9tIiwibG9jYWxGaWVsZCIsImZvcmVpZ25GaWVsZCIsImFzIiwiJHNldCIsImFzc2lnbmVlTmFtZSIsIiRjb25jYXQiLCIkYXJyYXlFbGVtQXQiLCIkaW4iLCJKU09OIiwicGFyc2UiLCJzeXN0ZW1OYW1lIiwiY3VzdG9tZXJOYW1lIiwiJGFuZCIsImVzdGltYXRlZFN0YXJ0IiwiJGx0ZSIsIkRhdGUiLCJ1dGMiLCIkZ3RlIiwiJHByb2plY3QiLCJwb3B1bGF0ZWRVc2VyIiwicG9wdWxhdGVkU3lzdGVtIiwicG9wdWxhdGVkQ3VzdG9tZXIiLCJtYXAiLCJ0YXNrIiwidHoiLCJmb3JtYXQiLCJmb3JFYWNoIiwiaXRlbSIsInRvU3RyaW5nIiwicHVzaCIsIndvcmtGbG93Q29sdW1ucyIsIm5hbWUiLCJpdGVtcyIsImxlbmd0aCIsImVycm9yIiwibWVzc2FnZSIsInN0YXR1cyIsInN0YXR1c0NvZGUiLCJkYXRhIiwiZXJyIl0sIm1hcHBpbmdzIjoiODJIQWVZO3lGQWZaLEtBQU1BLENBQUFBLFFBQVEseUJBQUdDLE9BQU8sQ0FBQyxVQUFELENBQVYsQ0FBZCxDQUNBLEtBQU1DLENBQUFBLElBQUkseUJBQUdELE9BQU8sQ0FBQyxtQkFBRCxDQUFWLENBQVYsQ0FDQSxLQUFNRSxDQUFBQSxNQUFNLHlCQUFHRixPQUFPLENBQUMsUUFBRCxDQUFWLENBQVosQyx1QkFDQUcs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QixDQVFwQixDQUFFMEMsSUFBSSxDQUFFLE1BQVIsQ0FBZ0JDLEtBQUssQ0FBRTFDLElBQXZCLENBUm9CLENBVXBCLENBQUV5QyxJQUFJLENBQUUsVUFBUixDQUFvQkMsS0FBSyxDQUFFekMsUUFBM0IsQ0FWb0IsQ0FBSCxDQUFyQixDQTNIRSx3QkF3SUYsR0FBS0MsT0FBTyxDQUFDeUMsTUFBUixHQUFtQixDQUF4QixDQUEyQixtREFDekIsTUFBTyxDQUNMQyxLQUFLLENBQUUsQ0FBRUMsT0FBTyxDQUFFLGdCQUFYLENBREYsQ0FFTEMsTUFBTSxDQUFFLFNBRkgsQ0FHTEMsVUFBVSxDQUFFLEdBSFAsQ0FBUCxDQUtELENBTkQsZ0NBeElFLHdCQStJRixNQUFPLENBQUVDLElBQUksQ0FBR1IsZUFBVCxDQUEwQk0sTUFBTSxDQUFFLFNBQWxDLENBQVAsQ0FDRCxDQUFDLE1BQU9HLEdBQVAsQ0FBWSx5QkFDWixNQUFPLENBQUVBLEdBQUYsQ0FBT0gsTUFBTSxDQUFFLE9BQWYsQ0FBUCxDQUNELENBQ0YsQ0EzSkQiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoXCJtb25nb29zZVwiKTtcbmNvbnN0IFRhc2sgPSByZXF1aXJlKFwiLi4vLi4vbW9kZWxzL1Rhc2tcIik7XG5jb25zdCBtb21lbnQgPSByZXF1aXJlKCdtb21lbnQnKTtcbm1vZHVsZS5leHBvcnRzID0gYXN5bmMgKFxuICB1c2VySWQsXG4gIHR5cGUsXG4gIHN0YXRlLFxuICBzdGFydERhdGUsXG4gIGVuZERhdGUsXG4gIHRpbWVab25lXG4pID0+IHtcbiAgdHJ5IHtcblxuICAgICAgbGV0IFBlbmRpbmcgPSBbXSA7XG4gICAgICBsZXQgSW5Qcm9ncmVzcyA9IFtdIDtcbiAgICAgIGxldCBDb21wbGV0ZWQgPSBbXSA7XG4gICAgICBsZXQgRG9uZSA9IFtdIDtcbiAgICAgIGxldCBDYW5jZWxlZCA9IFtdIDtcblxuXG4gICAgY29uc3QgdGFza0RvYyA9IGF3YWl0IFRhc2suYWdncmVnYXRlKFtcbiAgICAgIHtcbiAgICAgICAgJG1hdGNoOiB7XG4gICAgICAgICAgYXNzaWduZWU6IG1vbmdvb3NlLlR5cGVzLk9iamVjdElkKHVzZXJJZCksXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICAkbG9va3VwOiB7XG4gICAgICAgICAgZnJvbTogXCJ1c2Vyc1wiLFxuICAgICAgICAgIGxvY2FsRmllbGQ6IFwiYXNzaWduZWVcIixcbiAgICAgICAgICBmb3JlaWduRmllbGQ6IFwiX2lkXCIsXG4gICAgICAgICAgYXM6IFwicG9wdWxhdGVkVXNlclwiLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgJHNldDoge1xuICAgICAgICAgIGFzc2lnbmVlTmFtZToge1xuICAgICAgICAgICAgJGNvbmNhdDogW1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgJGFycmF5RWxlbUF0OiBbXCIkcG9wdWxhdGVkVXNlci5maXJzdE5hbWVcIiwgMF0sXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIFwiIFwiLFxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgJGFycmF5RWxlbUF0OiBbXCIkcG9wdWxhdGVkVXNlci5sYXN0TmFtZVwiLCAwXSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgICRtYXRjaDoge1xuICAgICAgICAgICAgICBzdGF0ZToge1xuICAgICAgICAgICAgICAgICRpbjogSlNPTi5wYXJzZShzdGF0ZSksXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgdHlwZTogIHtcbiAgICAgICAgICAgICAgJGluOiBKU09OLnBhcnNlKHR5cGUpLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgICRsb29rdXA6IHtcbiAgICAgICAgICBmcm9tOiBcInN5c3RlbXNcIixcbiAgICAgICAgICBsb2NhbEZpZWxkOiBcInN5c3RlbVwiLFxuICAgICAgICAgIGZvcmVpZ25GaWVsZDogXCJfaWRcIixcbiAgICAgICAgICBhczogXCJwb3B1bGF0ZWRTeXN0ZW1cIixcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgICRzZXQ6IHtcbiAgICAgICAgICBzeXN0ZW1OYW1lOiB7XG4gICAgICAgICAgICAkYXJyYXlFbGVtQXQ6IFtcIiRwb3B1bGF0ZWRTeXN0ZW0ubmFtZVwiLCAwXSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgJGxvb2t1cDoge1xuICAgICAgICAgIGZyb206IFwiY3VzdG9tZXJzXCIsXG4gICAgICAgICAgbG9jYWxGaWVsZDogXCJwb3B1bGF0ZWRTeXN0ZW0uY3VzdG9tZXJcIixcbiAgICAgICAgICBmb3JlaWduRmllbGQ6IFwiX2lkXCIsXG4gICAgICAgICAgYXM6IFwicG9wdWxhdGVkQ3VzdG9tZXJcIixcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgICRzZXQ6IHtcbiAgICAgICAgICBjdXN0b21lck5hbWU6IHtcbiAgICAgICAgICAgICRhcnJheUVsZW1BdDogW1wiJHBvcHVsYXRlZEN1c3RvbWVyLmxhYmVsXCIsIDBdLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICAkbWF0Y2g6IHtcbiAgICAgICAgICAkYW5kOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGVzdGltYXRlZFN0YXJ0OiB7XG4gICAgICAgICAgICAgICAgJGx0ZTogbmV3IERhdGUobW9tZW50KGVuZERhdGUpLnV0YygpKSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGVzdGltYXRlZFN0YXJ0OiB7XG4gICAgICAgICAgICAgICAgJGd0ZTogbmV3IERhdGUobW9tZW50KHN0YXJ0RGF0ZSkudXRjKCkpLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICBdLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgJHByb2plY3Q6IHtcbiAgICAgICAgICBwb3B1bGF0ZWRVc2VyOiAwLFxuICAgICAgICAgIHBvcHVsYXRlZFN5c3RlbTogMCxcbiAgICAgICAgICBwb3B1bGF0ZWRDdXN0b21lcjogMCxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgXSk7XG5cbiAgICB0YXNrRG9jLm1hcCgodGFzaykgPT4ge1xuICAgICAgdGFzay5lc3RpbWF0ZWRTdGFydCA9IG1vbWVudCh0YXNrLmVzdGltYXRlZFN0YXJ0KS50eih0aW1lWm9uZSkuZm9ybWF0KCk7XG4gICAgfSk7XG5cbiAgICBcbiAgICB0YXNrRG9jLmZvckVhY2goaXRlbSA9PnsgaWYoaXRlbS5zdGF0ZS50b1N0cmluZygpID09PSBcIlBlbmRpbmdcIil7XG4gICAgICAgIFBlbmRpbmcucHVzaChpdGVtKVxuICAgIH1cbiAgICBlbHNlIGlmKGl0ZW0uc3RhdGUudG9TdHJpbmcoKSA9PT0gXCJJbiBwcm9ncmVzc1wiKXtcbiAgICAgIEluUHJvZ3Jlc3MucHVzaChpdGVtKVxuICAgIH1cbiAgICBlbHNlIGlmKGl0ZW0uc3RhdGUudG9TdHJpbmcoKT09PSBcIkNvbXBsZXRlZFwiKXtcbiAgICAgIENvbXBsZXRlZC5wdXNoKGl0ZW0pXG4gICAgfVxuICAgIGVsc2UgaWYoaXRlbS5zdGF0ZS50b1N0cmluZygpID09PSBcIkRvbmVcIil7XG4gICAgICBEb25lLnB1c2goaXRlbSlcbiAgICB9XG4gICAgZWxzZSB7Q2FuY2VsZWQucHVzaChpdGVtKX1cbn0pXG5cbiAgICBjb25zdCB3b3JrRmxvd0NvbHVtbnMgPSBbXG5cbiAgICAgICAgeyBuYW1lOiBcIlBlbmRpbmdcIiwgaXRlbXM6IFBlbmRpbmcgfSxcbiAgICAgICAgXG4gICAgICAgIHsgbmFtZTogXCJJbiBwcm9ncmVzc1wiLCBpdGVtczogSW5Qcm9ncmVzcyB9LFxuICAgICAgICBcbiAgICAgICAgeyBuYW1lOiBcIkNvbXBsZXRlZFwiLCBpdGVtczogQ29tcGxldGVkIH0sXG4gICAgICAgIFxuICAgICAgICB7IG5hbWU6IFwiRG9uZVwiLCBpdGVtczogRG9uZSB9LFxuICAgICAgICBcbiAgICAgICAgeyBuYW1lOiBcIkNhbmNlbGVkXCIsIGl0ZW1zOiBDYW5jZWxlZCB9XG4gICAgICAgIFxuICAgICAgICBdO1xuICAgIGlmICggdGFza0RvYy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGVycm9yOiB7IG1lc3NhZ2U6IFwiTm8gVGFza3MgZm91bmRcIiB9LFxuICAgICAgICBzdGF0dXM6IFwibm8gZGF0YVwiLFxuICAgICAgICBzdGF0dXNDb2RlOiAyMDQsXG4gICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4geyBkYXRhOiAgd29ya0Zsb3dDb2x1bW5zLCBzdGF0dXM6IFwic3VjY2Vzc1wiIH07XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIHJldHVybiB7IGVyciwgc3RhdHVzOiBcImVycm9yXCIgfTtcbiAgfVxufTtcbiJdfQ==