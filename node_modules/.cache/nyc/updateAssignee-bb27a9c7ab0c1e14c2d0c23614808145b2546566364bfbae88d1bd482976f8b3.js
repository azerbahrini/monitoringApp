function cov_27ay84z4zq(){var path="/home/azer/Desktop/jenkins/app/monitoringApp/services/task/updateAssignee.js";var hash="d424aa2609a8790247a2e54a7e86135d93ec88cf";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/azer/Desktop/jenkins/app/monitoringApp/services/task/updateAssignee.js",statementMap:{"0":{start:{line:1,column:13},end:{line:1,column:41}},"1":{start:{line:2,column:0},end:{line:60,column:2}},"2":{start:{line:3,column:2},end:{line:59,column:3}},"3":{start:{line:4,column:18},end:{line:4,column:20}},"4":{start:{line:5,column:4},end:{line:7,column:7}},"5":{start:{line:6,column:6},end:{line:6,column:44}},"6":{start:{line:9,column:25},end:{line:16,column:13}},"7":{start:{line:18,column:27},end:{line:18,column:29}},"8":{start:{line:19,column:27},end:{line:21,column:13}},"9":{start:{line:23,column:4},end:{line:37,column:7}},"10":{start:{line:24,column:6},end:{line:36,column:7}},"11":{start:{line:25,column:8},end:{line:29,column:11}},"12":{start:{line:30,column:13},end:{line:36,column:7}},"13":{start:{line:31,column:8},end:{line:35,column:11}},"14":{start:{line:39,column:4},end:{line:45,column:5}},"15":{start:{line:40,column:6},end:{line:44,column:8}},"16":{start:{line:47,column:4},end:{line:54,column:5}},"17":{start:{line:48,column:6},end:{line:53,column:8}},"18":{start:{line:56,column:4},end:{line:56,column:53}},"19":{start:{line:58,column:4},end:{line:58,column:36}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:2,column:17},end:{line:2,column:18}},loc:{start:{line:2,column:43},end:{line:60,column:1}},line:2},"1":{name:"(anonymous_1)",decl:{start:{line:5,column:29},end:{line:5,column:30}},loc:{start:{line:5,column:40},end:{line:7,column:5}},line:5},"2":{name:"(anonymous_2)",decl:{start:{line:23,column:23},end:{line:23,column:24}},loc:{start:{line:23,column:33},end:{line:37,column:5}},line:23}},branchMap:{"0":{loc:{start:{line:24,column:6},end:{line:36,column:7}},type:"if",locations:[{start:{line:24,column:6},end:{line:36,column:7}},{start:{line:24,column:6},end:{line:36,column:7}}],line:24},"1":{loc:{start:{line:24,column:10},end:{line:24,column:52}},type:"binary-expr",locations:[{start:{line:24,column:10},end:{line:24,column:35}},{start:{line:24,column:39},end:{line:24,column:52}}],line:24},"2":{loc:{start:{line:30,column:13},end:{line:36,column:7}},type:"if",locations:[{start:{line:30,column:13},end:{line:36,column:7}},{start:{line:30,column:13},end:{line:36,column:7}}],line:30},"3":{loc:{start:{line:30,column:17},end:{line:30,column:81}},type:"binary-expr",locations:[{start:{line:30,column:18},end:{line:30,column:62}},{start:{line:30,column:66},end:{line:30,column:81}}],line:30},"4":{loc:{start:{line:39,column:4},end:{line:45,column:5}},type:"if",locations:[{start:{line:39,column:4},end:{line:45,column:5}},{start:{line:39,column:4},end:{line:45,column:5}}],line:39},"5":{loc:{start:{line:47,column:4},end:{line:54,column:5}},type:"if",locations:[{start:{line:47,column:4},end:{line:54,column:5}},{start:{line:47,column:4},end:{line:54,column:5}}],line:47}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"d424aa2609a8790247a2e54a7e86135d93ec88cf"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_27ay84z4zq=function(){return actualCoverage;};}return actualCoverage;}cov_27ay84z4zq();const Task=(cov_27ay84z4zq().s[0]++,require("../../models/Task"));cov_27ay84z4zq().s[1]++;module.exports=async(body,toUpdate)=>{cov_27ay84z4zq().f[0]++;cov_27ay84z4zq().s[2]++;try{let taskIDs=(cov_27ay84z4zq().s[3]++,[]);cov_27ay84z4zq().s[4]++;body.taskObjects.forEach(element=>{cov_27ay84z4zq().f[1]++;cov_27ay84z4zq().s[5]++;taskIDs=[...taskIDs,element.taskId];});const taskDocument=(cov_27ay84z4zq().s[6]++,await Task.updateMany({_id:{$in:taskIDs}},toUpdate).lean().exec());let taskSearchResult=(cov_27ay84z4zq().s[7]++,[]);const getUpdatedTask=(cov_27ay84z4zq().s[8]++,await Task.find({_id:{$in:taskIDs}}).lean().exec());cov_27ay84z4zq().s[9]++;getUpdatedTask.map(task=>{cov_27ay84z4zq().f[2]++;cov_27ay84z4zq().s[10]++;if((cov_27ay84z4zq().b[1][0]++,task.state!=="Canceled")&&(cov_27ay84z4zq().b[1][1]++,body.toCancel)){cov_27ay84z4zq().b[0][0]++;cov_27ay84z4zq().s[11]++;taskSearchResult.push({taskName:task.title,task_id:task._id,estimatedStart:task.estimatedStart});}else{cov_27ay84z4zq().b[0][1]++;cov_27ay84z4zq().s[12]++;if((cov_27ay84z4zq().b[3][0]++,task.assignee.toString()!==body.assigneeId)&&(cov_27ay84z4zq().b[3][1]++,!body?.toCancel)){cov_27ay84z4zq().b[2][0]++;cov_27ay84z4zq().s[13]++;taskSearchResult.push({taskName:task.title,task_id:task._id,estimatedStart:task.estimatedStart});}else{cov_27ay84z4zq().b[2][1]++;}}});cov_27ay84z4zq().s[14]++;if(taskDocument?.n===0){cov_27ay84z4zq().b[4][0]++;cov_27ay84z4zq().s[15]++;return{err:{message:"Task not found."},status:"error",statusCode:204};}else{cov_27ay84z4zq().b[4][1]++;}cov_27ay84z4zq().s[16]++;if(taskSearchResult.length>0){cov_27ay84z4zq().b[5][0]++;cov_27ay84z4zq().s[17]++;return{data:taskSearchResult,err:{message:"Not All Tasks Updated."},status:"incomplete",statusCode:400};}else{cov_27ay84z4zq().b[5][1]++;}cov_27ay84z4zq().s[18]++;return{data:taskDocument,status:"success"};}catch(err){cov_27ay84z4zq().s[19]++;return{err,status:"error"};}};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVwZGF0ZUFzc2lnbmVlLmpzIl0sIm5hbWVzIjpbIlRhc2siLCJyZXF1aXJlIiwibW9kdWxlIiwiZXhwb3J0cyIsImJvZHkiLCJ0b1VwZGF0ZSIsInRhc2tJRHMiLCJ0YXNrT2JqZWN0cyIsImZvckVhY2giLCJlbGVtZW50IiwidGFza0lkIiwidGFza0RvY3VtZW50IiwidXBkYXRlTWFueSIsIl9pZCIsIiRpbiIsImxlYW4iLCJleGVjIiwidGFza1NlYXJjaFJlc3VsdCIsImdldFVwZGF0ZWRUYXNrIiwiZmluZCIsIm1hcCIsInRhc2siLCJzdGF0ZSIsInRvQ2FuY2VsIiwicHVzaCIsInRhc2tOYW1lIiwidGl0bGUiLCJ0YXNrX2lkIiwiZXN0aW1hdGVkU3RhcnQiLCJhc3NpZ25lZSIsInRvU3RyaW5nIiwiYXNzaWduZWVJZCIsIm4iLCJlcnIiLCJtZXNzYWdlIiwic3RhdHVzIiwic3RhdHVzQ29kZSIsImxlbmd0aCIsImRhdGEiXSwibWFwcGluZ3MiOiI4OUdBZVk7MkZBZlosS0FBTUEsQ0FBQUEsSUFBSSwwQkFBR0MsT0FBTyxDQUFDLG1CQUFELENBQVYsQ0FBVixDLHdCQUNBQyxNQUFNLENBQUNDLE9BQVAsQ0FBaUIsTUFBT0MsSUFBUCxDQUFhQyxRQUFiLEdBQTBCLGlEQUN6QyxHQUFJLENBQ0YsR0FBSUMsQ0FBQUEsT0FBTywwQkFBRyxFQUFILENBQVgsQ0FERSx3QkFFRkYsSUFBSSxDQUFDRyxXQUFMLENBQWlCQyxPQUFqQixDQUF5QkMsT0FBTyxFQUFJLGlEQUNsQ0gsT0FBTyxDQUFHLENBQUMsR0FBR0EsT0FBSixDQUFhRyxPQUFPLENBQUNDLE1BQXJCLENBQVYsQ0FDRCxDQUZELEVBSUEsS0FBTUMsQ0FBQUEsWUFBWSwwQkFBRyxLQUFNWCxDQUFBQSxJQUFJLENBQUNZLFVBQUwsQ0FDekIsQ0FDRUMsR0FBRyxDQUFFLENBQUVDLEdBQUcsQ0FBRVIsT0FBUCxDQURQLENBRHlCLENBSXpCRCxRQUp5QixFQU14QlUsSUFOd0IsR0FPeEJDLElBUHdCLEVBQVQsQ0FBbEIsQ0FTQSxHQUFJQyxDQUFBQSxnQkFBZ0IsMEJBQUcsRUFBSCxDQUFwQixDQUNBLEtBQU1DLENBQUFBLGNBQWMsMEJBQUcsS0FBTWxCLENBQUFBLElBQUksQ0FBQ21CLElBQUwsQ0FBVSxDQUFFTixHQUFHLENBQUUsQ0FBRUMsR0FBRyxDQUFFUixPQUFQLENBQVAsQ0FBVixFQUMxQlMsSUFEMEIsR0FFMUJDLElBRjBCLEVBQVQsQ0FBcEIsQ0FoQkUsd0JBb0JGRSxjQUFjLENBQUNFLEdBQWYsQ0FBb0JDLElBQUQsRUFBVSxrREFDM0IsR0FBSSw0QkFBQUEsSUFBSSxDQUFDQyxLQUFMLEdBQWUsVUFBZiwrQkFBNkJsQixJQUFJLENBQUNtQixRQUFsQyxDQUFKLENBQWdELHFEQUM5Q04sZ0JBQWdCLENBQUNPLElBQWpCLENBQXNCLENBQ3BCQyxRQUFRLENBQUVKLElBQUksQ0FBQ0ssS0FESyxDQUVwQkMsT0FBTyxDQUFFTixJQUFJLENBQUNSLEdBRk0sQ0FHcEJlLGNBQWMsQ0FBRVAsSUFBSSxDQUFDTyxjQUhELENBQXRCLEVBS0QsQ0FORCxJQU1PLHdEQUFJLDRCQUFDUCxJQUFJLENBQUNRLFFBQUwsQ0FBY0MsUUFBZCxLQUE2QjFCLElBQUksQ0FBQzJCLFVBQW5DLCtCQUFpRCxDQUFDM0IsSUFBSSxFQUFFbUIsUUFBeEQsQ0FBSixDQUFzRSxxREFDM0VOLGdCQUFnQixDQUFDTyxJQUFqQixDQUFzQixDQUNwQkMsUUFBUSxDQUFFSixJQUFJLENBQUNLLEtBREssQ0FFcEJDLE9BQU8sQ0FBRU4sSUFBSSxDQUFDUixHQUZNLENBR3BCZSxjQUFjLENBQUVQLElBQUksQ0FBQ08sY0FIRCxDQUF0QixFQUtELENBTk0saUNBTU4sQ0FDRixDQWRELEVBcEJFLHlCQW9DRixHQUFJakIsWUFBWSxFQUFFcUIsQ0FBZCxHQUFvQixDQUF4QixDQUEyQixxREFDekIsTUFBTyxDQUNMQyxHQUFHLENBQUUsQ0FBRUMsT0FBTyxDQUFFLGlCQUFYLENBREEsQ0FFTEMsTUFBTSxDQUFFLE9BRkgsQ0FHTEMsVUFBVSxDQUFFLEdBSFAsQ0FBUCxDQUtELENBTkQsaUNBcENFLHlCQTRDRixHQUFJbkIsZ0JBQWdCLENBQUNvQixNQUFqQixDQUEwQixDQUE5QixDQUFpQyxxREFDL0IsTUFBTyxDQUNMQyxJQUFJLENBQUVyQixnQkFERCxDQUVMZ0IsR0FBRyxDQUFFLENBQUVDLE9BQU8sQ0FBRSx3QkFBWCxDQUZBLENBR0xDLE1BQU0sQ0FBRSxZQUhILENBSUxDLFVBQVUsQ0FBRSxHQUpQLENBQVAsQ0FNRCxDQVBELGlDQTVDRSx5QkFxREYsTUFBTyxDQUFFRSxJQUFJLENBQUUzQixZQUFSLENBQXNCd0IsTUFBTSxDQUFFLFNBQTlCLENBQVAsQ0FDRCxDQUFDLE1BQU9GLEdBQVAsQ0FBWSwwQkFDWixNQUFPLENBQUVBLEdBQUYsQ0FBT0UsTUFBTSxDQUFFLE9BQWYsQ0FBUCxDQUNELENBQ0YsQ0ExREQiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBUYXNrID0gcmVxdWlyZShcIi4uLy4uL21vZGVscy9UYXNrXCIpO1xubW9kdWxlLmV4cG9ydHMgPSBhc3luYyAoYm9keSwgdG9VcGRhdGUpID0+IHtcbiAgdHJ5IHtcbiAgICBsZXQgdGFza0lEcyA9IFtdXG4gICAgYm9keS50YXNrT2JqZWN0cy5mb3JFYWNoKGVsZW1lbnQgPT4ge1xuICAgICAgdGFza0lEcyA9IFsuLi50YXNrSURzLCBlbGVtZW50LnRhc2tJZF1cbiAgICB9KTtcblxuICAgIGNvbnN0IHRhc2tEb2N1bWVudCA9IGF3YWl0IFRhc2sudXBkYXRlTWFueShcbiAgICAgIHtcbiAgICAgICAgX2lkOiB7ICRpbjogdGFza0lEcyB9XG4gICAgICB9LFxuICAgICAgdG9VcGRhdGVcbiAgICApXG4gICAgICAubGVhbigpXG4gICAgICAuZXhlYygpO1xuXG4gICAgbGV0IHRhc2tTZWFyY2hSZXN1bHQgPSBbXTtcbiAgICBjb25zdCBnZXRVcGRhdGVkVGFzayA9IGF3YWl0IFRhc2suZmluZCh7IF9pZDogeyAkaW46IHRhc2tJRHMgfSB9KVxuICAgICAgLmxlYW4oKVxuICAgICAgLmV4ZWMoKTtcblxuICAgIGdldFVwZGF0ZWRUYXNrLm1hcCgodGFzaykgPT4ge1xuICAgICAgaWYgKHRhc2suc3RhdGUgIT09IFwiQ2FuY2VsZWRcIiAmJiBib2R5LnRvQ2FuY2VsKSB7XG4gICAgICAgIHRhc2tTZWFyY2hSZXN1bHQucHVzaCh7XG4gICAgICAgICAgdGFza05hbWU6IHRhc2sudGl0bGUsXG4gICAgICAgICAgdGFza19pZDogdGFzay5faWQsXG4gICAgICAgICAgZXN0aW1hdGVkU3RhcnQ6IHRhc2suZXN0aW1hdGVkU3RhcnQsXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmICgodGFzay5hc3NpZ25lZS50b1N0cmluZygpICE9PSBib2R5LmFzc2lnbmVlSWQpJiYgIWJvZHk/LnRvQ2FuY2VsKSB7XG4gICAgICAgIHRhc2tTZWFyY2hSZXN1bHQucHVzaCh7XG4gICAgICAgICAgdGFza05hbWU6IHRhc2sudGl0bGUsXG4gICAgICAgICAgdGFza19pZDogdGFzay5faWQsXG4gICAgICAgICAgZXN0aW1hdGVkU3RhcnQ6IHRhc2suZXN0aW1hdGVkU3RhcnQsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKHRhc2tEb2N1bWVudD8ubiA9PT0gMCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZXJyOiB7IG1lc3NhZ2U6IFwiVGFzayBub3QgZm91bmQuXCIgfSxcbiAgICAgICAgc3RhdHVzOiBcImVycm9yXCIsXG4gICAgICAgIHN0YXR1c0NvZGU6IDIwNCxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgaWYgKHRhc2tTZWFyY2hSZXN1bHQubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZGF0YTogdGFza1NlYXJjaFJlc3VsdCxcbiAgICAgICAgZXJyOiB7IG1lc3NhZ2U6IFwiTm90IEFsbCBUYXNrcyBVcGRhdGVkLlwiIH0sXG4gICAgICAgIHN0YXR1czogXCJpbmNvbXBsZXRlXCIsXG4gICAgICAgIHN0YXR1c0NvZGU6IDQwMCxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgZGF0YTogdGFza0RvY3VtZW50LCBzdGF0dXM6IFwic3VjY2Vzc1wiIH07XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIHJldHVybiB7IGVyciwgc3RhdHVzOiBcImVycm9yXCIgfTtcbiAgfVxufTtcbiJdfQ==