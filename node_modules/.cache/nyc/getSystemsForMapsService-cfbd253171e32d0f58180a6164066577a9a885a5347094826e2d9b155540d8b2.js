function cov_2f0qfqn6qg(){var path="/home/azer/Desktop/jenkins/app/monitoringApp/services/system/getSystemsForMapsService.js";var hash="5fda0c411feb8b11ff301a16f3cca98fb1cd7042";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/azer/Desktop/jenkins/app/monitoringApp/services/system/getSystemsForMapsService.js",statementMap:{"0":{start:{line:1,column:15},end:{line:1,column:45}},"1":{start:{line:2,column:17},end:{line:2,column:36}},"2":{start:{line:4,column:0},end:{line:76,column:2}},"3":{start:{line:5,column:2},end:{line:75,column:3}},"4":{start:{line:6,column:22},end:{line:6,column:40}},"5":{start:{line:7,column:4},end:{line:7,column:78}},"6":{start:{line:8,column:4},end:{line:8,column:66}},"7":{start:{line:9,column:4},end:{line:9,column:78}},"8":{start:{line:10,column:4},end:{line:10,column:69}},"9":{start:{line:11,column:22},end:{line:70,column:6}},"10":{start:{line:71,column:20},end:{line:71,column:53}},"11":{start:{line:72,column:4},end:{line:72,column:48}},"12":{start:{line:74,column:4},end:{line:74,column:36}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:4,column:17},end:{line:4,column:18}},loc:{start:{line:4,column:69},end:{line:76,column:1}},line:4}},branchMap:{"0":{loc:{start:{line:7,column:4},end:{line:7,column:77}},type:"binary-expr",locations:[{start:{line:7,column:4},end:{line:7,column:14}},{start:{line:7,column:19},end:{line:7,column:76}}],line:7},"1":{loc:{start:{line:8,column:4},end:{line:8,column:65}},type:"binary-expr",locations:[{start:{line:8,column:4},end:{line:8,column:10}},{start:{line:8,column:15},end:{line:8,column:64}}],line:8},"2":{loc:{start:{line:9,column:4},end:{line:9,column:77}},type:"binary-expr",locations:[{start:{line:9,column:4},end:{line:9,column:14}},{start:{line:9,column:19},end:{line:9,column:76}}],line:9},"3":{loc:{start:{line:10,column:4},end:{line:10,column:68}},type:"binary-expr",locations:[{start:{line:10,column:4},end:{line:10,column:12}},{start:{line:10,column:17},end:{line:10,column:67}}],line:10}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},f:{"0":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"5fda0c411feb8b11ff301a16f3cca98fb1cd7042"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2f0qfqn6qg=function(){return actualCoverage;};}return actualCoverage;}cov_2f0qfqn6qg();const System=(cov_2f0qfqn6qg().s[0]++,require("../../models/System"));const mongoose=(cov_2f0qfqn6qg().s[1]++,require("mongoose"));cov_2f0qfqn6qg().s[2]++;module.exports=async(customerId,typeId,categoryId,systemId)=>{cov_2f0qfqn6qg().f[0]++;cov_2f0qfqn6qg().s[3]++;try{const filtering=(cov_2f0qfqn6qg().s[4]++,{isActive:true});cov_2f0qfqn6qg().s[5]++;(cov_2f0qfqn6qg().b[0][0]++,customerId)&&(cov_2f0qfqn6qg().b[0][1]++,filtering.customer=mongoose.Types.ObjectId(customerId));cov_2f0qfqn6qg().s[6]++;(cov_2f0qfqn6qg().b[1][0]++,typeId)&&(cov_2f0qfqn6qg().b[1][1]++,filtering.type=mongoose.Types.ObjectId(typeId));cov_2f0qfqn6qg().s[7]++;(cov_2f0qfqn6qg().b[2][0]++,categoryId)&&(cov_2f0qfqn6qg().b[2][1]++,filtering.category=mongoose.Types.ObjectId(categoryId));cov_2f0qfqn6qg().s[8]++;(cov_2f0qfqn6qg().b[3][0]++,systemId)&&(cov_2f0qfqn6qg().b[3][1]++,filtering._id=mongoose.Types.ObjectId(systemId));const aggregate=(cov_2f0qfqn6qg().s[9]++,[{$match:filtering},{$lookup:{from:'customers',localField:'customer',foreignField:'_id',as:'populatedCustomer'}},{$set:{"CustomerStatus":{"$arrayElemAt":["$populatedCustomer.isActive",0]}}},{$lookup:{from:'categories',localField:'category',foreignField:'_id',as:'populatedCategory'}},{$set:{"CategoryStatus":{"$arrayElemAt":["$populatedCategory.isActive",0]}}},{$lookup:{from:'types',localField:'type',foreignField:'_id',as:'populatedType'}},{$set:{"TypeStatus":{"$arrayElemAt":["$populatedType.isActive",0]}}},{$match:{CustomerStatus:true,CategoryStatus:true,TypeStatus:true}},{$project:{name:1}}]);const systems=(cov_2f0qfqn6qg().s[10]++,await System.aggregate(aggregate));cov_2f0qfqn6qg().s[11]++;return{data:systems,status:"success"};}catch(err){cov_2f0qfqn6qg().s[12]++;return{err,status:"error"};}};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdldFN5c3RlbXNGb3JNYXBzU2VydmljZS5qcyJdLCJuYW1lcyI6WyJTeXN0ZW0iLCJyZXF1aXJlIiwibW9uZ29vc2UiLCJtb2R1bGUiLCJleHBvcnRzIiwiY3VzdG9tZXJJZCIsInR5cGVJZCIsImNhdGVnb3J5SWQiLCJzeXN0ZW1JZCIsImZpbHRlcmluZyIsImlzQWN0aXZlIiwiY3VzdG9tZXIiLCJUeXBlcyIsIk9iamVjdElkIiwidHlwZSIsImNhdGVnb3J5IiwiX2lkIiwiYWdncmVnYXRlIiwiJG1hdGNoIiwiJGxvb2t1cCIsImZyb20iLCJsb2NhbEZpZWxkIiwiZm9yZWlnbkZpZWxkIiwiYXMiLCIkc2V0IiwiQ3VzdG9tZXJTdGF0dXMiLCJDYXRlZ29yeVN0YXR1cyIsIlR5cGVTdGF0dXMiLCIkcHJvamVjdCIsIm5hbWUiLCJzeXN0ZW1zIiwiZGF0YSIsInN0YXR1cyIsImVyciJdLCJtYXBwaW5ncyI6Imk0RUFlWTsyRkFmWixLQUFNQSxDQUFBQSxNQUFNLDBCQUFHQyxPQUFPLENBQUMscUJBQUQsQ0FBVixDQUFaLENBQ0EsS0FBTUMsQ0FBQUEsUUFBUSwwQkFBR0QsT0FBTyxDQUFDLFVBQUQsQ0FBVixDQUFkLEMsd0JBRUFFLE1BQU0sQ0FBQ0MsT0FBUCxDQUFpQixNQUFPQyxVQUFQLENBQW1CQyxNQUFuQixDQUEyQkMsVUFBM0IsQ0FBdUNDLFFBQXZDLEdBQW9ELGlEQUNuRSxHQUFJLENBQ0YsS0FBTUMsQ0FBQUEsU0FBUywwQkFBRyxDQUFFQyxRQUFRLENBQUUsSUFBWixDQUFILENBQWYsQ0FERSx3QkFFRiw0QkFBQUwsVUFBVSwrQkFBS0ksU0FBUyxDQUFDRSxRQUFWLENBQXNCVCxRQUFRLENBQUNVLEtBQVQsQ0FBZUMsUUFBZixDQUF3QlIsVUFBeEIsQ0FBM0IsQ0FBVixDQUZFLHdCQUdGLDRCQUFBQyxNQUFNLCtCQUFLRyxTQUFTLENBQUNLLElBQVYsQ0FBa0JaLFFBQVEsQ0FBQ1UsS0FBVCxDQUFlQyxRQUFmLENBQXdCUCxNQUF4QixDQUF2QixDQUFOLENBSEUsd0JBSUYsNEJBQUFDLFVBQVUsK0JBQUtFLFNBQVMsQ0FBQ00sUUFBVixDQUFzQmIsUUFBUSxDQUFDVSxLQUFULENBQWVDLFFBQWYsQ0FBd0JOLFVBQXhCLENBQTNCLENBQVYsQ0FKRSx3QkFLRiw0QkFBQUMsUUFBUSwrQkFBS0MsU0FBUyxDQUFDTyxHQUFWLENBQWlCZCxRQUFRLENBQUNVLEtBQVQsQ0FBZUMsUUFBZixDQUF3QkwsUUFBeEIsQ0FBdEIsQ0FBUixDQUNBLEtBQU1TLENBQUFBLFNBQVMsMEJBQUcsQ0FDaEIsQ0FDRUMsTUFBTSxDQUFFVCxTQURWLENBRGdCLENBSWhCLENBQ0FVLE9BQU8sQ0FBRSxDQUNQQyxJQUFJLENBQUUsV0FEQyxDQUVQQyxVQUFVLENBQUUsVUFGTCxDQUdQQyxZQUFZLENBQUUsS0FIUCxDQUlQQyxFQUFFLENBQUUsbUJBSkcsQ0FEVCxDQUpnQixDQVdmLENBQ0RDLElBQUksQ0FDSixDQUNFLGlCQUFrQixDQUNoQixlQUFnQixDQUFDLDZCQUFELENBQWdDLENBQWhDLENBREEsQ0FEcEIsQ0FGQyxDQVhlLENBbUJsQixDQUNFTCxPQUFPLENBQUUsQ0FDUEMsSUFBSSxDQUFFLFlBREMsQ0FFUEMsVUFBVSxDQUFFLFVBRkwsQ0FHUEMsWUFBWSxDQUFFLEtBSFAsQ0FJUEMsRUFBRSxDQUFFLG1CQUpHLENBRFgsQ0FuQmtCLENBMEJmLENBQ0RDLElBQUksQ0FDSixDQUNFLGlCQUFrQixDQUNoQixlQUFnQixDQUFDLDZCQUFELENBQWdDLENBQWhDLENBREEsQ0FEcEIsQ0FGQyxDQTFCZSxDQWtDbEIsQ0FDRUwsT0FBTyxDQUFFLENBQ1BDLElBQUksQ0FBRSxPQURDLENBRVBDLFVBQVUsQ0FBRSxNQUZMLENBR1BDLFlBQVksQ0FBRSxLQUhQLENBSVBDLEVBQUUsQ0FBRSxlQUpHLENBRFgsQ0FsQ2tCLENBeUNmLENBQ0RDLElBQUksQ0FDSixDQUNFLGFBQWMsQ0FDWixlQUFnQixDQUFDLHlCQUFELENBQTRCLENBQTVCLENBREosQ0FEaEIsQ0FGQyxDQXpDZSxDQWlEakIsQ0FDQ04sTUFBTSxDQUFFLENBQ05PLGNBQWMsQ0FBRSxJQURWLENBRU5DLGNBQWMsQ0FBRyxJQUZYLENBR05DLFVBQVUsQ0FBRyxJQUhQLENBRFQsQ0FqRGlCLENBdURmLENBQ0RDLFFBQVEsQ0FBRSxDQUNSQyxJQUFJLENBQUUsQ0FERSxDQURULENBdkRlLENBQUgsQ0FBZixDQTREQSxLQUFNQyxDQUFBQSxPQUFPLDJCQUFHLEtBQU05QixDQUFBQSxNQUFNLENBQUNpQixTQUFQLENBQWlCQSxTQUFqQixDQUFULENBQWIsQ0FsRUUseUJBbUVGLE1BQU8sQ0FBRWMsSUFBSSxDQUFFRCxPQUFSLENBQWlCRSxNQUFNLENBQUUsU0FBekIsQ0FBUCxDQUNELENBQUMsTUFBT0MsR0FBUCxDQUFZLDBCQUNaLE1BQU8sQ0FBRUEsR0FBRixDQUFPRCxNQUFNLENBQUUsT0FBZixDQUFQLENBQ0QsQ0FDRixDQXhFRCIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFN5c3RlbSA9IHJlcXVpcmUoXCIuLi8uLi9tb2RlbHMvU3lzdGVtXCIpO1xuY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKFwibW9uZ29vc2VcIik7XG5cbm1vZHVsZS5leHBvcnRzID0gYXN5bmMgKGN1c3RvbWVySWQsIHR5cGVJZCwgY2F0ZWdvcnlJZCwgc3lzdGVtSWQpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBmaWx0ZXJpbmcgPSB7IGlzQWN0aXZlOiB0cnVlIH07XG4gICAgY3VzdG9tZXJJZCAmJiAoZmlsdGVyaW5nLmN1c3RvbWVyID0gIG1vbmdvb3NlLlR5cGVzLk9iamVjdElkKGN1c3RvbWVySWQpKTtcbiAgICB0eXBlSWQgJiYgKGZpbHRlcmluZy50eXBlID0gIG1vbmdvb3NlLlR5cGVzLk9iamVjdElkKHR5cGVJZCkpO1xuICAgIGNhdGVnb3J5SWQgJiYgKGZpbHRlcmluZy5jYXRlZ29yeSA9ICBtb25nb29zZS5UeXBlcy5PYmplY3RJZChjYXRlZ29yeUlkKSk7XG4gICAgc3lzdGVtSWQgJiYgKGZpbHRlcmluZy5faWQgPSAgbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQoc3lzdGVtSWQpKTtcbiAgICBjb25zdCBhZ2dyZWdhdGUgPSBbXG4gICAgICB7XG4gICAgICAgICRtYXRjaDogZmlsdGVyaW5nXG4gICAgICB9LFxuICAgICAge1xuICAgICAgJGxvb2t1cDoge1xuICAgICAgICBmcm9tOiAnY3VzdG9tZXJzJyxcbiAgICAgICAgbG9jYWxGaWVsZDogJ2N1c3RvbWVyJyxcbiAgICAgICAgZm9yZWlnbkZpZWxkOiAnX2lkJyxcbiAgICAgICAgYXM6ICdwb3B1bGF0ZWRDdXN0b21lcidcbiAgICAgIH1cbiAgICB9LCB7XG4gICAgICAkc2V0OlxuICAgICAge1xuICAgICAgICBcIkN1c3RvbWVyU3RhdHVzXCI6IHtcbiAgICAgICAgICBcIiRhcnJheUVsZW1BdFwiOiBbXCIkcG9wdWxhdGVkQ3VzdG9tZXIuaXNBY3RpdmVcIiwgMF1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAge1xuICAgICAgJGxvb2t1cDoge1xuICAgICAgICBmcm9tOiAnY2F0ZWdvcmllcycsXG4gICAgICAgIGxvY2FsRmllbGQ6ICdjYXRlZ29yeScsXG4gICAgICAgIGZvcmVpZ25GaWVsZDogJ19pZCcsXG4gICAgICAgIGFzOiAncG9wdWxhdGVkQ2F0ZWdvcnknXG4gICAgICB9XG4gICAgfSwge1xuICAgICAgJHNldDpcbiAgICAgIHtcbiAgICAgICAgXCJDYXRlZ29yeVN0YXR1c1wiOiB7XG4gICAgICAgICAgXCIkYXJyYXlFbGVtQXRcIjogW1wiJHBvcHVsYXRlZENhdGVnb3J5LmlzQWN0aXZlXCIsIDBdXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIHtcbiAgICAgICRsb29rdXA6IHtcbiAgICAgICAgZnJvbTogJ3R5cGVzJyxcbiAgICAgICAgbG9jYWxGaWVsZDogJ3R5cGUnLFxuICAgICAgICBmb3JlaWduRmllbGQ6ICdfaWQnLFxuICAgICAgICBhczogJ3BvcHVsYXRlZFR5cGUnXG4gICAgICB9XG4gICAgfSwge1xuICAgICAgJHNldDpcbiAgICAgIHtcbiAgICAgICAgXCJUeXBlU3RhdHVzXCI6IHtcbiAgICAgICAgICBcIiRhcnJheUVsZW1BdFwiOiBbXCIkcG9wdWxhdGVkVHlwZS5pc0FjdGl2ZVwiLCAwXVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICAge1xuICAgICAgJG1hdGNoOiB7XG4gICAgICAgIEN1c3RvbWVyU3RhdHVzOiB0cnVlLFxuICAgICAgICBDYXRlZ29yeVN0YXR1cyA6IHRydWUsXG4gICAgICAgIFR5cGVTdGF0dXMgOiB0cnVlXG4gICAgICB9XG4gICAgfSwge1xuICAgICAgJHByb2plY3Q6IHtcbiAgICAgICAgbmFtZTogMVxuICAgICAgfVxuICAgIH1dO1xuICAgIGNvbnN0IHN5c3RlbXMgPSBhd2FpdCBTeXN0ZW0uYWdncmVnYXRlKGFnZ3JlZ2F0ZSk7XG4gICAgcmV0dXJuIHsgZGF0YTogc3lzdGVtcywgc3RhdHVzOiBcInN1Y2Nlc3NcIiB9O1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICByZXR1cm4geyBlcnIsIHN0YXR1czogXCJlcnJvclwiIH07XG4gIH1cbn07XG4iXX0=