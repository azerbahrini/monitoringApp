function cov_15hq4l466g(){var path="/home/azer/Desktop/jenkins/app/monitoringApp/services/system/getContactList.js";var hash="6f9cf7cfb3cab29d0e8a3979d103e7734ba59413";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/azer/Desktop/jenkins/app/monitoringApp/services/system/getContactList.js",statementMap:{"0":{start:{line:1,column:15},end:{line:1,column:45}},"1":{start:{line:2,column:17},end:{line:2,column:36}},"2":{start:{line:3,column:13},end:{line:3,column:41}},"3":{start:{line:5,column:0},end:{line:107,column:2}},"4":{start:{line:6,column:2},end:{line:106,column:3}},"5":{start:{line:7,column:20},end:{line:7,column:43}},"6":{start:{line:8,column:24},end:{line:25,column:5}},"7":{start:{line:27,column:4},end:{line:44,column:7}},"8":{start:{line:28,column:6},end:{line:43,column:9}},"9":{start:{line:46,column:14},end:{line:89,column:6}},"10":{start:{line:91,column:0},end:{line:93,column:2}},"11":{start:{line:92,column:0},end:{line:92,column:22}},"12":{start:{line:95,column:4},end:{line:101,column:5}},"13":{start:{line:96,column:6},end:{line:100,column:8}},"14":{start:{line:103,column:4},end:{line:103,column:44}},"15":{start:{line:105,column:4},end:{line:105,column:36}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:5,column:17},end:{line:5,column:18}},loc:{start:{line:5,column:50},end:{line:107,column:1}},line:5},"1":{name:"(anonymous_1)",decl:{start:{line:27,column:17},end:{line:27,column:18}},loc:{start:{line:27,column:37},end:{line:44,column:5}},line:27},"2":{name:"(anonymous_2)",decl:{start:{line:91,column:15},end:{line:91,column:16}},loc:{start:{line:91,column:28},end:{line:93,column:1}},line:91}},branchMap:{"0":{loc:{start:{line:95,column:4},end:{line:101,column:5}},type:"if",locations:[{start:{line:95,column:4},end:{line:101,column:5}},{start:{line:95,column:4},end:{line:101,column:5}}],line:95}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"6f9cf7cfb3cab29d0e8a3979d103e7734ba59413"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_15hq4l466g=function(){return actualCoverage;};}return actualCoverage;}cov_15hq4l466g();const System=(cov_15hq4l466g().s[0]++,require("../../models/System"));const mongoose=(cov_15hq4l466g().s[1]++,require("mongoose"));const Type=(cov_15hq4l466g().s[2]++,require("../../models/Type"));cov_15hq4l466g().s[3]++;module.exports=async(systemId,searchValue)=>{cov_15hq4l466g().f[0]++;cov_15hq4l466g().s[4]++;try{const myArray=(cov_15hq4l466g().s[5]++,searchValue?.split(" "));const searchArray=(cov_15hq4l466g().s[6]++,[{$or:[{"contact.lastName":{$regex:"",$options:"i"}},{"contact.mail":{$regex:"",$options:"i"}}]}]);cov_15hq4l466g().s[7]++;myArray?.map(searchFragment=>{cov_15hq4l466g().f[1]++;cov_15hq4l466g().s[8]++;searchArray.push({$or:[{"contact.lastName":{$regex:searchFragment,$options:"i"}},{"contact.mail":{$regex:searchFragment,$options:"i"}}]});});let doc=(cov_15hq4l466g().s[9]++,await System.aggregate([{$match:{_id:mongoose.Types.ObjectId(systemId)}},{$project:{listCustomerContact:1}},{$unwind:{path:"$listCustomerContact",preserveNullAndEmptyArrays:false}},{$lookup:{from:"customercontacts",localField:"listCustomerContact",foreignField:"_id",as:"customerContact"}},{$set:{contact:{$arrayElemAt:["$customerContact",0]}}},{$match:{$and:searchArray}},{$project:{_id:0,contact:1}}]));cov_15hq4l466g().s[10]++;doc=doc?.map(element=>{cov_15hq4l466g().f[2]++;cov_15hq4l466g().s[11]++;return element.contact;});cov_15hq4l466g().s[12]++;if(doc.length===0){cov_15hq4l466g().b[0][0]++;cov_15hq4l466g().s[13]++;return{err:{message:"System not found."},status:"error",statusCode:204};}else{cov_15hq4l466g().b[0][1]++;}cov_15hq4l466g().s[14]++;return{data:doc,status:"success"};}catch(err){cov_15hq4l466g().s[15]++;return{err,status:"error"};}};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdldENvbnRhY3RMaXN0LmpzIl0sIm5hbWVzIjpbIlN5c3RlbSIsInJlcXVpcmUiLCJtb25nb29zZSIsIlR5cGUiLCJtb2R1bGUiLCJleHBvcnRzIiwic3lzdGVtSWQiLCJzZWFyY2hWYWx1ZSIsIm15QXJyYXkiLCJzcGxpdCIsInNlYXJjaEFycmF5IiwiJG9yIiwiJHJlZ2V4IiwiJG9wdGlvbnMiLCJtYXAiLCJzZWFyY2hGcmFnbWVudCIsInB1c2giLCJkb2MiLCJhZ2dyZWdhdGUiLCIkbWF0Y2giLCJfaWQiLCJUeXBlcyIsIk9iamVjdElkIiwiJHByb2plY3QiLCJsaXN0Q3VzdG9tZXJDb250YWN0IiwiJHVud2luZCIsInBhdGgiLCJwcmVzZXJ2ZU51bGxBbmRFbXB0eUFycmF5cyIsIiRsb29rdXAiLCJmcm9tIiwibG9jYWxGaWVsZCIsImZvcmVpZ25GaWVsZCIsImFzIiwiJHNldCIsImNvbnRhY3QiLCIkYXJyYXlFbGVtQXQiLCIkYW5kIiwiZWxlbWVudCIsImxlbmd0aCIsImVyciIsIm1lc3NhZ2UiLCJzdGF0dXMiLCJzdGF0dXNDb2RlIiwiZGF0YSJdLCJtYXBwaW5ncyI6Iit1RUFlWTsyRkFmWixLQUFNQSxDQUFBQSxNQUFNLDBCQUFHQyxPQUFPLENBQUMscUJBQUQsQ0FBVixDQUFaLENBQ0EsS0FBTUMsQ0FBQUEsUUFBUSwwQkFBR0QsT0FBTyxDQUFDLFVBQUQsQ0FBVixDQUFkLENBQ0EsS0FBTUUsQ0FBQUEsSUFBSSwwQkFBR0YsT0FBTyxDQUFDLG1CQUFELENBQVYsQ0FBVixDLHdCQUVBRyxNQUFNLENBQUNDLE9BQVAsQ0FBaUIsTUFBT0MsUUFBUCxDQUFpQkMsV0FBakIsR0FBaUMsaURBQ2hELEdBQUksQ0FDRixLQUFNQyxDQUFBQSxPQUFPLDBCQUFHRCxXQUFXLEVBQUVFLEtBQWIsQ0FBbUIsR0FBbkIsQ0FBSCxDQUFiLENBQ0EsS0FBTUMsQ0FBQUEsV0FBVywwQkFBRyxDQUNsQixDQUNFQyxHQUFHLENBQUUsQ0FDSCxDQUNFLG1CQUFvQixDQUNsQkMsTUFBTSxDQUFFLEVBRFUsQ0FFbEJDLFFBQVEsQ0FBRSxHQUZRLENBRHRCLENBREcsQ0FPSCxDQUNFLGVBQWdCLENBQ2RELE1BQU0sQ0FBRSxFQURNLENBRWRDLFFBQVEsQ0FBRSxHQUZJLENBRGxCLENBUEcsQ0FEUCxDQURrQixDQUFILENBQWpCLENBRkUsd0JBcUJGTCxPQUFPLEVBQUVNLEdBQVQsQ0FBY0MsY0FBRCxFQUFvQixpREFDL0JMLFdBQVcsQ0FBQ00sSUFBWixDQUFpQixDQUNmTCxHQUFHLENBQUUsQ0FDSCxDQUNFLG1CQUFvQixDQUNsQkMsTUFBTSxDQUFFRyxjQURVLENBRWxCRixRQUFRLENBQUUsR0FGUSxDQUR0QixDQURHLENBT0gsQ0FDRSxlQUFnQixDQUNkRCxNQUFNLENBQUVHLGNBRE0sQ0FFZEYsUUFBUSxDQUFFLEdBRkksQ0FEbEIsQ0FQRyxDQURVLENBQWpCLEVBZ0JELENBakJELEVBbUJBLEdBQUlJLENBQUFBLEdBQUcsMEJBQUcsS0FBTWpCLENBQUFBLE1BQU0sQ0FBQ2tCLFNBQVAsQ0FBaUIsQ0FDL0IsQ0FDRUMsTUFBTSxDQUFFLENBQ05DLEdBQUcsQ0FBQ2xCLFFBQVEsQ0FBQ21CLEtBQVQsQ0FBZUMsUUFBZixDQUF3QmhCLFFBQXhCLENBREUsQ0FEVixDQUQrQixDQU0vQixDQUNFaUIsUUFBUSxDQUFFLENBQ1JDLG1CQUFtQixDQUFFLENBRGIsQ0FEWixDQU4rQixDQVcvQixDQUNFQyxPQUFPLENBQUUsQ0FDUEMsSUFBSSxDQUFFLHNCQURDLENBRVBDLDBCQUEwQixDQUFFLEtBRnJCLENBRFgsQ0FYK0IsQ0FpQi9CLENBQ0VDLE9BQU8sQ0FBRSxDQUNQQyxJQUFJLENBQUUsa0JBREMsQ0FFUEMsVUFBVSxDQUFFLHFCQUZMLENBR1BDLFlBQVksQ0FBRSxLQUhQLENBSVBDLEVBQUUsQ0FBRSxpQkFKRyxDQURYLENBakIrQixDQXlCL0IsQ0FDRUMsSUFBSSxDQUFFLENBQ0pDLE9BQU8sQ0FBRSxDQUNQQyxZQUFZLENBQUUsQ0FBQyxrQkFBRCxDQUFxQixDQUFyQixDQURQLENBREwsQ0FEUixDQXpCK0IsQ0FnQy9CLENBQ0VoQixNQUFNLENBQUUsQ0FDTmlCLElBQUksQ0FBRTFCLFdBREEsQ0FEVixDQWhDK0IsQ0FxQy9CLENBQ0VhLFFBQVEsQ0FBRSxDQUNSSCxHQUFHLENBQUUsQ0FERyxDQUVSYyxPQUFPLENBQUUsQ0FGRCxDQURaLENBckMrQixDQUFqQixDQUFULENBQVAsQ0F4Q0UseUJBcUZOakIsR0FBRyxDQUFHQSxHQUFHLEVBQUVILEdBQUwsQ0FBVXVCLE9BQUQsRUFBYSxrREFDNUIsTUFBT0EsQ0FBQUEsT0FBTyxDQUFDSCxPQUFmLENBQ0MsQ0FGSyxDQUFOLENBckZNLHlCQXlGRixHQUFJakIsR0FBRyxDQUFDcUIsTUFBSixHQUFlLENBQW5CLENBQXNCLHFEQUNwQixNQUFPLENBQ0xDLEdBQUcsQ0FBRSxDQUFFQyxPQUFPLENBQUUsbUJBQVgsQ0FEQSxDQUVMQyxNQUFNLENBQUUsT0FGSCxDQUdMQyxVQUFVLENBQUUsR0FIUCxDQUFQLENBS0QsQ0FORCxpQ0F6RkUseUJBaUdGLE1BQU8sQ0FBRUMsSUFBSSxDQUFFMUIsR0FBUixDQUFhd0IsTUFBTSxDQUFFLFNBQXJCLENBQVAsQ0FDRCxDQUFDLE1BQU9GLEdBQVAsQ0FBWSwwQkFDWixNQUFPLENBQUVBLEdBQUYsQ0FBT0UsTUFBTSxDQUFFLE9BQWYsQ0FBUCxDQUNELENBQ0YsQ0F0R0QiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBTeXN0ZW0gPSByZXF1aXJlKFwiLi4vLi4vbW9kZWxzL1N5c3RlbVwiKTtcbmNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZShcIm1vbmdvb3NlXCIpO1xuY29uc3QgVHlwZSA9IHJlcXVpcmUoXCIuLi8uLi9tb2RlbHMvVHlwZVwiKTtcblxubW9kdWxlLmV4cG9ydHMgPSBhc3luYyAoc3lzdGVtSWQsIHNlYXJjaFZhbHVlKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgbXlBcnJheSA9IHNlYXJjaFZhbHVlPy5zcGxpdChcIiBcIik7XG4gICAgY29uc3Qgc2VhcmNoQXJyYXkgPSBbXG4gICAgICB7XG4gICAgICAgICRvcjogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIFwiY29udGFjdC5sYXN0TmFtZVwiOiB7XG4gICAgICAgICAgICAgICRyZWdleDogXCJcIixcbiAgICAgICAgICAgICAgJG9wdGlvbnM6IFwiaVwiLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIFwiY29udGFjdC5tYWlsXCI6IHtcbiAgICAgICAgICAgICAgJHJlZ2V4OiBcIlwiLFxuICAgICAgICAgICAgICAkb3B0aW9uczogXCJpXCIsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgICB9LFxuICAgIF07XG5cbiAgICBteUFycmF5Py5tYXAoKHNlYXJjaEZyYWdtZW50KSA9PiB7XG4gICAgICBzZWFyY2hBcnJheS5wdXNoKHtcbiAgICAgICAgJG9yOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgXCJjb250YWN0Lmxhc3ROYW1lXCI6IHtcbiAgICAgICAgICAgICAgJHJlZ2V4OiBzZWFyY2hGcmFnbWVudCxcbiAgICAgICAgICAgICAgJG9wdGlvbnM6IFwiaVwiLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIFwiY29udGFjdC5tYWlsXCI6IHtcbiAgICAgICAgICAgICAgJHJlZ2V4OiBzZWFyY2hGcmFnbWVudCxcbiAgICAgICAgICAgICAgJG9wdGlvbnM6IFwiaVwiLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBsZXQgZG9jID0gYXdhaXQgU3lzdGVtLmFnZ3JlZ2F0ZShbXG4gICAgICB7XG4gICAgICAgICRtYXRjaDoge1xuICAgICAgICAgIF9pZDptb25nb29zZS5UeXBlcy5PYmplY3RJZChzeXN0ZW1JZCksXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICAkcHJvamVjdDoge1xuICAgICAgICAgIGxpc3RDdXN0b21lckNvbnRhY3Q6IDEsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICAkdW53aW5kOiB7XG4gICAgICAgICAgcGF0aDogXCIkbGlzdEN1c3RvbWVyQ29udGFjdFwiLFxuICAgICAgICAgIHByZXNlcnZlTnVsbEFuZEVtcHR5QXJyYXlzOiBmYWxzZSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgICRsb29rdXA6IHtcbiAgICAgICAgICBmcm9tOiBcImN1c3RvbWVyY29udGFjdHNcIixcbiAgICAgICAgICBsb2NhbEZpZWxkOiBcImxpc3RDdXN0b21lckNvbnRhY3RcIixcbiAgICAgICAgICBmb3JlaWduRmllbGQ6IFwiX2lkXCIsXG4gICAgICAgICAgYXM6IFwiY3VzdG9tZXJDb250YWN0XCIsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICAkc2V0OiB7XG4gICAgICAgICAgY29udGFjdDoge1xuICAgICAgICAgICAgJGFycmF5RWxlbUF0OiBbXCIkY3VzdG9tZXJDb250YWN0XCIsIDBdLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICAkbWF0Y2g6IHtcbiAgICAgICAgICAkYW5kOiBzZWFyY2hBcnJheSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgICRwcm9qZWN0OiB7XG4gICAgICAgICAgX2lkOiAwLFxuICAgICAgICAgIGNvbnRhY3Q6IDEsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIF0pO1xuXG5kb2MgPSBkb2M/Lm1hcCgoZWxlbWVudCkgPT4ge1xucmV0dXJuIGVsZW1lbnQuY29udGFjdFxufSlcblxuICAgIGlmIChkb2MubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBlcnI6IHsgbWVzc2FnZTogXCJTeXN0ZW0gbm90IGZvdW5kLlwiIH0sXG4gICAgICAgIHN0YXR1czogXCJlcnJvclwiLFxuICAgICAgICBzdGF0dXNDb2RlOiAyMDQsXG4gICAgICB9O1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4geyBkYXRhOiBkb2MsIHN0YXR1czogXCJzdWNjZXNzXCIgfTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgcmV0dXJuIHsgZXJyLCBzdGF0dXM6IFwiZXJyb3JcIiB9O1xuICB9XG59O1xuIl19