function cov_ixkto80uo(){var path="/home/azer/Desktop/jenkins/app/monitoringApp/services/task/updateTasks.js";var hash="d784351fcbd9da0dd2cf8428abf87b97c52bde35";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/azer/Desktop/jenkins/app/monitoringApp/services/task/updateTasks.js",statementMap:{"0":{start:{line:1,column:13},end:{line:1,column:41}},"1":{start:{line:4,column:17},end:{line:4,column:52}},"2":{start:{line:5,column:15},end:{line:5,column:47}},"3":{start:{line:7,column:0},end:{line:43,column:2}},"4":{start:{line:8,column:2},end:{line:42,column:3}},"5":{start:{line:9,column:25},end:{line:16,column:13}},"6":{start:{line:18,column:4},end:{line:24,column:5}},"7":{start:{line:19,column:6},end:{line:23,column:8}},"8":{start:{line:25,column:4},end:{line:37,column:5}},"9":{start:{line:26,column:24},end:{line:31,column:7}},"10":{start:{line:34,column:5},end:{line:34,column:43}},"11":{start:{line:35,column:5},end:{line:35,column:34}},"12":{start:{line:38,column:4},end:{line:38,column:53}},"13":{start:{line:40,column:4},end:{line:40,column:29}},"14":{start:{line:41,column:4},end:{line:41,column:36}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:7,column:17},end:{line:7,column:18}},loc:{start:{line:7,column:37},end:{line:43,column:1}},line:7}},branchMap:{"0":{loc:{start:{line:18,column:4},end:{line:24,column:5}},type:"if",locations:[{start:{line:18,column:4},end:{line:24,column:5}},{start:{line:18,column:4},end:{line:24,column:5}}],line:18},"1":{loc:{start:{line:25,column:4},end:{line:37,column:5}},type:"if",locations:[{start:{line:25,column:4},end:{line:37,column:5}},{start:{line:25,column:4},end:{line:37,column:5}}],line:25}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},f:{"0":0},b:{"0":[0,0],"1":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"d784351fcbd9da0dd2cf8428abf87b97c52bde35"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_ixkto80uo=function(){return actualCoverage;};}return actualCoverage;}cov_ixkto80uo();const Task=(cov_ixkto80uo().s[0]++,require('../../models/Task'));//const io = require('../../socket');
//const io = require("../../server");
const producer=(cov_ixkto80uo().s[1]++,require('../../kafka/kafkaPoducer'));const logger=(cov_ixkto80uo().s[2]++,require('./../../config/logger'));cov_ixkto80uo().s[3]++;module.exports=async(id,body)=>{cov_ixkto80uo().f[0]++;cov_ixkto80uo().s[4]++;try{const TaskDocument=(cov_ixkto80uo().s[5]++,await Task.findOneAndUpdate({_id:id},body).lean().exec());cov_ixkto80uo().s[6]++;if(!TaskDocument){cov_ixkto80uo().b[0][0]++;cov_ixkto80uo().s[7]++;return{err:{message:'Task not found.'},status:'error',statusCode:404};}else{cov_ixkto80uo().b[0][1]++;}cov_ixkto80uo().s[8]++;if(TaskDocument.state!==body.state){cov_ixkto80uo().b[1][0]++;const taskState=(cov_ixkto80uo().s[9]++,{taskId:id,oldState:TaskDocument.state,newState:body.state,user:TaskDocument.assignee});// io.getIO().emit(TaskDocument.assignee, 'task-state-changed', taskState);
//io.server.io.emit(TaskDocument.assignee, 'task-state-changed', taskState);
cov_ixkto80uo().s[10]++;logger.debug('Before sending Info !!');cov_ixkto80uo().s[11]++;producer.sendInfo(taskState);}else{cov_ixkto80uo().b[1][1]++;}cov_ixkto80uo().s[12]++;return{data:TaskDocument,status:'success'};}catch(err){cov_ixkto80uo().s[13]++;console.log(err.message);cov_ixkto80uo().s[14]++;return{err,status:'error'};}};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVwZGF0ZVRhc2tzLmpzIl0sIm5hbWVzIjpbIlRhc2siLCJyZXF1aXJlIiwicHJvZHVjZXIiLCJsb2dnZXIiLCJtb2R1bGUiLCJleHBvcnRzIiwiaWQiLCJib2R5IiwiVGFza0RvY3VtZW50IiwiZmluZE9uZUFuZFVwZGF0ZSIsIl9pZCIsImxlYW4iLCJleGVjIiwiZXJyIiwibWVzc2FnZSIsInN0YXR1cyIsInN0YXR1c0NvZGUiLCJzdGF0ZSIsInRhc2tTdGF0ZSIsInRhc2tJZCIsIm9sZFN0YXRlIiwibmV3U3RhdGUiLCJ1c2VyIiwiYXNzaWduZWUiLCJkZWJ1ZyIsInNlbmRJbmZvIiwiZGF0YSIsImNvbnNvbGUiLCJsb2ciXSwibWFwcGluZ3MiOiJtakVBZVk7eUZBZlosS0FBTUEsQ0FBQUEsSUFBSSx5QkFBR0MsT0FBTyxDQUFDLG1CQUFELENBQVYsQ0FBVixDQUNBO0FBQ0E7QUFDQSxLQUFNQyxDQUFBQSxRQUFRLHlCQUFHRCxPQUFPLENBQUMsMEJBQUQsQ0FBVixDQUFkLENBQ0EsS0FBTUUsQ0FBQUEsTUFBTSx5QkFBR0YsT0FBTyxDQUFDLHVCQUFELENBQVYsQ0FBWixDLHVCQUVBRyxNQUFNLENBQUNDLE9BQVAsQ0FBaUIsTUFBT0MsRUFBUCxDQUFXQyxJQUFYLEdBQW9CLCtDQUNuQyxHQUFJLENBQ0YsS0FBTUMsQ0FBQUEsWUFBWSx5QkFBRyxLQUFNUixDQUFBQSxJQUFJLENBQUNTLGdCQUFMLENBQ3pCLENBQ0VDLEdBQUcsQ0FBRUosRUFEUCxDQUR5QixDQUl6QkMsSUFKeUIsRUFNeEJJLElBTndCLEdBT3hCQyxJQVB3QixFQUFULENBQWxCLENBREUsdUJBVUYsR0FBSSxDQUFDSixZQUFMLENBQW1CLGtEQUNqQixNQUFPLENBQ0xLLEdBQUcsQ0FBRSxDQUFFQyxPQUFPLENBQUUsaUJBQVgsQ0FEQSxDQUVMQyxNQUFNLENBQUUsT0FGSCxDQUdMQyxVQUFVLENBQUUsR0FIUCxDQUFQLENBS0QsQ0FORCxnQ0FWRSx1QkFpQkYsR0FBSVIsWUFBWSxDQUFDUyxLQUFiLEdBQXVCVixJQUFJLENBQUNVLEtBQWhDLENBQXVDLDJCQUNyQyxLQUFNQyxDQUFBQSxTQUFTLHlCQUFHLENBQ2hCQyxNQUFNLENBQUViLEVBRFEsQ0FFaEJjLFFBQVEsQ0FBRVosWUFBWSxDQUFDUyxLQUZQLENBR2hCSSxRQUFRLENBQUVkLElBQUksQ0FBQ1UsS0FIQyxDQUloQkssSUFBSSxDQUFFZCxZQUFZLENBQUNlLFFBSkgsQ0FBSCxDQUFmLENBTUQ7QUFDQTtBQVJzQyx3QkFTdENwQixNQUFNLENBQUNxQixLQUFQLENBQWEsd0JBQWIsRUFUc0Msd0JBVXRDdEIsUUFBUSxDQUFDdUIsUUFBVCxDQUFrQlAsU0FBbEIsRUFFQSxDQVpELGdDQWpCRSx3QkE4QkYsTUFBTyxDQUFFUSxJQUFJLENBQUVsQixZQUFSLENBQXNCTyxNQUFNLENBQUUsU0FBOUIsQ0FBUCxDQUNELENBQUMsTUFBT0YsR0FBUCxDQUFZLHlCQUNaYyxPQUFPLENBQUNDLEdBQVIsQ0FBWWYsR0FBRyxDQUFDQyxPQUFoQixFQURZLHdCQUVaLE1BQU8sQ0FBRUQsR0FBRixDQUFPRSxNQUFNLENBQUUsT0FBZixDQUFQLENBQ0QsQ0FDRixDQXBDRCIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFRhc2sgPSByZXF1aXJlKCcuLi8uLi9tb2RlbHMvVGFzaycpO1xuLy9jb25zdCBpbyA9IHJlcXVpcmUoJy4uLy4uL3NvY2tldCcpO1xuLy9jb25zdCBpbyA9IHJlcXVpcmUoXCIuLi8uLi9zZXJ2ZXJcIik7XG5jb25zdCBwcm9kdWNlciA9IHJlcXVpcmUoJy4uLy4uL2thZmthL2thZmthUG9kdWNlcicpO1xuY29uc3QgbG9nZ2VyID0gcmVxdWlyZSgnLi8uLi8uLi9jb25maWcvbG9nZ2VyJylcblxubW9kdWxlLmV4cG9ydHMgPSBhc3luYyAoaWQsIGJvZHkpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBUYXNrRG9jdW1lbnQgPSBhd2FpdCBUYXNrLmZpbmRPbmVBbmRVcGRhdGUoXG4gICAgICB7XG4gICAgICAgIF9pZDogaWRcbiAgICAgIH0sXG4gICAgICBib2R5XG4gICAgKVxuICAgICAgLmxlYW4oKVxuICAgICAgLmV4ZWMoKTtcblxuICAgIGlmICghVGFza0RvY3VtZW50KSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBlcnI6IHsgbWVzc2FnZTogJ1Rhc2sgbm90IGZvdW5kLicgfSxcbiAgICAgICAgc3RhdHVzOiAnZXJyb3InLFxuICAgICAgICBzdGF0dXNDb2RlOiA0MDRcbiAgICAgIH07XG4gICAgfVxuICAgIGlmIChUYXNrRG9jdW1lbnQuc3RhdGUgIT09IGJvZHkuc3RhdGUpIHtcbiAgICAgIGNvbnN0IHRhc2tTdGF0ZSA9IHtcbiAgICAgICAgdGFza0lkOiBpZCxcbiAgICAgICAgb2xkU3RhdGU6IFRhc2tEb2N1bWVudC5zdGF0ZSxcbiAgICAgICAgbmV3U3RhdGU6IGJvZHkuc3RhdGUsXG4gICAgICAgIHVzZXI6IFRhc2tEb2N1bWVudC5hc3NpZ25lZVxuICAgICAgfTtcbiAgICAgLy8gaW8uZ2V0SU8oKS5lbWl0KFRhc2tEb2N1bWVudC5hc3NpZ25lZSwgJ3Rhc2stc3RhdGUtY2hhbmdlZCcsIHRhc2tTdGF0ZSk7XG4gICAgIC8vaW8uc2VydmVyLmlvLmVtaXQoVGFza0RvY3VtZW50LmFzc2lnbmVlLCAndGFzay1zdGF0ZS1jaGFuZ2VkJywgdGFza1N0YXRlKTtcbiAgICAgbG9nZ2VyLmRlYnVnKCdCZWZvcmUgc2VuZGluZyBJbmZvICEhJylcbiAgICAgcHJvZHVjZXIuc2VuZEluZm8odGFza1N0YXRlKTtcblxuICAgIH1cbiAgICByZXR1cm4geyBkYXRhOiBUYXNrRG9jdW1lbnQsIHN0YXR1czogJ3N1Y2Nlc3MnIH07XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGNvbnNvbGUubG9nKGVyci5tZXNzYWdlKTtcbiAgICByZXR1cm4geyBlcnIsIHN0YXR1czogJ2Vycm9yJyB9O1xuICB9XG59O1xuIl19