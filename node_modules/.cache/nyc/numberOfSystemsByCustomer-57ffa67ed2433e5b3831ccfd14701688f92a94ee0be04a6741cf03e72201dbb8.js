function cov_1j419gavx7(){var path="/home/azer/Desktop/jenkins/app/monitoringApp/services/statistics/numberOfSystemsByCustomer.js";var hash="02024be2793cfb2c7d683945ed0b7421acdf859e";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/azer/Desktop/jenkins/app/monitoringApp/services/statistics/numberOfSystemsByCustomer.js",statementMap:{"0":{start:{line:2,column:15},end:{line:2,column:45}},"1":{start:{line:3,column:17},end:{line:3,column:44}},"2":{start:{line:4,column:15},end:{line:4,column:41}},"3":{start:{line:5,column:14},end:{line:5,column:42}},"4":{start:{line:7,column:0},end:{line:45,column:2}},"5":{start:{line:8,column:2},end:{line:44,column:3}},"6":{start:{line:9,column:31},end:{line:9,column:97}},"7":{start:{line:10,column:29},end:{line:10,column:93}},"8":{start:{line:12,column:20},end:{line:32,column:8}},"9":{start:{line:34,column:4},end:{line:40,column:5}},"10":{start:{line:35,column:6},end:{line:39,column:8}},"11":{start:{line:41,column:4},end:{line:41,column:63}},"12":{start:{line:43,column:4},end:{line:43,column:53}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:7,column:17},end:{line:7,column:18}},loc:{start:{line:7,column:59},end:{line:45,column:1}},line:7}},branchMap:{"0":{loc:{start:{line:34,column:4},end:{line:40,column:5}},type:"if",locations:[{start:{line:34,column:4},end:{line:40,column:5}},{start:{line:34,column:4},end:{line:40,column:5}}],line:34}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},f:{"0":0},b:{"0":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"02024be2793cfb2c7d683945ed0b7421acdf859e"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1j419gavx7=function(){return actualCoverage;};}return actualCoverage;}cov_1j419gavx7();const System=(cov_1j419gavx7().s[0]++,require('../../models/System'));const ObjectId=(cov_1j419gavx7().s[1]++,require('mongodb').ObjectId);const moment=(cov_1j419gavx7().s[2]++,require('moment-timezone'));const toUtc=(cov_1j419gavx7().s[3]++,require('../../utils/toUTC'));cov_1j419gavx7().s[4]++;module.exports=async(startDate,endDate,customerID)=>{cov_1j419gavx7().f[0]++;cov_1j419gavx7().s[5]++;try{const convertedStartDate=(cov_1j419gavx7().s[6]++,new Date(toUtc(moment(startDate).tz(timeZone).format(),timeZone)));const convertedEndDate=(cov_1j419gavx7().s[7]++,new Date(toUtc(moment(endDate).tz(timeZone).format(),timeZone)));const stats=(cov_1j419gavx7().s[8]++,await System.aggregate([{'$match':{'customer':new ObjectId(customerID),'createdAt':{$gte:convertedStartDate,$lte:convertedEndDate}}},{'$count':'system'},{'$set':{'Number Of Systems':'$system'}},{'$project':{'system':0}}]));cov_1j419gavx7().s[9]++;if(stats.length===0){cov_1j419gavx7().b[0][0]++;cov_1j419gavx7().s[10]++;return{status:'success',statusCode:204,err:{message:'No data can be found'}};}else{cov_1j419gavx7().b[0][1]++;}cov_1j419gavx7().s[11]++;return{data:stats,status:'success',statusCode:200};}catch(err){cov_1j419gavx7().s[12]++;return{err,status:'error',statusCode:400};}};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm51bWJlck9mU3lzdGVtc0J5Q3VzdG9tZXIuanMiXSwibmFtZXMiOlsiU3lzdGVtIiwicmVxdWlyZSIsIk9iamVjdElkIiwibW9tZW50IiwidG9VdGMiLCJtb2R1bGUiLCJleHBvcnRzIiwic3RhcnREYXRlIiwiZW5kRGF0ZSIsImN1c3RvbWVySUQiLCJjb252ZXJ0ZWRTdGFydERhdGUiLCJEYXRlIiwidHoiLCJ0aW1lWm9uZSIsImZvcm1hdCIsImNvbnZlcnRlZEVuZERhdGUiLCJzdGF0cyIsImFnZ3JlZ2F0ZSIsIiRndGUiLCIkbHRlIiwibGVuZ3RoIiwic3RhdHVzIiwic3RhdHVzQ29kZSIsImVyciIsIm1lc3NhZ2UiLCJkYXRhIl0sIm1hcHBpbmdzIjoic3hEQWVZOzJGQWRaLEtBQU1BLENBQUFBLE1BQU0sMEJBQUdDLE9BQU8sQ0FBQyxxQkFBRCxDQUFWLENBQVosQ0FDQSxLQUFNQyxDQUFBQSxRQUFRLDBCQUFHRCxPQUFPLENBQUMsU0FBRCxDQUFQLENBQW1CQyxRQUF0QixDQUFkLENBQ0EsS0FBTUMsQ0FBQUEsTUFBTSwwQkFBR0YsT0FBTyxDQUFDLGlCQUFELENBQVYsQ0FBWixDQUNBLEtBQU1HLENBQUFBLEtBQUssMEJBQUdILE9BQU8sQ0FBQyxtQkFBRCxDQUFWLENBQVgsQyx3QkFFQUksTUFBTSxDQUFDQyxPQUFQLENBQWlCLE1BQU9DLFNBQVAsQ0FBa0JDLE9BQWxCLENBQTJCQyxVQUEzQixHQUEwQyxpREFDekQsR0FBSSxDQUNGLEtBQU1DLENBQUFBLGtCQUFrQiwwQkFBRyxHQUFJQyxDQUFBQSxJQUFKLENBQVNQLEtBQUssQ0FBQ0QsTUFBTSxDQUFDSSxTQUFELENBQU4sQ0FBa0JLLEVBQWxCLENBQXFCQyxRQUFyQixFQUErQkMsTUFBL0IsRUFBRCxDQUEwQ0QsUUFBMUMsQ0FBZCxDQUFILENBQXhCLENBQ0EsS0FBTUUsQ0FBQUEsZ0JBQWdCLDBCQUFHLEdBQUlKLENBQUFBLElBQUosQ0FBU1AsS0FBSyxDQUFDRCxNQUFNLENBQUNLLE9BQUQsQ0FBTixDQUFnQkksRUFBaEIsQ0FBbUJDLFFBQW5CLEVBQTZCQyxNQUE3QixFQUFELENBQXdDRCxRQUF4QyxDQUFkLENBQUgsQ0FBdEIsQ0FFRSxLQUFNRyxDQUFBQSxLQUFLLDBCQUFHLEtBQU1oQixDQUFBQSxNQUFNLENBQUNpQixTQUFQLENBQWlCLENBQ25DLENBQ0UsU0FBVSxDQUNSLFdBQVksR0FBSWYsQ0FBQUEsUUFBSixDQUFhTyxVQUFiLENBREosQ0FFUixZQUFhLENBQ1RTLElBQUksQ0FBRVIsa0JBREcsQ0FFVFMsSUFBSSxDQUFFSixnQkFGRyxDQUZMLENBRFosQ0FEbUMsQ0FTaEMsQ0FDRCxTQUFVLFFBRFQsQ0FUZ0MsQ0FXaEMsQ0FDRCxPQUFRLENBQ04sb0JBQXFCLFNBRGYsQ0FEUCxDQVhnQyxDQWVoQyxDQUNELFdBQVksQ0FDVixTQUFVLENBREEsQ0FEWCxDQWZnQyxDQUFqQixDQUFULENBQVgsQ0FKQSx3QkEwQkYsR0FBSUMsS0FBSyxDQUFDSSxNQUFOLEdBQWlCLENBQXJCLENBQXdCLHFEQUN0QixNQUFPLENBQ0xDLE1BQU0sQ0FBRSxTQURILENBRUxDLFVBQVUsQ0FBRSxHQUZQLENBR0xDLEdBQUcsQ0FBRSxDQUFFQyxPQUFPLENBQUUsc0JBQVgsQ0FIQSxDQUFQLENBS0QsQ0FORCxpQ0ExQkUseUJBaUNGLE1BQU8sQ0FBRUMsSUFBSSxDQUFFVCxLQUFSLENBQWVLLE1BQU0sQ0FBRSxTQUF2QixDQUFrQ0MsVUFBVSxDQUFFLEdBQTlDLENBQVAsQ0FDRCxDQUFDLE1BQU9DLEdBQVAsQ0FBWSwwQkFDWixNQUFPLENBQUVBLEdBQUYsQ0FBT0YsTUFBTSxDQUFFLE9BQWYsQ0FBd0JDLFVBQVUsQ0FBRSxHQUFwQyxDQUFQLENBQ0QsQ0FDRixDQXRDRCIsInNvdXJjZXNDb250ZW50IjpbIlxuY29uc3QgU3lzdGVtID0gcmVxdWlyZSgnLi4vLi4vbW9kZWxzL1N5c3RlbScpO1xuY29uc3QgT2JqZWN0SWQgPSByZXF1aXJlKCdtb25nb2RiJykuT2JqZWN0SWQ7XG5jb25zdCBtb21lbnQgPSByZXF1aXJlKCdtb21lbnQtdGltZXpvbmUnKTtcbmNvbnN0IHRvVXRjID0gcmVxdWlyZSgnLi4vLi4vdXRpbHMvdG9VVEMnKVxuXG5tb2R1bGUuZXhwb3J0cyA9IGFzeW5jIChzdGFydERhdGUsIGVuZERhdGUsIGN1c3RvbWVySUQpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBjb252ZXJ0ZWRTdGFydERhdGUgPSBuZXcgRGF0ZSh0b1V0Yyhtb21lbnQoc3RhcnREYXRlKS50eih0aW1lWm9uZSkuZm9ybWF0KCksIHRpbWVab25lKSk7XG4gICAgY29uc3QgY29udmVydGVkRW5kRGF0ZSA9IG5ldyBEYXRlKHRvVXRjKG1vbWVudChlbmREYXRlKS50eih0aW1lWm9uZSkuZm9ybWF0KCksIHRpbWVab25lKSk7XG5cbiAgICAgIGNvbnN0IHN0YXRzID0gYXdhaXQgU3lzdGVtLmFnZ3JlZ2F0ZShbXG4gICAgICAgIHtcbiAgICAgICAgICAnJG1hdGNoJzoge1xuICAgICAgICAgICAgJ2N1c3RvbWVyJzogbmV3IE9iamVjdElkKGN1c3RvbWVySUQpLFxuICAgICAgICAgICAgJ2NyZWF0ZWRBdCc6IHtcbiAgICAgICAgICAgICAgICAkZ3RlOiBjb252ZXJ0ZWRTdGFydERhdGUsXG4gICAgICAgICAgICAgICAgJGx0ZTogY29udmVydGVkRW5kRGF0ZVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgJyRjb3VudCc6ICdzeXN0ZW0nXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAnJHNldCc6IHtcbiAgICAgICAgICAgICdOdW1iZXIgT2YgU3lzdGVtcyc6ICckc3lzdGVtJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICckcHJvamVjdCc6IHtcbiAgICAgICAgICAgICdzeXN0ZW0nOiAwXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICBdKVxuXG4gICAgaWYgKHN0YXRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3RhdHVzOiAnc3VjY2VzcycsXG4gICAgICAgIHN0YXR1c0NvZGU6IDIwNCxcbiAgICAgICAgZXJyOiB7IG1lc3NhZ2U6ICdObyBkYXRhIGNhbiBiZSBmb3VuZCcgfVxuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHsgZGF0YTogc3RhdHMsIHN0YXR1czogJ3N1Y2Nlc3MnLCBzdGF0dXNDb2RlOiAyMDAgfTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgcmV0dXJuIHsgZXJyLCBzdGF0dXM6ICdlcnJvcicsIHN0YXR1c0NvZGU6IDQwMCB9O1xuICB9XG59O1xuXG4iXX0=