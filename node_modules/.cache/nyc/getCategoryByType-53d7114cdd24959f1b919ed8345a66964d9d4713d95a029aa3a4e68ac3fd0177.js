function cov_15u68nggdk(){var path="/home/azer/Desktop/jenkins/app/monitoringApp/services/client/getCategoryByType.js";var hash="1f2954a1fa61b4170d57d1f166c7b5fab88a8a45";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/azer/Desktop/jenkins/app/monitoringApp/services/client/getCategoryByType.js",statementMap:{"0":{start:{line:1,column:13},end:{line:1,column:41}},"1":{start:{line:2,column:15},end:{line:2,column:45}},"2":{start:{line:3,column:0},end:{line:61,column:2}},"3":{start:{line:4,column:2},end:{line:60,column:3}},"4":{start:{line:5,column:18},end:{line:5,column:52}},"5":{start:{line:6,column:25},end:{line:45,column:6}},"6":{start:{line:7,column:26},end:{line:9,column:59}},"7":{start:{line:10,column:28},end:{line:14,column:7}},"8":{start:{line:12,column:10},end:{line:12,column:46}},"9":{start:{line:15,column:26},end:{line:23,column:7}},"10":{start:{line:18,column:12},end:{line:18,column:33}},"11":{start:{line:21,column:12},end:{line:21,column:74}},"12":{start:{line:25,column:35},end:{line:33,column:8}},"13":{start:{line:26,column:37},end:{line:28,column:27}},"14":{start:{line:29,column:8},end:{line:32,column:10}},"15":{start:{line:34,column:44},end:{line:38,column:8}},"16":{start:{line:37,column:8},end:{line:37,column:19}},"17":{start:{line:39,column:42},end:{line:39,column:77}},"18":{start:{line:41,column:6},end:{line:44,column:8}},"19":{start:{line:46,column:18},end:{line:48,column:6}},"20":{start:{line:47,column:6},end:{line:47,column:17}},"21":{start:{line:49,column:17},end:{line:49,column:49}},"22":{start:{line:51,column:4},end:{line:54,column:6}},"23":{start:{line:56,column:4},end:{line:59,column:6}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:3,column:17},end:{line:3,column:18}},loc:{start:{line:3,column:29},end:{line:61,column:1}},line:3},"1":{name:"(anonymous_1)",decl:{start:{line:6,column:47},end:{line:6,column:48}},loc:{start:{line:6,column:63},end:{line:45,column:5}},line:6},"2":{name:"(anonymous_2)",decl:{start:{line:11,column:27},end:{line:11,column:28}},loc:{start:{line:11,column:37},end:{line:13,column:9}},line:11},"3":{name:"(anonymous_3)",decl:{start:{line:17,column:15},end:{line:17,column:16}},loc:{start:{line:17,column:25},end:{line:19,column:11}},line:17},"4":{name:"(anonymous_4)",decl:{start:{line:20,column:18},end:{line:20,column:19}},loc:{start:{line:20,column:35},end:{line:22,column:11}},line:20},"5":{name:"(anonymous_5)",decl:{start:{line:25,column:53},end:{line:25,column:54}},loc:{start:{line:25,column:73},end:{line:33,column:7}},line:25},"6":{name:"(anonymous_6)",decl:{start:{line:36,column:13},end:{line:36,column:14}},loc:{start:{line:36,column:22},end:{line:38,column:7}},line:36},"7":{name:"(anonymous_7)",decl:{start:{line:46,column:49},end:{line:46,column:50}},loc:{start:{line:46,column:58},end:{line:48,column:5}},line:46}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},b:{},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"1f2954a1fa61b4170d57d1f166c7b5fab88a8a45"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_15u68nggdk=function(){return actualCoverage;};}return actualCoverage;}cov_15u68nggdk();const Type=(cov_15u68nggdk().s[0]++,require("../../models/Type"));const System=(cov_15u68nggdk().s[1]++,require("../../models/System"));cov_15u68nggdk().s[2]++;module.exports=async()=>{cov_15u68nggdk().f[0]++;cov_15u68nggdk().s[3]++;try{const types=(cov_15u68nggdk().s[4]++,await Type.find({}).select("type"));const listCategory=(cov_15u68nggdk().s[5]++,types.slice(0,3).map(async type=>{cov_15u68nggdk().f[1]++;const systemItems=(cov_15u68nggdk().s[6]++,await System.find({type:type._id}).select("category").populate({path:"category",select:"category"}));let listCategorieId=(cov_15u68nggdk().s[7]++,[...systemItems.map(elem=>{cov_15u68nggdk().f[2]++;cov_15u68nggdk().s[8]++;return elem.category._id.toString();})]);let listCategorie=(cov_15u68nggdk().s[9]++,[...systemItems.map(elem=>{cov_15u68nggdk().f[3]++;cov_15u68nggdk().s[10]++;return elem.category;}).filter((category,i)=>{cov_15u68nggdk().f[4]++;cov_15u68nggdk().s[11]++;return listCategorieId.indexOf(category._id.toString())===i;})]);//console.log(listCategorie);
let listSystemAndCategorie=(cov_15u68nggdk().s[12]++,listCategorie.map(async category=>{cov_15u68nggdk().f[5]++;const listSystemBycategory=(cov_15u68nggdk().s[13]++,await System.find({category:category}).select("system"));cov_15u68nggdk().s[14]++;return{category:category,listSystem:listSystemBycategory};}));const listSystemAndCategoriePromise=(cov_15u68nggdk().s[15]++,Promise.all(listSystemAndCategorie).then(res=>{cov_15u68nggdk().f[6]++;cov_15u68nggdk().s[16]++;return res;}));const listSystemAndCategorieValue=(cov_15u68nggdk().s[17]++,await listSystemAndCategoriePromise);cov_15u68nggdk().s[18]++;return{type:type,listCategory:[...listSystemAndCategorieValue]};}));const value=(cov_15u68nggdk().s[19]++,Promise.all(listCategory).then(res=>{cov_15u68nggdk().f[7]++;cov_15u68nggdk().s[20]++;return res;}));var merged=(cov_15u68nggdk().s[21]++,[].concat.apply([],await value));cov_15u68nggdk().s[22]++;return{data:merged,status:"success"};}catch(err){cov_15u68nggdk().s[23]++;return{err,status:"error"};}};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdldENhdGVnb3J5QnlUeXBlLmpzIl0sIm5hbWVzIjpbIlR5cGUiLCJyZXF1aXJlIiwiU3lzdGVtIiwibW9kdWxlIiwiZXhwb3J0cyIsInR5cGVzIiwiZmluZCIsInNlbGVjdCIsImxpc3RDYXRlZ29yeSIsInNsaWNlIiwibWFwIiwidHlwZSIsInN5c3RlbUl0ZW1zIiwiX2lkIiwicG9wdWxhdGUiLCJwYXRoIiwibGlzdENhdGVnb3JpZUlkIiwiZWxlbSIsImNhdGVnb3J5IiwidG9TdHJpbmciLCJsaXN0Q2F0ZWdvcmllIiwiZmlsdGVyIiwiaSIsImluZGV4T2YiLCJsaXN0U3lzdGVtQW5kQ2F0ZWdvcmllIiwibGlzdFN5c3RlbUJ5Y2F0ZWdvcnkiLCJsaXN0U3lzdGVtIiwibGlzdFN5c3RlbUFuZENhdGVnb3JpZVByb21pc2UiLCJQcm9taXNlIiwiYWxsIiwidGhlbiIsInJlcyIsImxpc3RTeXN0ZW1BbmRDYXRlZ29yaWVWYWx1ZSIsInZhbHVlIiwibWVyZ2VkIiwiY29uY2F0IiwiYXBwbHkiLCJkYXRhIiwic3RhdHVzIiwiZXJyIl0sIm1hcHBpbmdzIjoiOHhHQWVZOzJGQWZaLEtBQU1BLENBQUFBLElBQUksMEJBQUdDLE9BQU8sQ0FBQyxtQkFBRCxDQUFWLENBQVYsQ0FDQSxLQUFNQyxDQUFBQSxNQUFNLDBCQUFHRCxPQUFPLENBQUMscUJBQUQsQ0FBVixDQUFaLEMsd0JBQ0FFLE1BQU0sQ0FBQ0MsT0FBUCxDQUFpQixTQUFZLGlEQUMzQixHQUFJLENBQ0YsS0FBTUMsQ0FBQUEsS0FBSywwQkFBRyxLQUFNTCxDQUFBQSxJQUFJLENBQUNNLElBQUwsQ0FBVSxFQUFWLEVBQWNDLE1BQWQsQ0FBcUIsTUFBckIsQ0FBVCxDQUFYLENBQ0EsS0FBTUMsQ0FBQUEsWUFBWSwwQkFBR0gsS0FBSyxDQUFDSSxLQUFOLENBQVksQ0FBWixDQUFlLENBQWYsRUFBa0JDLEdBQWxCLENBQXNCLEtBQU9DLENBQUFBLElBQVAsRUFBZ0IseUJBQ3pELEtBQU1DLENBQUFBLFdBQVcsMEJBQUcsS0FBTVYsQ0FBQUEsTUFBTSxDQUFDSSxJQUFQLENBQVksQ0FBRUssSUFBSSxDQUFFQSxJQUFJLENBQUNFLEdBQWIsQ0FBWixFQUN2Qk4sTUFEdUIsQ0FDaEIsVUFEZ0IsRUFFdkJPLFFBRnVCLENBRWQsQ0FBRUMsSUFBSSxDQUFFLFVBQVIsQ0FBb0JSLE1BQU0sQ0FBRSxVQUE1QixDQUZjLENBQVQsQ0FBakIsQ0FHQSxHQUFJUyxDQUFBQSxlQUFlLDBCQUFHLENBQ3BCLEdBQUdKLFdBQVcsQ0FBQ0YsR0FBWixDQUFpQk8sSUFBRCxFQUFVLGlEQUMzQixNQUFPQSxDQUFBQSxJQUFJLENBQUNDLFFBQUwsQ0FBY0wsR0FBZCxDQUFrQk0sUUFBbEIsRUFBUCxDQUNELENBRkUsQ0FEaUIsQ0FBSCxDQUFuQixDQUtBLEdBQUlDLENBQUFBLGFBQWEsMEJBQUcsQ0FDbEIsR0FBR1IsV0FBVyxDQUNYRixHQURBLENBQ0tPLElBQUQsRUFBVSxrREFDYixNQUFPQSxDQUFBQSxJQUFJLENBQUNDLFFBQVosQ0FDRCxDQUhBLEVBSUFHLE1BSkEsQ0FJTyxDQUFDSCxRQUFELENBQVdJLENBQVgsR0FBaUIsa0RBQ3ZCLE1BQU9OLENBQUFBLGVBQWUsQ0FBQ08sT0FBaEIsQ0FBd0JMLFFBQVEsQ0FBQ0wsR0FBVCxDQUFhTSxRQUFiLEVBQXhCLElBQXFERyxDQUE1RCxDQUNELENBTkEsQ0FEZSxDQUFILENBQWpCLENBU0E7QUFDQSxHQUFJRSxDQUFBQSxzQkFBc0IsMkJBQUdKLGFBQWEsQ0FBQ1YsR0FBZCxDQUFrQixLQUFPUSxDQUFBQSxRQUFQLEVBQW9CLHlCQUNqRSxLQUFNTyxDQUFBQSxvQkFBb0IsMkJBQUcsS0FBTXZCLENBQUFBLE1BQU0sQ0FBQ0ksSUFBUCxDQUFZLENBQzdDWSxRQUFRLENBQUVBLFFBRG1DLENBQVosRUFFaENYLE1BRmdDLENBRXpCLFFBRnlCLENBQVQsQ0FBMUIsQ0FEaUUseUJBSWpFLE1BQU8sQ0FDTFcsUUFBUSxDQUFFQSxRQURMLENBRUxRLFVBQVUsQ0FBRUQsb0JBRlAsQ0FBUCxDQUlELENBUjRCLENBQUgsQ0FBMUIsQ0FTQSxLQUFNRSxDQUFBQSw2QkFBNkIsMkJBQUdDLE9BQU8sQ0FBQ0MsR0FBUixDQUNwQ0wsc0JBRG9DLEVBRXBDTSxJQUZvQyxDQUU5QkMsR0FBRCxFQUFTLGtEQUNkLE1BQU9BLENBQUFBLEdBQVAsQ0FDRCxDQUpxQyxDQUFILENBQW5DLENBS0EsS0FBTUMsQ0FBQUEsMkJBQTJCLDJCQUFHLEtBQU1MLENBQUFBLDZCQUFULENBQWpDLENBakN5RCx5QkFtQ3pELE1BQU8sQ0FDTGhCLElBQUksQ0FBRUEsSUFERCxDQUVMSCxZQUFZLENBQUUsQ0FBQyxHQUFHd0IsMkJBQUosQ0FGVCxDQUFQLENBSUQsQ0F2Q29CLENBQUgsQ0FBbEIsQ0F3Q0EsS0FBTUMsQ0FBQUEsS0FBSywyQkFBR0wsT0FBTyxDQUFDQyxHQUFSLENBQVlyQixZQUFaLEVBQTBCc0IsSUFBMUIsQ0FBZ0NDLEdBQUQsRUFBUyxrREFDcEQsTUFBT0EsQ0FBQUEsR0FBUCxDQUNELENBRmEsQ0FBSCxDQUFYLENBR0EsR0FBSUcsQ0FBQUEsTUFBTSwyQkFBRyxHQUFHQyxNQUFILENBQVVDLEtBQVYsQ0FBZ0IsRUFBaEIsQ0FBb0IsS0FBTUgsQ0FBQUEsS0FBMUIsQ0FBSCxDQUFWLENBN0NFLHlCQStDRixNQUFPLENBQ0xJLElBQUksQ0FBRUgsTUFERCxDQUVMSSxNQUFNLENBQUUsU0FGSCxDQUFQLENBSUQsQ0FBQyxNQUFPQyxHQUFQLENBQVksMEJBQ1osTUFBTyxDQUNMQSxHQURLLENBRUxELE1BQU0sQ0FBRSxPQUZILENBQVAsQ0FJRCxDQUNGLENBMUREIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgVHlwZSA9IHJlcXVpcmUoXCIuLi8uLi9tb2RlbHMvVHlwZVwiKTtcbmNvbnN0IFN5c3RlbSA9IHJlcXVpcmUoXCIuLi8uLi9tb2RlbHMvU3lzdGVtXCIpO1xubW9kdWxlLmV4cG9ydHMgPSBhc3luYyAoKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgdHlwZXMgPSBhd2FpdCBUeXBlLmZpbmQoe30pLnNlbGVjdChcInR5cGVcIik7XG4gICAgY29uc3QgbGlzdENhdGVnb3J5ID0gdHlwZXMuc2xpY2UoMCwgMykubWFwKGFzeW5jICh0eXBlKSA9PiB7XG4gICAgICBjb25zdCBzeXN0ZW1JdGVtcyA9IGF3YWl0IFN5c3RlbS5maW5kKHsgdHlwZTogdHlwZS5faWQgfSlcbiAgICAgICAgLnNlbGVjdChcImNhdGVnb3J5XCIpXG4gICAgICAgIC5wb3B1bGF0ZSh7IHBhdGg6IFwiY2F0ZWdvcnlcIiwgc2VsZWN0OiBcImNhdGVnb3J5XCIgfSk7XG4gICAgICBsZXQgbGlzdENhdGVnb3JpZUlkID0gW1xuICAgICAgICAuLi5zeXN0ZW1JdGVtcy5tYXAoKGVsZW0pID0+IHtcbiAgICAgICAgICByZXR1cm4gZWxlbS5jYXRlZ29yeS5faWQudG9TdHJpbmcoKTtcbiAgICAgICAgfSksXG4gICAgICBdO1xuICAgICAgbGV0IGxpc3RDYXRlZ29yaWUgPSBbXG4gICAgICAgIC4uLnN5c3RlbUl0ZW1zXG4gICAgICAgICAgLm1hcCgoZWxlbSkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGVsZW0uY2F0ZWdvcnk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuZmlsdGVyKChjYXRlZ29yeSwgaSkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGxpc3RDYXRlZ29yaWVJZC5pbmRleE9mKGNhdGVnb3J5Ll9pZC50b1N0cmluZygpKSA9PT0gaTtcbiAgICAgICAgICB9KSxcbiAgICAgIF07XG4gICAgICAvL2NvbnNvbGUubG9nKGxpc3RDYXRlZ29yaWUpO1xuICAgICAgbGV0IGxpc3RTeXN0ZW1BbmRDYXRlZ29yaWUgPSBsaXN0Q2F0ZWdvcmllLm1hcChhc3luYyAoY2F0ZWdvcnkpID0+IHtcbiAgICAgICAgY29uc3QgbGlzdFN5c3RlbUJ5Y2F0ZWdvcnkgPSBhd2FpdCBTeXN0ZW0uZmluZCh7XG4gICAgICAgICAgY2F0ZWdvcnk6IGNhdGVnb3J5LFxuICAgICAgICB9KS5zZWxlY3QoXCJzeXN0ZW1cIik7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgY2F0ZWdvcnk6IGNhdGVnb3J5LFxuICAgICAgICAgIGxpc3RTeXN0ZW06IGxpc3RTeXN0ZW1CeWNhdGVnb3J5LFxuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgICBjb25zdCBsaXN0U3lzdGVtQW5kQ2F0ZWdvcmllUHJvbWlzZSA9IFByb21pc2UuYWxsKFxuICAgICAgICBsaXN0U3lzdGVtQW5kQ2F0ZWdvcmllXG4gICAgICApLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgfSk7XG4gICAgICBjb25zdCBsaXN0U3lzdGVtQW5kQ2F0ZWdvcmllVmFsdWUgPSBhd2FpdCBsaXN0U3lzdGVtQW5kQ2F0ZWdvcmllUHJvbWlzZTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgbGlzdENhdGVnb3J5OiBbLi4ubGlzdFN5c3RlbUFuZENhdGVnb3JpZVZhbHVlXSxcbiAgICAgIH07XG4gICAgfSk7XG4gICAgY29uc3QgdmFsdWUgPSBQcm9taXNlLmFsbChsaXN0Q2F0ZWdvcnkpLnRoZW4oKHJlcykgPT4ge1xuICAgICAgcmV0dXJuIHJlcztcbiAgICB9KTtcbiAgICB2YXIgbWVyZ2VkID0gW10uY29uY2F0LmFwcGx5KFtdLCBhd2FpdCB2YWx1ZSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgZGF0YTogbWVyZ2VkLFxuICAgICAgc3RhdHVzOiBcInN1Y2Nlc3NcIixcbiAgICB9O1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICByZXR1cm4ge1xuICAgICAgZXJyLFxuICAgICAgc3RhdHVzOiBcImVycm9yXCIsXG4gICAgfTtcbiAgfVxufTtcbiJdfQ==