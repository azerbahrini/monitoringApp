function cov_29fsv6q3hg(){var path="/home/azer/Desktop/jenkins/app/monitoringApp/config/db.js";var hash="865374f4db72e6a310b80a0fd617bb613283352c";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/azer/Desktop/jenkins/app/monitoringApp/config/db.js",statementMap:{"0":{start:{line:1,column:17},end:{line:1,column:36}},"1":{start:{line:2,column:22},end:{line:2,column:50}},"2":{start:{line:3,column:15},end:{line:3,column:34}},"3":{start:{line:5,column:0},end:{line:5,column:27}},"4":{start:{line:7,column:11},end:{line:7,column:76}},"5":{start:{line:8,column:0},end:{line:8,column:33}},"6":{start:{line:9,column:18},end:{line:35,column:1}},"7":{start:{line:10,column:2},end:{line:34,column:3}},"8":{start:{line:11,column:14},end:{line:16,column:6}},"9":{start:{line:17,column:4},end:{line:17,column:36}},"10":{start:{line:18,column:13},end:{line:18,column:32}},"11":{start:{line:19,column:4},end:{line:19,column:77}},"12":{start:{line:20,column:4},end:{line:30,column:5}},"13":{start:{line:21,column:6},end:{line:27,column:9}},"14":{start:{line:22,column:8},end:{line:26,column:11}},"15":{start:{line:23,column:10},end:{line:25,column:11}},"16":{start:{line:24,column:12},end:{line:24,column:73}},"17":{start:{line:32,column:4},end:{line:32,column:31}},"18":{start:{line:33,column:4},end:{line:33,column:20}},"19":{start:{line:36,column:0},end:{line:36,column:27}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:9,column:18},end:{line:9,column:19}},loc:{start:{line:9,column:30},end:{line:35,column:1}},line:9},"1":{name:"(anonymous_1)",decl:{start:{line:21,column:45},end:{line:21,column:46}},loc:{start:{line:21,column:71},end:{line:27,column:7}},line:21},"2":{name:"(anonymous_2)",decl:{start:{line:22,column:44},end:{line:22,column:45}},loc:{start:{line:22,column:71},end:{line:26,column:9}},line:22}},branchMap:{"0":{loc:{start:{line:7,column:11},end:{line:7,column:76}},type:"cond-expr",locations:[{start:{line:7,column:34},end:{line:7,column:56}},{start:{line:7,column:59},end:{line:7,column:76}}],line:7},"1":{loc:{start:{line:20,column:4},end:{line:30,column:5}},type:"if",locations:[{start:{line:20,column:4},end:{line:30,column:5}},{start:{line:20,column:4},end:{line:30,column:5}}],line:20},"2":{loc:{start:{line:23,column:10},end:{line:25,column:11}},type:"if",locations:[{start:{line:23,column:10},end:{line:25,column:11}},{start:{line:23,column:10},end:{line:25,column:11}}],line:23}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"865374f4db72e6a310b80a0fd617bb613283352c"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_29fsv6q3hg=function(){return actualCoverage;};}return actualCoverage;}cov_29fsv6q3hg();const mongoose=(cov_29fsv6q3hg().s[0]++,require("mongoose"));let listCollections=(cov_29fsv6q3hg().s[1]++,require("./listCollections"));const logger=(cov_29fsv6q3hg().s[2]++,require('./logger'));cov_29fsv6q3hg().s[3]++;require("dotenv").config();let test=(cov_29fsv6q3hg().s[4]++,process.env.NODE_ENV?(cov_29fsv6q3hg().b[0][0]++,process.env.DBURI_TEST):(cov_29fsv6q3hg().b[0][1]++,process.env.DBURI));cov_29fsv6q3hg().s[5]++;logger.info("database URI",test);cov_29fsv6q3hg().s[6]++;const connectDB=async()=>{cov_29fsv6q3hg().f[0]++;cov_29fsv6q3hg().s[7]++;try{let res=(cov_29fsv6q3hg().s[8]++,await mongoose.connect(test,{useNewUrlParser:true,useUnifiedTopology:true,useCreateIndex:true,useFindAndModify:false}));cov_29fsv6q3hg().s[9]++;logger.info("mongodb conected");let db=(cov_29fsv6q3hg().s[10]++,mongoose.connection);cov_29fsv6q3hg().s[11]++;db.on("error",console.error.bind(console,"MongoDB connection error:"));cov_29fsv6q3hg().s[12]++;if(db){cov_29fsv6q3hg().b[1][0]++;cov_29fsv6q3hg().s[13]++;listCollections.collectionList.forEach(function(collectionName){cov_29fsv6q3hg().f[1]++;cov_29fsv6q3hg().s[14]++;db.createCollection(collectionName,function(err,collection){cov_29fsv6q3hg().f[2]++;cov_29fsv6q3hg().s[15]++;if(!err){cov_29fsv6q3hg().b[2][0]++;cov_29fsv6q3hg().s[16]++;logger.info(collection.collectionName,"Collection created");}else{cov_29fsv6q3hg().b[2][1]++;}});});// Create a sparse unique index for users on email
//await db.collection("users").createIndex({ email: 1 }, { sparse: true, unique: true });
}else{cov_29fsv6q3hg().b[1][1]++;}}catch(err){cov_29fsv6q3hg().s[17]++;console.error(err.message);cov_29fsv6q3hg().s[18]++;process.exit(1);}};cov_29fsv6q3hg().s[19]++;module.exports=connectDB;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRiLmpzIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwicmVxdWlyZSIsImxpc3RDb2xsZWN0aW9ucyIsImxvZ2dlciIsImNvbmZpZyIsInRlc3QiLCJwcm9jZXNzIiwiZW52IiwiTk9ERV9FTlYiLCJEQlVSSV9URVNUIiwiREJVUkkiLCJpbmZvIiwiY29ubmVjdERCIiwicmVzIiwiY29ubmVjdCIsInVzZU5ld1VybFBhcnNlciIsInVzZVVuaWZpZWRUb3BvbG9neSIsInVzZUNyZWF0ZUluZGV4IiwidXNlRmluZEFuZE1vZGlmeSIsImRiIiwiY29ubmVjdGlvbiIsIm9uIiwiY29uc29sZSIsImVycm9yIiwiYmluZCIsImNvbGxlY3Rpb25MaXN0IiwiZm9yRWFjaCIsImNvbGxlY3Rpb25OYW1lIiwiY3JlYXRlQ29sbGVjdGlvbiIsImVyciIsImNvbGxlY3Rpb24iLCJtZXNzYWdlIiwiZXhpdCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJzMUZBZVk7MkZBZlosS0FBTUEsQ0FBQUEsUUFBUSwwQkFBR0MsT0FBTyxDQUFDLFVBQUQsQ0FBVixDQUFkLENBQ0EsR0FBSUMsQ0FBQUEsZUFBZSwwQkFBR0QsT0FBTyxDQUFDLG1CQUFELENBQVYsQ0FBbkIsQ0FDQSxLQUFNRSxDQUFBQSxNQUFNLDBCQUFHRixPQUFPLENBQUMsVUFBRCxDQUFWLENBQVosQyx3QkFFQUEsT0FBTyxDQUFDLFFBQUQsQ0FBUCxDQUFrQkcsTUFBbEIsR0FFQSxHQUFJQyxDQUFBQSxJQUFJLDBCQUFHQyxPQUFPLENBQUNDLEdBQVIsQ0FBWUMsUUFBWiw2QkFBdUJGLE9BQU8sQ0FBQ0MsR0FBUixDQUFZRSxVQUFuQyw4QkFBZ0RILE9BQU8sQ0FBQ0MsR0FBUixDQUFZRyxLQUE1RCxDQUFILENBQVIsQyx3QkFDQVAsTUFBTSxDQUFDUSxJQUFQLENBQVksY0FBWixDQUEyQk4sSUFBM0IsRSx3QkFDQSxLQUFNTyxDQUFBQSxTQUFTLENBQUcsU0FBWSxpREFDNUIsR0FBSSxDQUNGLEdBQUlDLENBQUFBLEdBQUcsMEJBQUcsS0FBTWIsQ0FBQUEsUUFBUSxDQUFDYyxPQUFULENBQWlCVCxJQUFqQixDQUF1QixDQUNyQ1UsZUFBZSxDQUFFLElBRG9CLENBRXJDQyxrQkFBa0IsQ0FBRSxJQUZpQixDQUdyQ0MsY0FBYyxDQUFFLElBSHFCLENBSXJDQyxnQkFBZ0IsQ0FBRSxLQUptQixDQUF2QixDQUFULENBQVAsQ0FERSx3QkFPRmYsTUFBTSxDQUFDUSxJQUFQLENBQVksa0JBQVosRUFDQSxHQUFJUSxDQUFBQSxFQUFFLDJCQUFHbkIsUUFBUSxDQUFDb0IsVUFBWixDQUFOLENBUkUseUJBU0ZELEVBQUUsQ0FBQ0UsRUFBSCxDQUFNLE9BQU4sQ0FBZUMsT0FBTyxDQUFDQyxLQUFSLENBQWNDLElBQWQsQ0FBbUJGLE9BQW5CLENBQTRCLDJCQUE1QixDQUFmLEVBVEUseUJBVUYsR0FBSUgsRUFBSixDQUFRLHFEQUNOakIsZUFBZSxDQUFDdUIsY0FBaEIsQ0FBK0JDLE9BQS9CLENBQXVDLFNBQVVDLGNBQVYsQ0FBMEIsa0RBQy9EUixFQUFFLENBQUNTLGdCQUFILENBQW9CRCxjQUFwQixDQUFvQyxTQUFVRSxHQUFWLENBQWVDLFVBQWYsQ0FBMkIsa0RBQzdELEdBQUksQ0FBQ0QsR0FBTCxDQUFVLHFEQUNSMUIsTUFBTSxDQUFDUSxJQUFQLENBQVltQixVQUFVLENBQUNILGNBQXZCLENBQXVDLG9CQUF2QyxFQUNELENBRkQsaUNBR0QsQ0FKRCxFQUtELENBTkQsRUFPQTtBQUNBO0FBQ0QsQ0FWRCxpQ0FXRCxDQUFDLE1BQU9FLEdBQVAsQ0FBWSwwQkFDWlAsT0FBTyxDQUFDQyxLQUFSLENBQWNNLEdBQUcsQ0FBQ0UsT0FBbEIsRUFEWSx5QkFFWnpCLE9BQU8sQ0FBQzBCLElBQVIsQ0FBYSxDQUFiLEVBQ0QsQ0FDRixDQTFCRCxDLHlCQTJCQUMsTUFBTSxDQUFDQyxPQUFQLENBQWlCdEIsU0FBakIiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoXCJtb25nb29zZVwiKTtcbmxldCBsaXN0Q29sbGVjdGlvbnMgPSByZXF1aXJlKFwiLi9saXN0Q29sbGVjdGlvbnNcIik7XG5jb25zdCBsb2dnZXIgPSByZXF1aXJlKCcuL2xvZ2dlcicpXG5cbnJlcXVpcmUoXCJkb3RlbnZcIikuY29uZmlnKCk7XG5cbmxldCB0ZXN0ID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPyBwcm9jZXNzLmVudi5EQlVSSV9URVNUIDogcHJvY2Vzcy5lbnYuREJVUkk7XG5sb2dnZXIuaW5mbyhcImRhdGFiYXNlIFVSSVwiLHRlc3QpO1xuY29uc3QgY29ubmVjdERCID0gYXN5bmMgKCkgPT4ge1xuICB0cnkge1xuICAgIGxldCByZXMgPSBhd2FpdCBtb25nb29zZS5jb25uZWN0KHRlc3QsIHtcbiAgICAgIHVzZU5ld1VybFBhcnNlcjogdHJ1ZSxcbiAgICAgIHVzZVVuaWZpZWRUb3BvbG9neTogdHJ1ZSxcbiAgICAgIHVzZUNyZWF0ZUluZGV4OiB0cnVlLFxuICAgICAgdXNlRmluZEFuZE1vZGlmeTogZmFsc2UsXG4gICAgfSk7XG4gICAgbG9nZ2VyLmluZm8oXCJtb25nb2RiIGNvbmVjdGVkXCIpO1xuICAgIGxldCBkYiA9IG1vbmdvb3NlLmNvbm5lY3Rpb247XG4gICAgZGIub24oXCJlcnJvclwiLCBjb25zb2xlLmVycm9yLmJpbmQoY29uc29sZSwgXCJNb25nb0RCIGNvbm5lY3Rpb24gZXJyb3I6XCIpKTtcbiAgICBpZiAoZGIpIHtcbiAgICAgIGxpc3RDb2xsZWN0aW9ucy5jb2xsZWN0aW9uTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChjb2xsZWN0aW9uTmFtZSkge1xuICAgICAgICBkYi5jcmVhdGVDb2xsZWN0aW9uKGNvbGxlY3Rpb25OYW1lLCBmdW5jdGlvbiAoZXJyLCBjb2xsZWN0aW9uKSB7XG4gICAgICAgICAgaWYgKCFlcnIpIHtcbiAgICAgICAgICAgIGxvZ2dlci5pbmZvKGNvbGxlY3Rpb24uY29sbGVjdGlvbk5hbWUsIFwiQ29sbGVjdGlvbiBjcmVhdGVkXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIC8vIENyZWF0ZSBhIHNwYXJzZSB1bmlxdWUgaW5kZXggZm9yIHVzZXJzIG9uIGVtYWlsXG4gICAgICAvL2F3YWl0IGRiLmNvbGxlY3Rpb24oXCJ1c2Vyc1wiKS5jcmVhdGVJbmRleCh7IGVtYWlsOiAxIH0sIHsgc3BhcnNlOiB0cnVlLCB1bmlxdWU6IHRydWUgfSk7XG4gICAgfVxuICB9IGNhdGNoIChlcnIpIHtcbiAgICBjb25zb2xlLmVycm9yKGVyci5tZXNzYWdlKTtcbiAgICBwcm9jZXNzLmV4aXQoMSk7XG4gIH1cbn07XG5tb2R1bGUuZXhwb3J0cyA9IGNvbm5lY3REQjtcbiJdfQ==