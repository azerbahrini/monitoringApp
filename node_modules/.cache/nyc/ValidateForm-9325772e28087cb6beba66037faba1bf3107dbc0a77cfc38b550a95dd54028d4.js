function cov_2lcfhk6fcj(){var path="/home/azer/Desktop/jenkins/app/monitoringApp/middleware/validators/resultForm/ValidateForm.js";var hash="cbdf158834d1c23cb3ac5b7d1568e0e732c22e1a";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/azer/Desktop/jenkins/app/monitoringApp/middleware/validators/resultForm/ValidateForm.js",statementMap:{"0":{start:{line:1,column:12},end:{line:1,column:26}},"1":{start:{line:2,column:32},end:{line:2,column:71}},"2":{start:{line:4,column:0},end:{line:77,column:1}},"3":{start:{line:6,column:2},end:{line:76,column:3}},"4":{start:{line:7,column:4},end:{line:14,column:5}},"5":{start:{line:8,column:20},end:{line:11,column:7}},"6":{start:{line:13,column:6},end:{line:13,column:40}},"7":{start:{line:15,column:23},end:{line:15,column:58}},"8":{start:{line:16,column:4},end:{line:21,column:5}},"9":{start:{line:17,column:6},end:{line:20,column:8}},"10":{start:{line:23,column:4},end:{line:26,column:6}},"11":{start:{line:28,column:4},end:{line:28,column:117}},"12":{start:{line:30,column:25},end:{line:30,column:27}},"13":{start:{line:31,column:4},end:{line:54,column:5}},"14":{start:{line:33,column:20},end:{line:33,column:79}},"15":{start:{line:34,column:23},end:{line:34,column:89}},"16":{start:{line:35,column:6},end:{line:45,column:7}},"17":{start:{line:37,column:10},end:{line:37,column:37}},"18":{start:{line:38,column:10},end:{line:38,column:16}},"19":{start:{line:40,column:10},end:{line:40,column:37}},"20":{start:{line:41,column:10},end:{line:41,column:16}},"21":{start:{line:43,column:10},end:{line:43,column:38}},"22":{start:{line:44,column:10},end:{line:44,column:16}},"23":{start:{line:46,column:6},end:{line:46,column:93}},"24":{start:{line:47,column:6},end:{line:51,column:8}},"25":{start:{line:49,column:10},end:{line:49,column:51}},"26":{start:{line:52,column:6},end:{line:52,column:89}},"27":{start:{line:53,column:6},end:{line:53,column:38}},"28":{start:{line:56,column:27},end:{line:59,column:47}},"29":{start:{line:61,column:4},end:{line:71,column:5}},"30":{start:{line:62,column:20},end:{line:68,column:7}},"31":{start:{line:66,column:29},end:{line:66,column:43}},"32":{start:{line:70,column:6},end:{line:70,column:40}},"33":{start:{line:72,column:4},end:{line:72,column:45}},"34":{start:{line:75,column:4},end:{line:75,column:38}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:4,column:17},end:{line:4,column:18}},loc:{start:{line:5,column:5},end:{line:77,column:1}},line:5},"1":{name:"(anonymous_1)",decl:{start:{line:48,column:27},end:{line:48,column:28}},loc:{start:{line:48,column:38},end:{line:50,column:9}},line:48},"2":{name:"(anonymous_2)",decl:{start:{line:66,column:17},end:{line:66,column:18}},loc:{start:{line:66,column:29},end:{line:66,column:43}},line:66}},branchMap:{"0":{loc:{start:{line:7,column:4},end:{line:14,column:5}},type:"if",locations:[{start:{line:7,column:4},end:{line:14,column:5}},{start:{line:7,column:4},end:{line:14,column:5}}],line:7},"1":{loc:{start:{line:7,column:8},end:{line:7,column:47}},type:"binary-expr",locations:[{start:{line:7,column:8},end:{line:7,column:27}},{start:{line:7,column:31},end:{line:7,column:47}}],line:7},"2":{loc:{start:{line:16,column:4},end:{line:21,column:5}},type:"if",locations:[{start:{line:16,column:4},end:{line:21,column:5}},{start:{line:16,column:4},end:{line:21,column:5}}],line:16},"3":{loc:{start:{line:23,column:61},end:{line:26,column:5}},type:"binary-expr",locations:[{start:{line:23,column:61},end:{line:23,column:115}},{start:{line:23,column:119},end:{line:26,column:5}}],line:23},"4":{loc:{start:{line:28,column:59},end:{line:28,column:117}},type:"binary-expr",locations:[{start:{line:28,column:59},end:{line:28,column:111}},{start:{line:28,column:115},end:{line:28,column:117}}],line:28},"5":{loc:{start:{line:35,column:6},end:{line:45,column:7}},type:"switch",locations:[{start:{line:36,column:8},end:{line:38,column:16}},{start:{line:39,column:8},end:{line:41,column:16}},{start:{line:42,column:8},end:{line:44,column:16}}],line:35},"6":{loc:{start:{line:46,column:6},end:{line:46,column:92}},type:"cond-expr",locations:[{start:{line:46,column:17},end:{line:46,column:53}},{start:{line:46,column:56},end:{line:46,column:92}}],line:46},"7":{loc:{start:{line:47,column:6},end:{line:51,column:7}},type:"binary-expr",locations:[{start:{line:47,column:6},end:{line:47,column:16}},{start:{line:48,column:8},end:{line:50,column:10}}],line:47},"8":{loc:{start:{line:52,column:6},end:{line:52,column:88}},type:"binary-expr",locations:[{start:{line:52,column:6},end:{line:52,column:19}},{start:{line:52,column:24},end:{line:52,column:87}}],line:52},"9":{loc:{start:{line:61,column:4},end:{line:71,column:5}},type:"if",locations:[{start:{line:61,column:4},end:{line:71,column:5}},{start:{line:61,column:4},end:{line:71,column:5}}],line:61}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"cbdf158834d1c23cb3ac5b7d1568e0e732c22e1a"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2lcfhk6fcj=function(){return actualCoverage;};}return actualCoverage;}cov_2lcfhk6fcj();const Joi=(cov_2lcfhk6fcj().s[0]++,require('joi'));const{getResultFormByTaskId}=(cov_2lcfhk6fcj().s[1]++,require('../../../services/resultForm'));cov_2lcfhk6fcj().s[2]++;module.exports=async(taskId,formObject)=>{cov_2lcfhk6fcj().f[0]++;cov_2lcfhk6fcj().s[3]++;try{cov_2lcfhk6fcj().s[4]++;if((cov_2lcfhk6fcj().b[1][0]++,!formObject.gStatus)||(cov_2lcfhk6fcj().b[1][1]++,!formObject.task)){cov_2lcfhk6fcj().b[0][0]++;const error=(cov_2lcfhk6fcj().s[5]++,{message:'form validation : gStatus | taskId undefined'});cov_2lcfhk6fcj().s[6]++;return{error,status:'error'};}else{cov_2lcfhk6fcj().b[0][1]++;}const resultForm=(cov_2lcfhk6fcj().s[7]++,await getResultFormByTaskId(taskId));cov_2lcfhk6fcj().s[8]++;if(resultForm.code!==200){cov_2lcfhk6fcj().b[2][0]++;cov_2lcfhk6fcj().s[9]++;return{error:resultForm.error,status:'success'};}else{cov_2lcfhk6fcj().b[2][1]++;}cov_2lcfhk6fcj().s[10]++;resultForm.data.resultFormConfig.formSchema.properties=(cov_2lcfhk6fcj().b[3][0]++,resultForm.data.resultFormConfig.formSchema.properties)??(cov_2lcfhk6fcj().b[3][1]++,{...resultForm.data.resultFormConfig.formSchema.oneOf[0].properties,...resultForm.data.resultFormConfig.formSchema.oneOf[1].properties});cov_2lcfhk6fcj().s[11]++;resultForm.data.resultFormConfig.formSchema.required=(cov_2lcfhk6fcj().b[4][0]++,resultForm.data.resultFormConfig.formSchema.required)??(cov_2lcfhk6fcj().b[4][1]++,[]);const globalSchema=(cov_2lcfhk6fcj().s[12]++,{});cov_2lcfhk6fcj().s[13]++;for(const key in resultForm.data.resultFormConfig.formSchema.properties){let childSchema;const field=(cov_2lcfhk6fcj().s[14]++,resultForm.data.resultFormConfig.formSchema.properties[key]);const required=(cov_2lcfhk6fcj().s[15]++,resultForm.data.resultFormConfig.formSchema.required.includes(key));cov_2lcfhk6fcj().s[16]++;switch(field.type){case'string':cov_2lcfhk6fcj().b[5][0]++;cov_2lcfhk6fcj().s[17]++;childSchema=Joi.string();cov_2lcfhk6fcj().s[18]++;break;case'number':cov_2lcfhk6fcj().b[5][1]++;cov_2lcfhk6fcj().s[19]++;childSchema=Joi.number();cov_2lcfhk6fcj().s[20]++;break;case'boolean':cov_2lcfhk6fcj().b[5][2]++;cov_2lcfhk6fcj().s[21]++;childSchema=Joi.boolean();cov_2lcfhk6fcj().s[22]++;break;}cov_2lcfhk6fcj().s[23]++;required?(cov_2lcfhk6fcj().b[6][0]++,childSchema=childSchema.required()):(cov_2lcfhk6fcj().b[6][1]++,childSchema=childSchema.optional());cov_2lcfhk6fcj().s[24]++;(cov_2lcfhk6fcj().b[7][0]++,field.enum)&&(cov_2lcfhk6fcj().b[7][1]++,field.enum.forEach(element=>{cov_2lcfhk6fcj().f[1]++;cov_2lcfhk6fcj().s[25]++;childSchema=childSchema.valid(element);}));cov_2lcfhk6fcj().s[26]++;(cov_2lcfhk6fcj().b[8][0]++,field.pattern)&&(cov_2lcfhk6fcj().b[8][1]++,childSchema=childSchema.regex(new RegExp(field.pattern,'i')));cov_2lcfhk6fcj().s[27]++;globalSchema[key]=childSchema;}const formValidation=(cov_2lcfhk6fcj().s[28]++,Joi.array().items(Joi.object({...globalSchema}).optional()).required().validate(JSON.parse(formObject.dataSet)));cov_2lcfhk6fcj().s[29]++;if(formValidation.error){cov_2lcfhk6fcj().b[9][0]++;const error=(cov_2lcfhk6fcj().s[30]++,{message:'form validation : '+formValidation.error.details.map(detail=>{cov_2lcfhk6fcj().f[2]++;cov_2lcfhk6fcj().s[31]++;return detail.message;}).join(' , ')});cov_2lcfhk6fcj().s[32]++;return{error,status:'error'};}else{cov_2lcfhk6fcj().b[9][1]++;}cov_2lcfhk6fcj().s[33]++;return{data:true,status:'success'};}catch(error){cov_2lcfhk6fcj().s[34]++;return{error,status:'error'};}};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlZhbGlkYXRlRm9ybS5qcyJdLCJuYW1lcyI6WyJKb2kiLCJyZXF1aXJlIiwiZ2V0UmVzdWx0Rm9ybUJ5VGFza0lkIiwibW9kdWxlIiwiZXhwb3J0cyIsInRhc2tJZCIsImZvcm1PYmplY3QiLCJnU3RhdHVzIiwidGFzayIsImVycm9yIiwibWVzc2FnZSIsInN0YXR1cyIsInJlc3VsdEZvcm0iLCJjb2RlIiwiZGF0YSIsInJlc3VsdEZvcm1Db25maWciLCJmb3JtU2NoZW1hIiwicHJvcGVydGllcyIsIm9uZU9mIiwicmVxdWlyZWQiLCJnbG9iYWxTY2hlbWEiLCJrZXkiLCJjaGlsZFNjaGVtYSIsImZpZWxkIiwiaW5jbHVkZXMiLCJ0eXBlIiwic3RyaW5nIiwibnVtYmVyIiwiYm9vbGVhbiIsIm9wdGlvbmFsIiwiZW51bSIsImZvckVhY2giLCJlbGVtZW50IiwidmFsaWQiLCJwYXR0ZXJuIiwicmVnZXgiLCJSZWdFeHAiLCJmb3JtVmFsaWRhdGlvbiIsImFycmF5IiwiaXRlbXMiLCJvYmplY3QiLCJ2YWxpZGF0ZSIsIkpTT04iLCJwYXJzZSIsImRhdGFTZXQiLCJkZXRhaWxzIiwibWFwIiwiZGV0YWlsIiwiam9pbiJdLCJtYXBwaW5ncyI6InEwS0FlWTsyRkFmWixLQUFNQSxDQUFBQSxHQUFHLDBCQUFHQyxPQUFPLENBQUMsS0FBRCxDQUFWLENBQVQsQ0FDQSxLQUFNLENBQUNDLHFCQUFELDJCQUEwQkQsT0FBTyxDQUFDLDhCQUFELENBQWpDLENBQU4sQyx3QkFFQUUsTUFBTSxDQUFDQyxPQUFQLENBQWlCLE1BQU9DLE1BQVAsQ0FBZUMsVUFBZixHQUNaLGlEQUNILEdBQUkseUJBQ0YsR0FBSSw2QkFBQ0EsVUFBVSxDQUFDQyxPQUFaLCtCQUF1QixDQUFDRCxVQUFVLENBQUNFLElBQW5DLENBQUosQ0FBOEMsNEJBQzVDLEtBQU1DLENBQUFBLEtBQUssMEJBQUcsQ0FDWkMsT0FBTyxDQUNMLDhDQUZVLENBQUgsQ0FBWCxDQUQ0Qyx3QkFNNUMsTUFBTyxDQUFF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RSx5QkFzQnhFZCxZQUFZLENBQUNDLEdBQUQsQ0FBWixDQUFvQkMsV0FBcEIsQ0FDRCxDQUVELEtBQU1lLENBQUFBLGNBQWMsMkJBQUdyQyxHQUFHLENBQUNzQyxLQUFKLEdBQVlDLEtBQVosQ0FDckJ2QyxHQUFHLENBQUN3QyxNQUFKLENBQVcsQ0FBRSxHQUFHcEIsWUFBTCxDQUFYLEVBQWdDUyxRQUFoQyxFQURxQixFQUVyQlYsUUFGcUIsR0FHcEJzQixRQUhvQixDQUdYQyxJQUFJLENBQUNDLEtBQUwsQ0FBV3JDLFVBQVUsQ0FBQ3NDLE9BQXRCLENBSFcsQ0FBSCxDQUFwQixDQWxERSx5QkF1REYsR0FBSVAsY0FBYyxDQUFDNUIsS0FBbkIsQ0FBMEIsNEJBQ3hCLEtBQU1BLENBQUFBLEtBQUssMkJBQUcsQ0FDWkMsT0FBTyxDQUNMLHFCQUNBMkIsY0FBYyxDQUFDNUIsS0FBZixDQUFxQm9DLE9BQXJCLENBQ0dDLEdBREgsQ0FDUUMsTUFBRCxFQUFZLHdEQUFBQSxDQUFBQSxNQUFNLENBQUNyQyxPQUFQLENBQWMsQ0FEakMsRUFFR3NDLElBRkgsQ0FFUSxLQUZSLENBSFUsQ0FBSCxDQUFYLENBRHdCLHlCQVN4QixNQUFPLENBQUV2QyxLQUFGLENBQVNFLE1BQU0sQ0FBRSxPQUFqQixDQUFQLENBQ0QsQ0FWRCxpQ0F2REUseUJBa0VGLE1BQU8sQ0FBRUcsSUFBSSxDQUFFLElBQVIsQ0FBY0gsTUFBTSxDQUFFLFNBQXRCLENBQVAsQ0FFRCxDQUFDLE1BQU9GLEtBQVAsQ0FBYywwQkFDZCxNQUFPLENBQUVBLEtBQUYsQ0FBU0UsTUFBTSxDQUFFLE9BQWpCLENBQVAsQ0FDRCxDQUNGLENBekVEIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgSm9pID0gcmVxdWlyZSgnam9pJyk7XG5jb25zdCB7Z2V0UmVzdWx0Rm9ybUJ5VGFza0lkfSA9IHJlcXVpcmUoJy4uLy4uLy4uL3NlcnZpY2VzL3Jlc3VsdEZvcm0nKVxuXG5tb2R1bGUuZXhwb3J0cyA9IGFzeW5jICh0YXNrSWQsIGZvcm1PYmplY3RcbikgPT4ge1xuICB0cnkge1xuICAgIGlmICghZm9ybU9iamVjdC5nU3RhdHVzIHx8ICFmb3JtT2JqZWN0LnRhc2sgKSB7XG4gICAgICBjb25zdCBlcnJvciA9IHtcbiAgICAgICAgbWVzc2FnZTpcbiAgICAgICAgICAnZm9ybSB2YWxpZGF0aW9uIDogZ1N0YXR1cyB8IHRhc2tJZCB1bmRlZmluZWQnXG4gICAgICB9O1xuXG4gICAgICByZXR1cm4geyBlcnJvciwgc3RhdHVzOiAnZXJyb3InIH07XG4gICAgfVxuICAgIGNvbnN0IHJlc3VsdEZvcm0gPSBhd2FpdCBnZXRSZXN1bHRGb3JtQnlUYXNrSWQodGFza0lkKTtcbiAgICBpZiAocmVzdWx0Rm9ybS5jb2RlICE9PSAyMDApIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGVycm9yOiByZXN1bHRGb3JtLmVycm9yLFxuICAgICAgICBzdGF0dXM6ICdzdWNjZXNzJ1xuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXN1bHRGb3JtLmRhdGEucmVzdWx0Rm9ybUNvbmZpZy5mb3JtU2NoZW1hLnByb3BlcnRpZXMgPSByZXN1bHRGb3JtLmRhdGEucmVzdWx0Rm9ybUNvbmZpZy5mb3JtU2NoZW1hLnByb3BlcnRpZXMgPz8ge1xuICAgICAgLi4ucmVzdWx0Rm9ybS5kYXRhLnJlc3VsdEZvcm1Db25maWcuZm9ybVNjaGVtYS5vbmVPZlswXS5wcm9wZXJ0aWVzLFxuICAgICAgLi4ucmVzdWx0Rm9ybS5kYXRhLnJlc3VsdEZvcm1Db25maWcuZm9ybVNjaGVtYS5vbmVPZlsxXS5wcm9wZXJ0aWVzXG4gICAgfTtcblxuICAgIHJlc3VsdEZvcm0uZGF0YS5yZXN1bHRGb3JtQ29uZmlnLmZvcm1TY2hlbWEucmVxdWlyZWQgPSByZXN1bHRGb3JtLmRhdGEucmVzdWx0Rm9ybUNvbmZpZy5mb3JtU2NoZW1hLnJlcXVpcmVkID8/IFtdXG5cbiAgICBjb25zdCBnbG9iYWxTY2hlbWEgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiByZXN1bHRGb3JtLmRhdGEucmVzdWx0Rm9ybUNvbmZpZy5mb3JtU2NoZW1hLnByb3BlcnRpZXMpIHtcbiAgICAgIGxldCBjaGlsZFNjaGVtYTtcbiAgICAgIGNvbnN0IGZpZWxkID0gcmVzdWx0Rm9ybS5kYXRhLnJlc3VsdEZvcm1Db25maWcuZm9ybVNjaGVtYS5wcm9wZXJ0aWVzW2tleV07XG4gICAgICBjb25zdCByZXF1aXJlZCA9IHJlc3VsdEZvcm0uZGF0YS5yZXN1bHRGb3JtQ29uZmlnLmZvcm1TY2hlbWEucmVxdWlyZWQuaW5jbHVkZXMoa2V5KTtcbiAgICAgIHN3aXRjaCAoZmllbGQudHlwZSkge1xuICAgICAgICBjYXNlICdzdHJpbmcnOlxuICAgICAgICAgIGNoaWxkU2NoZW1hID0gSm9pLnN0cmluZygpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdudW1iZXInOlxuICAgICAgICAgIGNoaWxkU2NoZW1hID0gSm9pLm51bWJlcigpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdib29sZWFuJzpcbiAgICAgICAgICBjaGlsZFNjaGVtYSA9IEpvaS5ib29sZWFuKCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZXF1aXJlZCA/IGNoaWxkU2NoZW1hID0gY2hpbGRTY2hlbWEucmVxdWlyZWQoKSA6IGNoaWxkU2NoZW1hID0gY2hpbGRTY2hlbWEub3B0aW9uYWwoKTtcbiAgICAgIGZpZWxkLmVudW0gJiYgKFxuICAgICAgICBmaWVsZC5lbnVtLmZvckVhY2goZWxlbWVudCA9PiB7XG4gICAgICAgICAgY2hpbGRTY2hlbWEgPSBjaGlsZFNjaGVtYS52YWxpZChlbGVtZW50KTtcbiAgICAgICAgfSlcbiAgICAgICk7XG4gICAgICBmaWVsZC5wYXR0ZXJuICYmIChjaGlsZFNjaGVtYSA9IGNoaWxkU2NoZW1hLnJlZ2V4KG5ldyBSZWdFeHAoZmllbGQucGF0dGVybiwgJ2knKSkpO1xuICAgICAgZ2xvYmFsU2NoZW1hW2tleV0gPSBjaGlsZFNjaGVtYTtcbiAgICB9XG5cbiAgICBjb25zdCBmb3JtVmFsaWRhdGlvbiA9IEpvaS5hcnJheSgpLml0ZW1zKFxuICAgICAgSm9pLm9iamVjdCh7IC4uLmdsb2JhbFNjaGVtYSB9KS5vcHRpb25hbCgpXG4gICAgKS5yZXF1aXJlZCgpXG4gICAgICAudmFsaWRhdGUoSlNPTi5wYXJzZShmb3JtT2JqZWN0LmRhdGFTZXQpKTtcblxuICAgIGlmIChmb3JtVmFsaWRhdGlvbi5lcnJvcikge1xuICAgICAgY29uc3QgZXJyb3IgPSB7XG4gICAgICAgIG1lc3NhZ2U6XG4gICAgICAgICAgJ2Zvcm0gdmFsaWRhdGlvbiA6ICcgK1xuICAgICAgICAgIGZvcm1WYWxpZGF0aW9uLmVycm9yLmRldGFpbHNcbiAgICAgICAgICAgIC5tYXAoKGRldGFpbCkgPT4gZGV0YWlsLm1lc3NhZ2UpXG4gICAgICAgICAgICAuam9pbignICwgJylcbiAgICAgIH07XG5cbiAgICAgIHJldHVybiB7IGVycm9yLCBzdGF0dXM6ICdlcnJvcicgfTtcbiAgICB9XG4gICAgcmV0dXJuIHsgZGF0YTogdHJ1ZSwgc3RhdHVzOiAnc3VjY2VzcycgfTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7IGVycm9yLCBzdGF0dXM6ICdlcnJvcicgfTtcbiAgfVxufSJdfQ==