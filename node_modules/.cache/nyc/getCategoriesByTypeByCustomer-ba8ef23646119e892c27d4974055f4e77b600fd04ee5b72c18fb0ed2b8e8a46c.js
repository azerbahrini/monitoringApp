function cov_2fte7ufl6g(){var path="/home/azer/Desktop/jenkins/app/monitoringApp/services/system/getCategoriesByTypeByCustomer.js";var hash="2ebf576638d78bb5eaae88616c4cebe761329313";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/azer/Desktop/jenkins/app/monitoringApp/services/system/getCategoriesByTypeByCustomer.js",statementMap:{"0":{start:{line:1,column:15},end:{line:1,column:45}},"1":{start:{line:2,column:15},end:{line:2,column:45}},"2":{start:{line:5,column:2},end:{line:5,column:69}},"3":{start:{line:5,column:39},end:{line:5,column:56}},"4":{start:{line:7,column:0},end:{line:48,column:2}},"5":{start:{line:8,column:2},end:{line:47,column:3}},"6":{start:{line:9,column:14},end:{line:9,column:16}},"7":{start:{line:10,column:24},end:{line:21,column:6}},"8":{start:{line:23,column:4},end:{line:29,column:5}},"9":{start:{line:24,column:6},end:{line:28,column:8}},"10":{start:{line:30,column:4},end:{line:37,column:5}},"11":{start:{line:30,column:17},end:{line:30,column:18}},"12":{start:{line:31,column:6},end:{line:36,column:7}},"13":{start:{line:32,column:8},end:{line:35,column:11}},"14":{start:{line:38,column:23},end:{line:38,column:50}},"15":{start:{line:40,column:4},end:{line:43,column:6}},"16":{start:{line:45,column:4},end:{line:45,column:75}},"17":{start:{line:46,column:4},end:{line:46,column:36}}},fnMap:{"0":{name:"getUniqueListBy",decl:{start:{line:4,column:9},end:{line:4,column:24}},loc:{start:{line:4,column:35},end:{line:6,column:1}},line:4},"1":{name:"(anonymous_1)",decl:{start:{line:5,column:29},end:{line:5,column:30}},loc:{start:{line:5,column:39},end:{line:5,column:56}},line:5},"2":{name:"(anonymous_2)",decl:{start:{line:7,column:17},end:{line:7,column:18}},loc:{start:{line:7,column:47},end:{line:48,column:1}},line:7}},branchMap:{"0":{loc:{start:{line:23,column:4},end:{line:29,column:5}},type:"if",locations:[{start:{line:23,column:4},end:{line:29,column:5}},{start:{line:23,column:4},end:{line:29,column:5}}],line:23},"1":{loc:{start:{line:31,column:6},end:{line:36,column:7}},type:"if",locations:[{start:{line:31,column:6},end:{line:36,column:7}},{start:{line:31,column:6},end:{line:36,column:7}}],line:31}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0],"1":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"2ebf576638d78bb5eaae88616c4cebe761329313"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2fte7ufl6g=function(){return actualCoverage;};}return actualCoverage;}cov_2fte7ufl6g();const System=(cov_2fte7ufl6g().s[0]++,require("../../models/System"));const logger=(cov_2fte7ufl6g().s[1]++,require("../../config/logger"));function getUniqueListBy(arr,key){cov_2fte7ufl6g().f[0]++;cov_2fte7ufl6g().s[2]++;return[...new Map(arr.map(item=>{cov_2fte7ufl6g().f[1]++;cov_2fte7ufl6g().s[3]++;return[item[key],item];})).values()];}cov_2fte7ufl6g().s[4]++;module.exports=async(customerId,typeId)=>{cov_2fte7ufl6g().f[2]++;cov_2fte7ufl6g().s[5]++;try{let tab=(cov_2fte7ufl6g().s[6]++,[]);const systemCateg=(cov_2fte7ufl6g().s[7]++,await System.find({customer:customerId,type:typeId,category:{$exists:true},isActive:true},{category:1,_id:0}).populate({path:"category",select:"category"}));cov_2fte7ufl6g().s[8]++;if(systemCateg.length===0){cov_2fte7ufl6g().b[0][0]++;cov_2fte7ufl6g().s[9]++;return{err:{message:"No  Category match this criteria !"},status:"error",statusCode:404};}else{cov_2fte7ufl6g().b[0][1]++;}cov_2fte7ufl6g().s[10]++;for(let i=(cov_2fte7ufl6g().s[11]++,0);i<systemCateg.length;i++){cov_2fte7ufl6g().s[12]++;if(systemCateg[i].category){cov_2fte7ufl6g().b[1][0]++;cov_2fte7ufl6g().s[13]++;tab.push({_id:systemCateg[i].category._id,category:systemCateg[i].category.category});}else{cov_2fte7ufl6g().b[1][1]++;}}const uniqueList=(cov_2fte7ufl6g().s[14]++,getUniqueListBy(tab,"_id"));cov_2fte7ufl6g().s[15]++;return{data:uniqueList,status:"success"};}catch(err){cov_2fte7ufl6g().s[16]++;logger.error("Get Categories by Customer ID and Type ID Error :",err);cov_2fte7ufl6g().s[17]++;return{err,status:"error"};}};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdldENhdGVnb3JpZXNCeVR5cGVCeUN1c3RvbWVyLmpzIl0sIm5hbWVzIjpbIlN5c3RlbSIsInJlcXVpcmUiLCJsb2dnZXIiLCJnZXRVbmlxdWVMaXN0QnkiLCJhcnIiLCJrZXkiLCJNYXAiLCJtYXAiLCJpdGVtIiwidmFsdWVzIiwibW9kdWxlIiwiZXhwb3J0cyIsImN1c3RvbWVySWQiLCJ0eXBlSWQiLCJ0YWIiLCJzeXN0ZW1DYXRlZyIsImZpbmQiLCJjdXN0b21lciIsInR5cGUiLCJjYXRlZ29yeSIsIiRleGlzdHMiLCJpc0FjdGl2ZSIsIl9pZCIsInBvcHVsYXRlIiwicGF0aCIsInNlbGVjdCIsImxlbmd0aCIsImVyciIsIm1lc3NhZ2UiLCJzdGF0dXMiLCJzdGF0dXNDb2RlIiwiaSIsInB1c2giLCJ1bmlxdWVMaXN0IiwiZGF0YSIsImVycm9yIl0sIm1hcHBpbmdzIjoiZ2tGQWVZOzJGQWZaLEtBQU1BLENBQUFBLE1BQU0sMEJBQUdDLE9BQU8sQ0FBQyxxQkFBRCxDQUFWLENBQVosQ0FDQSxLQUFNQyxDQUFBQSxNQUFNLDBCQUFHRCxPQUFPLENBQUMscUJBQUQsQ0FBVixDQUFaLENBRUEsUUFBU0UsQ0FBQUEsZUFBVCxDQUF5QkMsR0FBekIsQ0FBOEJDLEdBQTlCLENBQW1DLGlEQUNqQyxNQUFPLENBQUMsR0FBRyxHQUFJQyxDQUFBQSxHQUFKLENBQVFGLEdBQUcsQ0FBQ0csR0FBSixDQUFTQyxJQUFELEVBQVUsd0RBQUNBLElBQUksQ0FBQ0gsR0FBRCxDQUFMLENBQVlHLElBQVosRUFBaUIsQ0FBbkMsQ0FBUixFQUE4Q0MsTUFBOUMsRUFBSixDQUFQLENBQ0QsQyx3QkFDREMsTUFBTSxDQUFDQyxPQUFQLENBQWlCLE1BQU9DLFVBQVAsQ0FBbUJDLE1BQW5CLEdBQThCLGlEQUM3QyxHQUFJLENBQ0YsR0FBSUMsQ0FBQUEsR0FBRywwQkFBRyxFQUFILENBQVAsQ0FDQSxLQUFNQyxDQUFBQSxXQUFXLDBCQUFHLEtBQU1mLENBQUFBLE1BQU0sQ0FBQ2dCLElBQVAsQ0FDeEIsQ0FDRUMsUUFBUSxDQUFFTCxVQURaLENBRUVNLElBQUksQ0FBRUwsTUFGUixDQUdFTSxRQUFRLENBQUUsQ0FBRUMsT0FBTyxDQUFFLElBQVgsQ0FIWixDQUlFQyxRQUFRLENBQUMsSUFKWCxDQUR3QixDQU94QixDQUFFRixRQUFRLENBQUUsQ0FBWixDQUFlRyxHQUFHLENBQUUsQ0FBcEIsQ0FQd0IsRUFReEJDLFFBUndCLENBUWYsQ0FDVEMsSUFBSSxDQUFFLFVBREcsQ0FFVEMsTUFBTSxDQUFFLFVBRkMsQ0FSZSxDQUFULENBQWpCLENBRkUsd0JBZUYsR0FBSVYsV0FBVyxDQUFDVyxNQUFaLEdBQXVCLENBQTNCLENBQThCLG9EQUM1QixNQUFPLENBQ0xDLEdBQUcsQ0FBRSxDQUFFQyxPQUFPLENBQUUsb0NBQVgsQ0FEQSxDQUVMQyxNQUFNLENBQUUsT0FGSCxDQUdMQyxVQUFVLENBQUUsR0FIUCxDQUFQLENBS0QsQ0FORCxpQ0FmRSx5QkFzQkYsSUFBSyxHQUFJQyxDQUFBQSxDQUFDLDJCQUFHLENBQUgsQ0FBVixDQUFnQkEsQ0FBQyxDQUFHaEIsV0FBVyxDQUFDVyxNQUFoQyxDQUF3Q0ssQ0FBQyxFQUF6QyxDQUE2QywwQkFDM0MsR0FBSWhCLFdBQVcsQ0FBQ2dCLENBQUQsQ0FBWCxDQUFlWixRQUFuQixDQUE2QixxREFDM0JMLEdBQUcsQ0FBQ2tCLElBQUosQ0FBUyxDQUNQVixHQUFHLENBQUVQLFdBQVcsQ0FBQ2dCLENBQUQsQ0FBWCxDQUFlWixRQUFmLENBQXdCRyxHQUR0QixDQUVQSCxRQUFRLENBQUVKLFdBQVcsQ0FBQ2dCLENBQUQsQ0FBWCxDQUFlWixRQUFmLENBQXdCQSxRQUYzQixDQUFULEVBSUQsQ0FMRCxpQ0FNRCxDQUNELEtBQU1jLENBQUFBLFVBQVUsMkJBQUc5QixlQUFlLENBQUNXLEdBQUQsQ0FBTSxLQUFOLENBQWxCLENBQWhCLENBOUJFLHlCQWdDRixNQUFPLENBQ0xvQixJQUFJLENBQUVELFVBREQsQ0FFTEosTUFBTSxDQUFFLFNBRkgsQ0FBUCxDQUlELENBQUMsTUFBT0YsR0FBUCxDQUFZLDBCQUNaekIsTUFBTSxDQUFDaUMsS0FBUCxDQUFhLG1EQUFiLENBQWtFUixHQUFsRSxFQURZLHlCQUVaLE1BQU8sQ0FBRUEsR0FBRixDQUFPRSxNQUFNLENBQUUsT0FBZixDQUFQLENBQ0QsQ0FDRixDQXpDRCIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFN5c3RlbSA9IHJlcXVpcmUoXCIuLi8uLi9tb2RlbHMvU3lzdGVtXCIpO1xuY29uc3QgbG9nZ2VyID0gcmVxdWlyZShcIi4uLy4uL2NvbmZpZy9sb2dnZXJcIik7XG5cbmZ1bmN0aW9uIGdldFVuaXF1ZUxpc3RCeShhcnIsIGtleSkge1xuICByZXR1cm4gWy4uLm5ldyBNYXAoYXJyLm1hcCgoaXRlbSkgPT4gW2l0ZW1ba2V5XSwgaXRlbV0pKS52YWx1ZXMoKV07XG59XG5tb2R1bGUuZXhwb3J0cyA9IGFzeW5jIChjdXN0b21lcklkLCB0eXBlSWQpID0+IHtcbiAgdHJ5IHtcbiAgICBsZXQgdGFiID0gW107XG4gICAgY29uc3Qgc3lzdGVtQ2F0ZWcgPSBhd2FpdCBTeXN0ZW0uZmluZChcbiAgICAgIHtcbiAgICAgICAgY3VzdG9tZXI6IGN1c3RvbWVySWQsXG4gICAgICAgIHR5cGU6IHR5cGVJZCxcbiAgICAgICAgY2F0ZWdvcnk6IHsgJGV4aXN0czogdHJ1ZSB9LFxuICAgICAgICBpc0FjdGl2ZTp0cnVlXG4gICAgICB9LFxuICAgICAgeyBjYXRlZ29yeTogMSwgX2lkOiAwIH1cbiAgICApLnBvcHVsYXRlKHtcbiAgICAgIHBhdGg6IFwiY2F0ZWdvcnlcIixcbiAgICAgIHNlbGVjdDogXCJjYXRlZ29yeVwiLFxuICAgIH0pO1xuXG4gICAgaWYgKHN5c3RlbUNhdGVnLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZXJyOiB7IG1lc3NhZ2U6IFwiTm8gIENhdGVnb3J5IG1hdGNoIHRoaXMgY3JpdGVyaWEgIVwiIH0sXG4gICAgICAgIHN0YXR1czogXCJlcnJvclwiLFxuICAgICAgICBzdGF0dXNDb2RlOiA0MDQsXG4gICAgICB9O1xuICAgIH1cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN5c3RlbUNhdGVnLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoc3lzdGVtQ2F0ZWdbaV0uY2F0ZWdvcnkpIHtcbiAgICAgICAgdGFiLnB1c2goe1xuICAgICAgICAgIF9pZDogc3lzdGVtQ2F0ZWdbaV0uY2F0ZWdvcnkuX2lkLFxuICAgICAgICAgIGNhdGVnb3J5OiBzeXN0ZW1DYXRlZ1tpXS5jYXRlZ29yeS5jYXRlZ29yeSxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIGNvbnN0IHVuaXF1ZUxpc3QgPSBnZXRVbmlxdWVMaXN0QnkodGFiLCBcIl9pZFwiKTtcblxuICAgIHJldHVybiB7XG4gICAgICBkYXRhOiB1bmlxdWVMaXN0LFxuICAgICAgc3RhdHVzOiBcInN1Y2Nlc3NcIixcbiAgICB9O1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBsb2dnZXIuZXJyb3IoXCJHZXQgQ2F0ZWdvcmllcyBieSBDdXN0b21lciBJRCBhbmQgVHlwZSBJRCBFcnJvciA6XCIsIGVycik7XG4gICAgcmV0dXJuIHsgZXJyLCBzdGF0dXM6IFwiZXJyb3JcIiB9O1xuICB9XG59O1xuIl19