function cov_3w49kjxfh(){var path="/home/azer/Desktop/jenkins/app/monitoringApp/middleware/authorization.js";var hash="42dcca4e06f4ee9cbdf2c608ddff851005e7cd5a";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/azer/Desktop/jenkins/app/monitoringApp/middleware/authorization.js",statementMap:{"0":{start:{line:1,column:31},end:{line:1,column:88}},"1":{start:{line:3,column:0},end:{line:43,column:2}},"2":{start:{line:4,column:2},end:{line:42,column:3}},"3":{start:{line:5,column:4},end:{line:39,column:5}},"4":{start:{line:6,column:26},end:{line:6,column:63}},"5":{start:{line:7,column:6},end:{line:36,column:7}},"6":{start:{line:8,column:32},end:{line:8,column:34}},"7":{start:{line:9,column:39},end:{line:9,column:41}},"8":{start:{line:10,column:8},end:{line:23,column:10}},"9":{start:{line:11,column:10},end:{line:16,column:12}},"10":{start:{line:12,column:12},end:{line:15,column:14}},"11":{start:{line:17,column:10},end:{line:22,column:12}},"12":{start:{line:18,column:12},end:{line:21,column:14}},"13":{start:{line:24,column:8},end:{line:24,column:36}},"14":{start:{line:25,column:8},end:{line:25,column:43}},"15":{start:{line:26,column:8},end:{line:31,column:9}},"16":{start:{line:26,column:47},end:{line:26,column:124}},"17":{start:{line:27,column:10},end:{line:30,column:11}},"18":{start:{line:27,column:56},end:{line:27,column:133}},"19":{start:{line:28,column:12},end:{line:28,column:42}},"20":{start:{line:29,column:12},end:{line:29,column:70}},"21":{start:{line:32,column:8},end:{line:32,column:14}},"22":{start:{line:34,column:8},end:{line:34,column:38}},"23":{start:{line:35,column:8},end:{line:35,column:66}},"24":{start:{line:38,column:6},end:{line:38,column:63}},"25":{start:{line:41,column:4},end:{line:41,column:61}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:3,column:17},end:{line:3,column:18}},loc:{start:{line:3,column:43},end:{line:43,column:1}},line:3},"1":{name:"(anonymous_1)",decl:{start:{line:10,column:29},end:{line:10,column:30}},loc:{start:{line:10,column:37},end:{line:23,column:9}},line:10},"2":{name:"(anonymous_2)",decl:{start:{line:11,column:40},end:{line:11,column:41}},loc:{start:{line:12,column:12},end:{line:15,column:14}},line:12},"3":{name:"(anonymous_3)",decl:{start:{line:17,column:38},end:{line:17,column:39}},loc:{start:{line:18,column:12},end:{line:21,column:14}},line:18},"4":{name:"(anonymous_4)",decl:{start:{line:26,column:34},end:{line:26,column:35}},loc:{start:{line:26,column:47},end:{line:26,column:124}},line:26},"5":{name:"(anonymous_5)",decl:{start:{line:27,column:43},end:{line:27,column:44}},loc:{start:{line:27,column:56},end:{line:27,column:133}},line:27}},branchMap:{"0":{loc:{start:{line:5,column:4},end:{line:39,column:5}},type:"if",locations:[{start:{line:5,column:4},end:{line:39,column:5}},{start:{line:5,column:4},end:{line:39,column:5}}],line:5},"1":{loc:{start:{line:7,column:6},end:{line:36,column:7}},type:"if",locations:[{start:{line:7,column:6},end:{line:36,column:7}},{start:{line:7,column:6},end:{line:36,column:7}}],line:7},"2":{loc:{start:{line:26,column:8},end:{line:31,column:9}},type:"if",locations:[{start:{line:26,column:8},end:{line:31,column:9}},{start:{line:26,column:8},end:{line:31,column:9}}],line:26},"3":{loc:{start:{line:26,column:47},end:{line:26,column:124}},type:"binary-expr",locations:[{start:{line:26,column:47},end:{line:26,column:93}},{start:{line:26,column:97},end:{line:26,column:124}}],line:26},"4":{loc:{start:{line:27,column:10},end:{line:30,column:11}},type:"if",locations:[{start:{line:27,column:10},end:{line:30,column:11}},{start:{line:27,column:10},end:{line:30,column:11}}],line:27},"5":{loc:{start:{line:27,column:56},end:{line:27,column:133}},type:"binary-expr",locations:[{start:{line:27,column:56},end:{line:27,column:102}},{start:{line:27,column:106},end:{line:27,column:133}}],line:27}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"42dcca4e06f4ee9cbdf2c608ddff851005e7cd5a"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_3w49kjxfh=function(){return actualCoverage;};}return actualCoverage;}cov_3w49kjxfh();const{getRolesPermission}=(cov_3w49kjxfh().s[0]++,require('../services/authorization/getUserAuthorization'));cov_3w49kjxfh().s[1]++;module.exports=async(req,res,next)=>{cov_3w49kjxfh().f[0]++;cov_3w49kjxfh().s[2]++;try{cov_3w49kjxfh().s[3]++;if(req.user?.id){cov_3w49kjxfh().b[0][0]++;const permissions=(cov_3w49kjxfh().s[4]++,await getRolesPermission(req.user.id));cov_3w49kjxfh().s[5]++;if(permissions.data){cov_3w49kjxfh().b[1][0]++;const userPermissions=(cov_3w49kjxfh().s[6]++,[]);const userRelatedPermissions=(cov_3w49kjxfh().s[7]++,[]);cov_3w49kjxfh().s[8]++;permissions.data.map(item=>{cov_3w49kjxfh().f[1]++;cov_3w49kjxfh().s[9]++;item.populatedPermissions.map(x=>{cov_3w49kjxfh().f[2]++;cov_3w49kjxfh().s[10]++;return userPermissions.push({route:x.route,type:x.type});});cov_3w49kjxfh().s[11]++;item.relatedPermissions.map(x=>{cov_3w49kjxfh().f[3]++;cov_3w49kjxfh().s[12]++;return userRelatedPermissions.push({route:x.route,type:x.type});});});cov_3w49kjxfh().s[13]++;console.log(userPermissions);cov_3w49kjxfh().s[14]++;console.log(userRelatedPermissions);cov_3w49kjxfh().s[15]++;if(!userPermissions.some(element=>{cov_3w49kjxfh().f[4]++;cov_3w49kjxfh().s[16]++;return(cov_3w49kjxfh().b[3][0]++,element.route===req.baseUrl+req.route.path)&&(cov_3w49kjxfh().b[3][1]++,element.type===req.method);})){cov_3w49kjxfh().b[2][0]++;cov_3w49kjxfh().s[17]++;if(!userRelatedPermissions.some(element=>{cov_3w49kjxfh().f[5]++;cov_3w49kjxfh().s[18]++;return(cov_3w49kjxfh().b[5][0]++,element.route===req.baseUrl+req.route.path)&&(cov_3w49kjxfh().b[5][1]++,element.type===req.method);})){cov_3w49kjxfh().b[4][0]++;cov_3w49kjxfh().s[19]++;console.log('Access denied 1');cov_3w49kjxfh().s[20]++;return res.status(401).json({message:'Access denied'});}else{cov_3w49kjxfh().b[4][1]++;}}else{cov_3w49kjxfh().b[2][1]++;}cov_3w49kjxfh().s[21]++;next();}else{cov_3w49kjxfh().b[1][1]++;cov_3w49kjxfh().s[22]++;console.log('Access denied 2');cov_3w49kjxfh().s[23]++;return res.status(401).json({message:'Access denied'});}}else{cov_3w49kjxfh().b[0][1]++;cov_3w49kjxfh().s[24]++;return res.status(500).json({message:'Server Error'});}}catch(err){cov_3w49kjxfh().s[25]++;return res.status(500).json({message:'Server Error'});}};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGhvcml6YXRpb24uanMiXSwibmFtZXMiOlsiZ2V0Um9sZXNQZXJtaXNzaW9uIiwicmVxdWlyZSIsIm1vZHVsZSIsImV4cG9ydHMiLCJyZXEiLCJyZXMiLCJuZXh0IiwidXNlciIsImlkIiwicGVybWlzc2lvbnMiLCJkYXRhIiwidXNlclBlcm1pc3Npb25zIiwidXNlclJlbGF0ZWRQZXJtaXNzaW9ucyIsIm1hcCIsIml0ZW0iLCJwb3B1bGF0ZWRQZXJtaXNzaW9ucyIsIngiLCJwdXNoIiwicm91dGUiLCJ0eXBlIiwicmVsYXRlZFBlcm1pc3Npb25zIiwiY29uc29sZSIsImxvZyIsInNvbWUiLCJlbGVtZW50IiwiYmFzZVVybCIsInBhdGgiLCJtZXRob2QiLCJzdGF0dXMiLCJqc29uIiwibWVzc2FnZSIsImVyciJdLCJtYXBwaW5ncyI6Im16SUFlWTt5RkFmWixLQUFNLENBQUVBLGtCQUFGLDBCQUF5QkMsT0FBTyxDQUFDLGdEQUFELENBQWhDLENBQU4sQyx1QkFFQUMsTUFBTSxDQUFDQyxPQUFQLENBQWlCLE1BQU9DLEdBQVAsQ0FBWUMsR0FBWixDQUFpQkMsSUFBakIsR0FBMEIsK0NBQ3pDLEdBQUksd0JBQ0YsR0FBSUYsR0FBRyxDQUFDRyxJQUFKLEVBQVVDLEVBQWQsQ0FBa0IsMkJBQ2hCLEtBQU1DLENBQUFBLFdBQVcseUJBQUcsS0FBTVQsQ0FBQUEsa0JBQWtCLENBQUNJLEdBQUcsQ0FBQ0csSUFBSixDQUFTQyxFQUFWLENBQTNCLENBQWpCLENBRGdCLHVCQUVoQixHQUFJQyxXQUFXLENBQUNDLElBQWhCLENBQXNCLDJCQUNwQixLQUFNQyxDQUFBQSxlQUFlLHlCQUFHLEVBQUgsQ0FBckIsQ0FDQSxLQUFNQyxDQUFBQSxzQkFBc0IseUJBQUcsRUFBSCxDQUE1QixDQUZvQix1QkFHcEJILFdBQVcsQ0FBQ0MsSUFBWixDQUFpQkcsR0FBakIsQ0FBcUJDLElBQUksRUFBSSwrQ0FDM0JBLElBQUksQ0FBQ0Msb0JBQUwsQ0FBMEJGLEdBQTFCLENBQThCRyxDQUFDLEVBQzdCLHNEQUFBTCxDQUFBQSxlQUFlLENBQUNNLElBQWhCLENBQXFCLENBQ25CQyxLQUFLLENBQUVGLENBQUMsQ0FBQ0UsS0FEVSxDQUVuQkMsSUFBSSxDQUFFSCxDQUFDLENBQUNHLElBRlcsQ0FBckIsRUFHRSxDQUpKLEVBRDJCLHdCQU8zQkwsSUFBSSxDQUFDTSxrQkFBTCxDQUF3QlAsR0FBeEIsQ0FBNEJHLENBQUMsRUFDM0Isc0RBQUFKLENBQUFBLHNCQUFzQixDQUFDSyxJQUF2QixDQUE0QixDQUMxQkMsS0FBSyxDQUFFRixDQUFDLENBQUNFLEtBRGlCLENBRTFCQyxJQUFJLENBQUVILENBQUMsQ0FBQ0csSUFGa0IsQ0FBNUIsRUFHRSxDQUpKLEVBTUQsQ0FiRCxFQUhvQix3QkFpQnBCRSxPQUFPLENBQUNDLEdBQVIsQ0FBWVgsZUFBWixFQWpCb0Isd0JBa0JwQlUsT0FBTyxDQUFDQyxHQUFSLENBQVlWLHNCQUFaLEVBbEJvQix3QkFtQnBCLEdBQUksQ0FBQ0QsZUFBZSxDQUFDWSxJQUFoQixDQUFzQkMsT0FBRCxFQUFhLGlGQUFBQSxPQUFPLENBQUNOLEtBQVIsR0FBa0JkLEdBQUcsQ0FBQ3FCLE9BQUosQ0FBY3JCLEdBQUcsQ0FBQ2MsS0FBSixDQUFVUSxJQUExQyw4QkFBa0RGLE9BQU8sQ0FBQ0wsSUFBUixHQUFpQmYsR0FBRyxDQUFDdUIsTUFBdkUsRUFBNkUsQ0FBL0csQ0FBTCxDQUF1SCxtREFDckgsR0FBSSxDQUFDZixzQkFBc0IsQ0FBQ1csSUFBdkIsQ0FBNkJDLE9BQUQsRUFBYSxpRkFBQUEsT0FBTyxDQUFDTixLQUFSLEdBQWtCZCxHQUFHLENBQUNxQixPQUFKLENBQWNyQixHQUFHLENBQUNjLEtBQUosQ0FBVVEsSUFBMUMsOEJBQWtERixPQUFPLENBQUNMLElBQVIsR0FBaUJmLEdBQUcsQ0FBQ3VCLE1BQXZFLEVBQTZFLENBQXRILENBQUwsQ0FBOEgsbURBQzVITixPQUFPLENBQUNDLEdBQVIsQ0FBWSxpQkFBWixFQUQ0SCx3QkFFNUgsTUFBT2pCLENBQUFBLEdBQUcsQ0FBQ3VCLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQixDQUFFQyxPQUFPLENBQUUsZUFBWCxDQUFyQixDQUFQLENBQ0QsQ0FIRCxnQ0FJRCxDQUxELGdDQW5Cb0Isd0JBeUJwQnhCLElBQUksR0FDTCxDQTFCRCxJQTBCTyxtREFDTGUsT0FBTyxDQUFDQyxHQUFSLENBQVksaUJBQVosRUFESyx3QkFFTCxNQUFPakIsQ0FBQUEsR0FBRyxDQUFDdUIsTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCLENBQUVDLE9BQU8sQ0FBRSxlQUFYLENBQXJCLENBQVAsQ0FDRCxDQUNGLENBaENELElBZ0NPLG1EQUNMLE1BQU96QixDQUFBQSxHQUFHLENBQUN1QixNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUIsQ0FBRUMsT0FBTyxDQUFFLGNBQVgsQ0FBckIsQ0FBUCxDQUNELENBQ0YsQ0FBQyxNQUFPQyxHQUFQLENBQVkseUJBQ1osTUFBTzFCLENBQUFBLEdBQUcsQ0FBQ3VCLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQixDQUFFQyxPQUFPLENBQUUsY0FBWCxDQUFyQixDQUFQLENBQ0QsQ0FDRixDQXhDRCIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgZ2V0Um9sZXNQZXJtaXNzaW9uIH0gPSByZXF1aXJlKCcuLi9zZXJ2aWNlcy9hdXRob3JpemF0aW9uL2dldFVzZXJBdXRob3JpemF0aW9uJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIHRyeSB7XG4gICAgaWYgKHJlcS51c2VyPy5pZCkge1xuICAgICAgY29uc3QgcGVybWlzc2lvbnMgPSBhd2FpdCBnZXRSb2xlc1Blcm1pc3Npb24ocmVxLnVzZXIuaWQpXG4gICAgICBpZiAocGVybWlzc2lvbnMuZGF0YSkge1xuICAgICAgICBjb25zdCB1c2VyUGVybWlzc2lvbnMgPSBbXTtcbiAgICAgICAgY29uc3QgdXNlclJlbGF0ZWRQZXJtaXNzaW9ucyA9IFtdO1xuICAgICAgICBwZXJtaXNzaW9ucy5kYXRhLm1hcChpdGVtID0+IHtcbiAgICAgICAgICBpdGVtLnBvcHVsYXRlZFBlcm1pc3Npb25zLm1hcCh4ID0+IChcbiAgICAgICAgICAgIHVzZXJQZXJtaXNzaW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgcm91dGU6IHgucm91dGUsXG4gICAgICAgICAgICAgIHR5cGU6IHgudHlwZVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICApKVxuICAgICAgICAgIGl0ZW0ucmVsYXRlZFBlcm1pc3Npb25zLm1hcCh4ID0+IChcbiAgICAgICAgICAgIHVzZXJSZWxhdGVkUGVybWlzc2lvbnMucHVzaCh7XG4gICAgICAgICAgICAgIHJvdXRlOiB4LnJvdXRlLFxuICAgICAgICAgICAgICB0eXBlOiB4LnR5cGVcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgKSlcbiAgICAgICAgfSlcbiAgICAgICAgY29uc29sZS5sb2codXNlclBlcm1pc3Npb25zKVxuICAgICAgICBjb25zb2xlLmxvZyh1c2VyUmVsYXRlZFBlcm1pc3Npb25zKVxuICAgICAgICBpZiAoIXVzZXJQZXJtaXNzaW9ucy5zb21lKChlbGVtZW50KSA9PiBlbGVtZW50LnJvdXRlID09PSByZXEuYmFzZVVybCArIHJlcS5yb3V0ZS5wYXRoICYmIGVsZW1lbnQudHlwZSA9PT0gcmVxLm1ldGhvZCkpIHtcbiAgICAgICAgICBpZiAoIXVzZXJSZWxhdGVkUGVybWlzc2lvbnMuc29tZSgoZWxlbWVudCkgPT4gZWxlbWVudC5yb3V0ZSA9PT0gcmVxLmJhc2VVcmwgKyByZXEucm91dGUucGF0aCAmJiBlbGVtZW50LnR5cGUgPT09IHJlcS5tZXRob2QpKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnQWNjZXNzIGRlbmllZCAxJylcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IG1lc3NhZ2U6ICdBY2Nlc3MgZGVuaWVkJyB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbmV4dCgpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmxvZygnQWNjZXNzIGRlbmllZCAyJylcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgbWVzc2FnZTogJ0FjY2VzcyBkZW5pZWQnIH0pO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiAnU2VydmVyIEVycm9yJyB9KTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IG1lc3NhZ2U6ICdTZXJ2ZXIgRXJyb3InIH0pO1xuICB9XG59O1xuIl19