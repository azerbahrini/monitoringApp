function cov_1j4vtpburn(){var path="/home/azer/Desktop/jenkins/app/monitoringApp/services/statistics/listOfTasksByCriteria.js";var hash="3fe79afa742a875e3c535c2f5598ccc62e122715";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/azer/Desktop/jenkins/app/monitoringApp/services/statistics/listOfTasksByCriteria.js",statementMap:{"0":{start:{line:1,column:13},end:{line:1,column:41}},"1":{start:{line:2,column:17},end:{line:2,column:44}},"2":{start:{line:3,column:15},end:{line:3,column:41}},"3":{start:{line:4,column:14},end:{line:4,column:42}},"4":{start:{line:6,column:0},end:{line:70,column:2}},"5":{start:{line:9,column:2},end:{line:69,column:3}},"6":{start:{line:10,column:31},end:{line:10,column:97}},"7":{start:{line:11,column:29},end:{line:11,column:93}},"8":{start:{line:13,column:18},end:{line:54,column:6}},"9":{start:{line:55,column:4},end:{line:57,column:6}},"10":{start:{line:56,column:6},end:{line:56,column:79}},"11":{start:{line:59,column:4},end:{line:65,column:5}},"12":{start:{line:60,column:6},end:{line:64,column:8}},"13":{start:{line:66,column:4},end:{line:66,column:63}},"14":{start:{line:68,column:4},end:{line:68,column:53}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:6,column:17},end:{line:6,column:18}},loc:{start:{line:7,column:60},end:{line:70,column:1}},line:7},"1":{name:"(anonymous_1)",decl:{start:{line:55,column:15},end:{line:55,column:16}},loc:{start:{line:55,column:25},end:{line:57,column:5}},line:55}},branchMap:{"0":{loc:{start:{line:34,column:27},end:{line:34,column:89}},type:"cond-expr",locations:[{start:{line:34,column:49},end:{line:34,column:73}},{start:{line:34,column:76},end:{line:34,column:89}}],line:34},"1":{loc:{start:{line:35,column:25},end:{line:35,column:87}},type:"cond-expr",locations:[{start:{line:35,column:47},end:{line:35,column:71}},{start:{line:35,column:74},end:{line:35,column:87}}],line:35},"2":{loc:{start:{line:36,column:23},end:{line:36,column:80}},type:"cond-expr",locations:[{start:{line:36,column:42},end:{line:36,column:64}},{start:{line:36,column:67},end:{line:36,column:80}}],line:36},"3":{loc:{start:{line:37,column:29},end:{line:37,column:81}},type:"cond-expr",locations:[{start:{line:37,column:53},end:{line:37,column:65}},{start:{line:37,column:68},end:{line:37,column:81}}],line:37},"4":{loc:{start:{line:38,column:22},end:{line:38,column:59}},type:"cond-expr",locations:[{start:{line:38,column:38},end:{line:38,column:43}},{start:{line:38,column:46},end:{line:38,column:59}}],line:38},"5":{loc:{start:{line:39,column:32},end:{line:39,column:62}},type:"cond-expr",locations:[{start:{line:39,column:46},end:{line:39,column:57}},{start:{line:39,column:60},end:{line:39,column:62}}],line:39},"6":{loc:{start:{line:46,column:30},end:{line:46,column:84}},type:"cond-expr",locations:[{start:{line:46,column:42},end:{line:46,column:68}},{start:{line:46,column:71},end:{line:46,column:84}}],line:46},"7":{loc:{start:{line:49,column:30},end:{line:49,column:80}},type:"cond-expr",locations:[{start:{line:49,column:40},end:{line:49,column:64}},{start:{line:49,column:67},end:{line:49,column:80}}],line:49},"8":{loc:{start:{line:59,column:4},end:{line:65,column:5}},type:"if",locations:[{start:{line:59,column:4},end:{line:65,column:5}},{start:{line:59,column:4},end:{line:65,column:5}}],line:59}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"3fe79afa742a875e3c535c2f5598ccc62e122715"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1j4vtpburn=function(){return actualCoverage;};}return actualCoverage;}cov_1j4vtpburn();const Task=(cov_1j4vtpburn().s[0]++,require('../../models/Task'));const ObjectId=(cov_1j4vtpburn().s[1]++,require('mongodb').ObjectId);const moment=(cov_1j4vtpburn().s[2]++,require('moment-timezone'));const toUtc=(cov_1j4vtpburn().s[3]++,require('../../utils/toUTC'));cov_1j4vtpburn().s[4]++;module.exports=async(timeZone,customerId,globalStatus,state,startDate,endDate,assigneeId,systemID,searchValue)=>{cov_1j4vtpburn().f[0]++;cov_1j4vtpburn().s[5]++;try{const convertedStartDate=(cov_1j4vtpburn().s[6]++,new Date(toUtc(moment(startDate).tz(timeZone).format(),timeZone)));const convertedEndDate=(cov_1j4vtpburn().s[7]++,new Date(toUtc(moment(endDate).tz(timeZone).format(),timeZone)));const stats=(cov_1j4vtpburn().s[8]++,await Task.aggregate([{$lookup:{from:'systems',localField:'system',foreignField:'_id',as:'populatedSystem'}},{$set:{'customerId':{'$arrayElemAt':['$populatedSystem.customer',0]}}},{$project:{'populatedSystem':0}},{$match:{'customerId':customerId!==null?(cov_1j4vtpburn().b[0][0]++,new ObjectId(customerId)):(cov_1j4vtpburn().b[0][1]++,{$ne:null}),'assignee':assigneeId!==null?(cov_1j4vtpburn().b[1][0]++,new ObjectId(assigneeId)):(cov_1j4vtpburn().b[1][1]++,{$ne:null}),'system':systemID!==null?(cov_1j4vtpburn().b[2][0]++,new ObjectId(systemID)):(cov_1j4vtpburn().b[2][1]++,{$ne:null}),'globalStatus':globalStatus!==null?(cov_1j4vtpburn().b[3][0]++,globalStatus):(cov_1j4vtpburn().b[3][1]++,{$ne:null}),'state':state!==null?(cov_1j4vtpburn().b[4][0]++,state):(cov_1j4vtpburn().b[4][1]++,{$ne:null}),'title':{$regex:searchValue?(cov_1j4vtpburn().b[5][0]++,searchValue):(cov_1j4vtpburn().b[5][1]++,''),$options:'i'}}},{$match:{$and:[{estimatedStart:startDate?(cov_1j4vtpburn().b[6][0]++,{$gte:convertedStartDate}):(cov_1j4vtpburn().b[6][1]++,{$ne:null})},{estimatedStart:endDate?(cov_1j4vtpburn().b[7][0]++,{$lte:convertedEndDate}):(cov_1j4vtpburn().b[7][1]++,{$ne:null})}]}}]));cov_1j4vtpburn().s[9]++;stats?.map(task=>{cov_1j4vtpburn().f[1]++;cov_1j4vtpburn().s[10]++;task.estimatedStart=moment(task?.estimatedStart).tz(timeZone).format();});cov_1j4vtpburn().s[11]++;if(stats.length===0){cov_1j4vtpburn().b[8][0]++;cov_1j4vtpburn().s[12]++;return{status:'success',statusCode:204,err:{message:'No data can be found'}};}else{cov_1j4vtpburn().b[8][1]++;}cov_1j4vtpburn().s[13]++;return{data:stats,status:'success',statusCode:200};}catch(err){cov_1j4vtpburn().s[14]++;return{err,status:'error',statusCode:400};}};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpc3RPZlRhc2tzQnlDcml0ZXJpYS5qcyJdLCJuYW1lcyI6WyJUYXNrIiwicmVxdWlyZSIsIk9iamVjdElkIiwibW9tZW50IiwidG9VdGMiLCJtb2R1bGUiLCJleHBvcnRzIiwidGltZVpvbmUiLCJjdXN0b21lcklkIiwiZ2xvYmFsU3RhdHVzIiwic3RhdGUiLCJzdGFydERhdGUiLCJlbmREYXRlIiwiYXNzaWduZWVJZCIsInN5c3RlbUlEIiwic2VhcmNoVmFsdWUiLCJjb252ZXJ0ZWRTdGFydERhdGUiLCJEYXRlIiwidHoiLCJmb3JtYXQiLCJjb252ZXJ0ZWRFbmREYXRlIiwic3RhdHMiLCJhZ2dyZWdhdGUiLCIkbG9va3VwIiwiZnJvbSIsImxvY2FsRmllbGQiLCJmb3JlaWduRmllbGQiLCJhcyIsIiRzZXQiLCIkcHJvamVjdCIsIiRtYXRjaCIsIiRuZSIsIiRyZWdleCIsIiRvcHRpb25zIiwiJGFuZCIsImVzdGltYXRlZFN0YXJ0IiwiJGd0ZSIsIiRsdGUiLCJtYXAiLCJ0YXNrIiwibGVuZ3RoIiwic3RhdHVzIiwic3RhdHVzQ29kZSIsImVyciIsIm1lc3NhZ2UiLCJkYXRhIl0sIm1hcHBpbmdzIjoiOHNIQWVZOzJGQWZaLEtBQU1BLENBQUFBLElBQUksMEJBQUdDLE9BQU8sQ0FBQyxtQkFBRCxDQUFWLENBQVYsQ0FDQSxLQUFNQyxDQUFBQSxRQUFRLDBCQUFHRCxPQUFPLENBQUMsU0FBRCxDQUFQLENBQW1CQyxRQUF0QixDQUFkLENBQ0EsS0FBTUMsQ0FBQUEsTUFBTSwwQkFBR0YsT0FBTyxDQUFDLGlCQUFELENBQVYsQ0FBWixDQUNBLEtBQU1HLENBQUFBLEtBQUssMEJBQUdILE9BQU8sQ0FBQyxtQkFBRCxDQUFWLENBQVgsQyx3QkFFQUksTUFBTSxDQUFDQyxPQUFQLENBQWlCLE1BQU9DLFFBQVAsQ0FBaUJDLFVBQWpCLENBQTZCQyxZQUE3QixDQUEyQ0MsS0FBM0MsQ0FDZkMsU0FEZSxDQUNKQyxPQURJLENBQ0tDLFVBREwsQ0FDaUJDLFFBRGpC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QUFPLENBQ0xDLE1BQU0sQ0FBRSxTQURILENBRUxDLFVBQVUsQ0FBRSxHQUZQLENBR0xDLEdBQUcsQ0FBRSxDQUFFQyxPQUFPLENBQUUsc0JBQVgsQ0FIQSxDQUFQLENBS0QsQ0FORCxpQ0FsREUseUJBeURGLE1BQU8sQ0FBRUMsSUFBSSxDQUFFeEIsS0FBUixDQUFlb0IsTUFBTSxDQUFFLFNBQXZCLENBQWtDQyxVQUFVLENBQUUsR0FBOUMsQ0FBUCxDQUNELENBQUMsTUFBT0MsR0FBUCxDQUFZLDBCQUNaLE1BQU8sQ0FBRUEsR0FBRixDQUFPRixNQUFNLENBQUUsT0FBZixDQUF3QkMsVUFBVSxDQUFFLEdBQXBDLENBQVAsQ0FDRCxDQUNGLENBaEVEIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgVGFzayA9IHJlcXVpcmUoJy4uLy4uL21vZGVscy9UYXNrJyk7XG5jb25zdCBPYmplY3RJZCA9IHJlcXVpcmUoJ21vbmdvZGInKS5PYmplY3RJZDtcbmNvbnN0IG1vbWVudCA9IHJlcXVpcmUoJ21vbWVudC10aW1lem9uZScpXG5jb25zdCB0b1V0YyA9IHJlcXVpcmUoJy4uLy4uL3V0aWxzL3RvVVRDJylcblxubW9kdWxlLmV4cG9ydHMgPSBhc3luYyAodGltZVpvbmUsIGN1c3RvbWVySWQsIGdsb2JhbFN0YXR1cywgc3RhdGUsXG4gIHN0YXJ0RGF0ZSwgZW5kRGF0ZSwgYXNzaWduZWVJZCwgc3lzdGVtSUQsIHNlYXJjaFZhbHVlKSA9PiB7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBjb252ZXJ0ZWRTdGFydERhdGUgPSBuZXcgRGF0ZSh0b1V0Yyhtb21lbnQoc3RhcnREYXRlKS50eih0aW1lWm9uZSkuZm9ybWF0KCksIHRpbWVab25lKSk7XG4gICAgY29uc3QgY29udmVydGVkRW5kRGF0ZSA9IG5ldyBEYXRlKHRvVXRjKG1vbWVudChlbmREYXRlKS50eih0aW1lWm9uZSkuZm9ybWF0KCksIHRpbWVab25lKSk7XG5cbiAgICBjb25zdCBzdGF0cyA9IGF3YWl0IFRhc2suYWdncmVnYXRlKFtcbntcbiAgICAgICRsb29rdXA6IHtcbiAgICAgICAgICBmcm9tOiAnc3lzdGVtcycsXG4gICAgICAgICAgbG9jYWxGaWVsZDogJ3N5c3RlbScsXG4gICAgICAgICAgZm9yZWlnbkZpZWxkOiAnX2lkJyxcbiAgICAgICAgICBhczogJ3BvcHVsYXRlZFN5c3RlbSdcbiAgICAgIH1cbiAgfSwge1xuICAgICAgJHNldDoge1xuICAgICAgICAgICdjdXN0b21lcklkJzoge1xuICAgICAgICAgICAgICAnJGFycmF5RWxlbUF0JzogWyckcG9wdWxhdGVkU3lzdGVtLmN1c3RvbWVyJywgMF1cbiAgICAgICAgICB9XG4gICAgICB9XG4gIH0sIHtcbiAgICAgICRwcm9qZWN0OiB7XG4gICAgICAgICAgJ3BvcHVsYXRlZFN5c3RlbSc6IDBcbiAgICAgIH1cbiAgfSxcbiAgICAgIHtcbiAgICAgICAgJG1hdGNoOiB7XG4gICAgICAgICAgICAgJ2N1c3RvbWVySWQnOiBjdXN0b21lcklkICE9PSBudWxsID8gbmV3IE9iamVjdElkKGN1c3RvbWVySWQpIDogeyAkbmU6IG51bGwgfSxcbiAgICAgICAgICAgICAnYXNzaWduZWUnOiBhc3NpZ25lZUlkICE9PSBudWxsID8gbmV3IE9iamVjdElkKGFzc2lnbmVlSWQpIDogeyAkbmU6IG51bGwgfSxcbiAgICAgICAgICAgICAnc3lzdGVtJzogc3lzdGVtSUQhPT0gbnVsbCA/IG5ldyBPYmplY3RJZChzeXN0ZW1JRCkgOiB7ICRuZTogbnVsbCB9LFxuICAgICAgICAgICAgICdnbG9iYWxTdGF0dXMnOiBnbG9iYWxTdGF0dXMgIT09IG51bGwgPyBnbG9iYWxTdGF0dXMgOiB7ICRuZTogbnVsbCB9LFxuICAgICAgICAgICAgICdzdGF0ZSc6IHN0YXRlIT09IG51bGwgPyBzdGF0ZSA6IHsgJG5lOiBudWxsIH0sXG4gICAgICAgICAgICAgJ3RpdGxlJzogeyAkcmVnZXg6IHNlYXJjaFZhbHVlID8gc2VhcmNoVmFsdWUgOiAnJywgJG9wdGlvbnM6ICdpJyB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgICRtYXRjaDoge1xuICAgICAgICAgICRhbmQ6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgZXN0aW1hdGVkU3RhcnQ6IHN0YXJ0RGF0ZSA/IHskZ3RlOiBjb252ZXJ0ZWRTdGFydERhdGV9IDogeyAkbmU6IG51bGwgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgZXN0aW1hdGVkU3RhcnQ6IGVuZERhdGUgPyB7JGx0ZTogY29udmVydGVkRW5kRGF0ZX0gOiB7ICRuZTogbnVsbCB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgXVxuICAgICAgICB9XG4gICAgICB9XG4gICAgXSk7XG4gICAgc3RhdHM/Lm1hcCgodGFzaykgPT4ge1xuICAgICAgdGFzay5lc3RpbWF0ZWRTdGFydCA9IG1vbWVudCh0YXNrPy5lc3RpbWF0ZWRTdGFydCkudHoodGltZVpvbmUpLmZvcm1hdCgpO1xuICAgIH0pXG5cbiAgICBpZiAoc3RhdHMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdGF0dXM6ICdzdWNjZXNzJyxcbiAgICAgICAgc3RhdHVzQ29kZTogMjA0LFxuICAgICAgICBlcnI6IHsgbWVzc2FnZTogJ05vIGRhdGEgY2FuIGJlIGZvdW5kJyB9XG4gICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4geyBkYXRhOiBzdGF0cywgc3RhdHVzOiAnc3VjY2VzcycsIHN0YXR1c0NvZGU6IDIwMCB9O1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICByZXR1cm4geyBlcnIsIHN0YXR1czogJ2Vycm9yJywgc3RhdHVzQ29kZTogNDAwIH07XG4gIH1cbn07Il19