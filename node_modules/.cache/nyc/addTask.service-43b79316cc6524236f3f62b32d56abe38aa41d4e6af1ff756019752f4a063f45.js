function cov_2gqrqehgd1(){var path="/home/azer/Desktop/jenkins/app/monitoringApp/services/task/addTask.service.js";var hash="c0b5835967d297444390756e0812cac00a814bdf";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/azer/Desktop/jenkins/app/monitoringApp/services/task/addTask.service.js",statementMap:{"0":{start:{line:2,column:13},end:{line:2,column:41}},"1":{start:{line:3,column:14},end:{line:3,column:42}},"2":{start:{line:4,column:15},end:{line:4,column:32}},"3":{start:{line:6,column:0},end:{line:20,column:2}},"4":{start:{line:7,column:2},end:{line:19,column:3}},"5":{start:{line:8,column:30},end:{line:8,column:65}},"6":{start:{line:9,column:8},end:{line:13,column:7}},"7":{start:{line:10,column:10},end:{line:10,column:31}},"8":{start:{line:11,column:15},end:{line:13,column:7}},"9":{start:{line:12,column:10},end:{line:12,column:34}},"10":{start:{line:14,column:4},end:{line:14,column:43}},"11":{start:{line:15,column:21},end:{line:15,column:50}},"12":{start:{line:16,column:4},end:{line:16,column:49}},"13":{start:{line:18,column:4},end:{line:18,column:36}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:6,column:17},end:{line:6,column:18}},loc:{start:{line:6,column:42},end:{line:20,column:1}},line:6}},branchMap:{"0":{loc:{start:{line:9,column:8},end:{line:13,column:7}},type:"if",locations:[{start:{line:9,column:8},end:{line:13,column:7}},{start:{line:9,column:8},end:{line:13,column:7}}],line:9},"1":{loc:{start:{line:11,column:15},end:{line:13,column:7}},type:"if",locations:[{start:{line:11,column:15},end:{line:13,column:7}},{start:{line:11,column:15},end:{line:13,column:7}}],line:11},"2":{loc:{start:{line:11,column:19},end:{line:11,column:118}},type:"binary-expr",locations:[{start:{line:11,column:19},end:{line:11,column:83}},{start:{line:11,column:87},end:{line:11,column:118}}],line:11}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},f:{"0":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"c0b5835967d297444390756e0812cac00a814bdf"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2gqrqehgd1=function(){return actualCoverage;};}return actualCoverage;}cov_2gqrqehgd1();//Model Object
const Task=(cov_2gqrqehgd1().s[0]++,require('../../models/Task'));const toUtc=(cov_2gqrqehgd1().s[1]++,require('../../utils/toUTC'));const moment=(cov_2gqrqehgd1().s[2]++,require('moment'));cov_2gqrqehgd1().s[3]++;module.exports=async(doc,timeZone)=>{cov_2gqrqehgd1().f[0]++;cov_2gqrqehgd1().s[4]++;try{const estimatedStartUtc=(cov_2gqrqehgd1().s[5]++,toUtc(doc.estimatedStart,timeZone));cov_2gqrqehgd1().s[6]++;if(moment().utc().isAfter(moment(estimatedStartUtc).utc().add(2,'h').format())){cov_2gqrqehgd1().b[0][0]++;cov_2gqrqehgd1().s[7]++;doc.state='Canceled';}else{cov_2gqrqehgd1().b[0][1]++;cov_2gqrqehgd1().s[8]++;if((cov_2gqrqehgd1().b[2][0]++,moment().utc().isAfter(moment(estimatedStartUtc).utc().format()))&&(cov_2gqrqehgd1().b[2][1]++,doc.state!=='To be validated')){cov_2gqrqehgd1().b[1][0]++;cov_2gqrqehgd1().s[9]++;doc.state='In progress';}else{cov_2gqrqehgd1().b[1][1]++;}}cov_2gqrqehgd1().s[10]++;doc.estimatedStart=estimatedStartUtc;const document=(cov_2gqrqehgd1().s[11]++,await Task.create({...doc}));cov_2gqrqehgd1().s[12]++;return{data:document,status:'success'};}catch(err){cov_2gqrqehgd1().s[13]++;return{err,status:'error'};}};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkZFRhc2suc2VydmljZS5qcyJdLCJuYW1lcyI6WyJUYXNrIiwicmVxdWlyZSIsInRvVXRjIiwibW9tZW50IiwibW9kdWxlIiwiZXhwb3J0cyIsImRvYyIsInRpbWVab25lIiwiZXN0aW1hdGVkU3RhcnRVdGMiLCJlc3RpbWF0ZWRTdGFydCIsInV0YyIsImlzQWZ0ZXIiLCJhZGQiLCJmb3JtYXQiLCJzdGF0ZSIsImRvY3VtZW50IiwiY3JlYXRlIiwiZGF0YSIsInN0YXR1cyIsImVyciJdLCJtYXBwaW5ncyI6Ind0RUFlWTsyRkFmWjtBQUNBLEtBQU1BLENBQUFBLElBQUksMEJBQUdDLE9BQU8sQ0FBQyxtQkFBRCxDQUFWLENBQVYsQ0FDQSxLQUFNQyxDQUFBQSxLQUFLLDBCQUFHRCxPQUFPLENBQUMsbUJBQUQsQ0FBVixDQUFYLENBQ0EsS0FBTUUsQ0FBQUEsTUFBTSwwQkFBR0YsT0FBTyxDQUFDLFFBQUQsQ0FBVixDQUFaLEMsd0JBRUFHLE1BQU0sQ0FBQ0MsT0FBUCxDQUFpQixNQUFPQyxHQUFQLENBQVlDLFFBQVosR0FBeUIsaURBQ3hDLEdBQUksQ0FDRixLQUFNQyxDQUFBQSxpQkFBaUIsMEJBQUdOLEtBQUssQ0FBQ0ksR0FBRyxDQUFDRyxjQUFMLENBQXFCRixRQUFyQixDQUFSLENBQXZCLENBREUsd0JBRUUsR0FBSUosTUFBTSxHQUFHTyxHQUFULEdBQWVDLE9BQWYsQ0FBdUJSLE1BQU0sQ0FBQ0ssaUJBQUQsQ0FBTixDQUEwQkUsR0FBMUIsR0FBZ0NFLEdBQWhDLENBQW9DLENBQXBDLENBQXVDLEdBQXZDLEVBQTRDQyxNQUE1QyxFQUF2QixDQUFKLENBQWlGLG9EQUMvRVAsR0FBRyxDQUFDUSxLQUFKLENBQVUsVUFBVixDQUNELENBRkQsSUFFTyx1REFBSSw0QkFBQVgsTUFBTSxHQUFHTyxHQUFULEdBQWVDLE9BQWYsQ0FBdUJSLE1BQU0sQ0FBQ0ssaUJBQUQsQ0FBTixDQUEwQkUsR0FBMUIsR0FBZ0NHLE1BQWhDLEVBQXZCLGdDQUFvRVAsR0FBRyxDQUFDUSxLQUFKLEdBQWMsaUJBQWxGLENBQUosQ0FBd0csb0RBQzdHUixHQUFHLENBQUNRLEtBQUosQ0FBVSxhQUFWLENBQ0gsQ0FGUSxpQ0FFUixDQU5ELHlCQU9GUixHQUFHLENBQUNHLGNBQUosQ0FBcUJELGlCQUFyQixDQUNBLEtBQU1PLENBQUFBLFFBQVEsMkJBQUcsS0FBTWYsQ0FBQUEsSUFBSSxDQUFDZ0IsTUFBTCxDQUFZLENBQUUsR0FBR1YsR0FBTCxDQUFaLENBQVQsQ0FBZCxDQVJFLHlCQVNGLE1BQU8sQ0FBRVcsSUFBSSxDQUFFRixRQUFSLENBQWtCRyxNQUFNLENBQUUsU0FBMUIsQ0FBUCxDQUNELENBQUMsTUFBT0MsR0FBUCxDQUFZLDBCQUNaLE1BQU8sQ0FBRUEsR0FBRixDQUFPRCxNQUFNLENBQUUsT0FBZixDQUFQLENBQ0QsQ0FDRixDQWREIiwic291cmNlc0NvbnRlbnQiOlsiLy9Nb2RlbCBPYmplY3RcbmNvbnN0IFRhc2sgPSByZXF1aXJlKCcuLi8uLi9tb2RlbHMvVGFzaycpO1xuY29uc3QgdG9VdGMgPSByZXF1aXJlKCcuLi8uLi91dGlscy90b1VUQycpO1xuY29uc3QgbW9tZW50ID0gcmVxdWlyZSgnbW9tZW50Jyk7XG5cbm1vZHVsZS5leHBvcnRzID0gYXN5bmMgKGRvYywgdGltZVpvbmUpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBlc3RpbWF0ZWRTdGFydFV0YyA9IHRvVXRjKGRvYy5lc3RpbWF0ZWRTdGFydCwgdGltZVpvbmUpO1xuICAgICAgICBpZiAobW9tZW50KCkudXRjKCkuaXNBZnRlcihtb21lbnQoZXN0aW1hdGVkU3RhcnRVdGMpLnV0YygpLmFkZCgyLCAnaCcpLmZvcm1hdCgpKSl7XG4gICAgICAgICAgZG9jLnN0YXRlPSdDYW5jZWxlZCc7XG4gICAgICAgIH0gZWxzZSBpZiAobW9tZW50KCkudXRjKCkuaXNBZnRlcihtb21lbnQoZXN0aW1hdGVkU3RhcnRVdGMpLnV0YygpLmZvcm1hdCgpKSAmJiBkb2Muc3RhdGUgIT09ICdUbyBiZSB2YWxpZGF0ZWQnKXtcbiAgICAgICAgICBkb2Muc3RhdGU9J0luIHByb2dyZXNzJztcbiAgICAgIH1cbiAgICBkb2MuZXN0aW1hdGVkU3RhcnQgPSBlc3RpbWF0ZWRTdGFydFV0YztcbiAgICBjb25zdCBkb2N1bWVudCA9IGF3YWl0IFRhc2suY3JlYXRlKHsgLi4uZG9jIH0pO1xuICAgIHJldHVybiB7IGRhdGE6IGRvY3VtZW50LCBzdGF0dXM6ICdzdWNjZXNzJyB9O1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICByZXR1cm4geyBlcnIsIHN0YXR1czogJ2Vycm9yJyB9O1xuICB9XG59O1xuIl19